{"version":3,"sources":["../../src/components/user-search.jsx"],"names":["delayBy","timeout","fn","setTimeout","UserSearch","props","queryTimeout","NaN","state","users","clear","bind","onChange","searchUsers","value","setState","clearTimeout","onSearch","Promise","resolve","options","debounce","apiClient","type","get","search","page_size","then","results","forEach","user","push","id","label","login","display_name","catch","err","console","error","multi","placeholder","searchPromptText","className","React","Component","propTypes","PropTypes","string","number","bool","func","defaultProps"],"mappings":"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","file":"user-search.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport Select from 'react-select';\nimport apiClient from 'panoptes-client/lib/api-client';\n\nconst delayBy = (timeout, fn) => {\n  return setTimeout(fn, timeout);\n};\n\nexport default class UserSearch extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.queryTimeout = NaN;\n\n    this.state = {\n      users: [],\n    };\n\n    this.clear = this.clear.bind(this);\n    this.onChange = this.onChange.bind(this);\n    this.searchUsers = this.searchUsers.bind(this);\n    this.value = this.value.bind(this);\n  }\n\n  onChange(users) {\n    this.setState({ users });\n  }\n\n  clear() {\n    this.setState({ users: [] });\n  }\n\n  value() {\n    return this.state.users;\n  }\n\n  searchUsers(value) {\n    clearTimeout(this.queryTimeout);\n    const onSearch = this.props.onSearch;\n\n    if (value === '') {\n      return Promise.resolve({ options: [] });\n    }\n\n    return new Promise((resolve) => {\n      this.queryTimeout = delayBy(this.props.debounce, () => {\n        if (onSearch) {\n          onSearch();\n        }\n\n        return apiClient.type('users').get({ search: value, page_size: 10 })\n          .then((users) => {\n            const results = [];\n            users.forEach((user) => {\n              results.push({\n                value: user.id,\n                label: `@${user.login}: ${user.display_name}`,\n              });\n            });\n\n            return results;\n          })\n          .then((options) => { return resolve({ options }) })\n          .catch((err) => { console.error(err); });\n      });\n\n      return this.queryTimeout;\n    });\n  }\n\n  render() {\n    return (\n      <Select.Async\n        multi={this.props.multi}\n        name=\"userids\"\n        value={this.state.users}\n        onChange={this.onChange}\n        placeholder={this.props.placeholder}\n        searchPromptText={this.props.searchPromptText}\n        className={this.props.className}\n        closeAfterClick={true}\n        matchProp={'label'}\n        loadOptions={this.searchUsers}\n      />\n    );\n  }\n}\n\nUserSearch.propTypes = {\n  className: PropTypes.string,\n  debounce: PropTypes.number,\n  multi: PropTypes.bool,\n  onSearch: PropTypes.func,\n  placeholder: PropTypes.string,\n  searchPromptText: PropTypes.string,\n};\n\nUserSearch.defaultProps = {\n  className: 'search',\n  debounce: 200,\n  multi: true,\n  onSearch: null,\n  placeholder: 'Username:',\n  searchPromptText: 'Type to search Users',\n};\n"]}