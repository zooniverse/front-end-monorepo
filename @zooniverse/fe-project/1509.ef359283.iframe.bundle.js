"use strict";(self.webpackChunk_zooniverse_fe_project=self.webpackChunk_zooniverse_fe_project||[]).push([[1509],{"../lib-subject-viewers/dist/esm/VolumetricViewer/VolumetricFull/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>VolumetricFull});var _templateObject,prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),react=__webpack_require__("../../node_modules/react/index.js"),async_states=__webpack_require__("../lib-async-states/src/async-states.js"),async_states_default=__webpack_require__.n(async_states),SortedSet=__webpack_require__("../lib-subject-viewers/dist/esm/VolumetricViewer/helpers/SortedSet.js"),AlgorithmAStar=_ref=>{var{annotation,point:pointOriginal,viewer}=_ref,pointsMax=1e3,pointValueStart=viewer.getPointValue({point:pointOriginal}),traversedPoints=[],connectedPoints=(0,SortedSet.cj)({data:[pointOriginal]}),pointsToCheck=[pointOriginal];function checkConnectedPoints(){if(0!==pointsToCheck.length){var point=pointsToCheck.shift(),pointValue=viewer.getPointValue({point});if(pointValue>=pointValueStart-annotation.threshold&&pointValue<=pointValueStart+annotation.threshold){connectedPoints.add({value:point});for(var[x,y,z]=viewer.getPointCoordinates({point}),pointsAdjascent=[[x-1,y,z],[x+1,y,z],[x,y-1,z],[x,y+1,z],[x,y,z-1],[x,y,z+1]],i=0;i<pointsAdjascent.length;i++){var pointPotential=viewer.getPointFromStructured({point:pointsAdjascent[i]});void 0!==pointPotential&&(traversedPoints[pointPotential]||-1===viewer.getPointAnnotationIndex({point:pointPotential})&&(traversedPoints[pointPotential]=!0,pointsToCheck.push(pointPotential)))}}}}for(;pointsToCheck.length>0&&pointsMax>0;)--pointsMax,checkConnectedPoints();return connectedPoints},Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),Cube=__webpack_require__("../lib-subject-viewers/dist/esm/VolumetricViewer/components/Cube.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Histogram_templateObject,DEFAULT_HANDLER=()=>{},StyledContainer=styled_components_browser_esm.default.div(_templateObject||(_templateObject=function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n  min-height: 16px;\n  transform: translateY(-3px);\n\n  .range-slider-container {\n    flex-grow: 1;\n    position: relative;\n\n    .range-slider-dual {\n      -webkit-appearance: none;\n      appearance: none;\n      background-color: #A6A7A9;\n      border-radius: 4px;\n      height: 4px;\n      pointer-events: none;\n      position: absolute;\n      width: 100%;\n    }\n\n    .range-slider-dual::-webkit-slider-thumb {\n      -webkit-appearance: none;\n      background-color: #005D69;\n      border-radius: 50%;\n      cursor: pointer;\n      height: 16px;\n      pointer-events: all;\n      width: 16px;\n    }\n\n    .range-slider-dual::-moz-range-thumb {\n\t\t\tbackground-color: #005D69;\n      border-radius: 50%;\n      cursor: pointer;\n      height: 16px;\n      pointer-events: all;\n      width: 16px;\n    }\n\n    .range-slider-lower-value {\n      height: 0;\n      transform: translateY(2px);\n      z-index: 1;\n    }\n  }\n"],["\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n  min-height: 16px;\n  transform: translateY(-3px);\n\n  .range-slider-container {\n    flex-grow: 1;\n    position: relative;\n\n    .range-slider-dual {\n      -webkit-appearance: none;\n      appearance: none;\n      background-color: #A6A7A9;\n      border-radius: 4px;\n      height: 4px;\n      pointer-events: none;\n      position: absolute;\n      width: 100%;\n    }\n\n    .range-slider-dual::-webkit-slider-thumb {\n      -webkit-appearance: none;\n      background-color: #005D69;\n      border-radius: 50%;\n      cursor: pointer;\n      height: 16px;\n      pointer-events: all;\n      width: 16px;\n    }\n\n    .range-slider-dual::-moz-range-thumb {\n\\\t\t\tbackground-color: #005D69;\n      border-radius: 50%;\n      cursor: pointer;\n      height: 16px;\n      pointer-events: all;\n      width: 16px;\n    }\n\n    .range-slider-lower-value {\n      height: 0;\n      transform: translateY(2px);\n      z-index: 1;\n    }\n  }\n"]))),InputRangeDual=_ref=>{var{onChange=DEFAULT_HANDLER,valueMax=100,valueMaxCurrent=75,valueMin=0,valueMinCurrent=25}=_ref,[state,setState]=(0,react.useState)({valueMax,valueMin,valueMaxCurrent,valueMinCurrent});var inChange=ev=>{var name=ev.target.name,value=parseInt(ev.target.value,10);"valueMaxCurrent"===name&&value<state.valueMinCurrent?value=state.valueMinCurrent:"valueMinCurrent"===name&&value>state.valueMaxCurrent&&(value=state.valueMaxCurrent);var newObj=_objectSpread(_objectSpread({},state),{},{[name]:value});setState(newObj),onChange(newObj.valueMinCurrent,newObj.valueMaxCurrent)};return(0,jsx_runtime.jsx)(StyledContainer,{children:(0,jsx_runtime.jsxs)("div",{className:"range-slider-container",children:[(0,jsx_runtime.jsx)("input",{"aria-label":"Range slider minimum value",className:"range-slider-dual range-slider-lower-value",max:state.valueMax,min:state.valueMin,name:"valueMinCurrent",onChange:inChange,onInput:inChange,type:"range",value:state.valueMinCurrent}),(0,jsx_runtime.jsx)("input",{"aria-label":"Range slider max value",className:"range-slider-dual range-slider-upper-value",max:state.valueMax,min:state.valueMin,name:"valueMaxCurrent",onChange:inChange,onInput:inChange,style:{background:function fillSlider(){var rangeDistance=state.valueMax-state.valueMin,fromPosition=state.valueMinCurrent-state.valueMin,toPosition=state.valueMaxCurrent-state.valueMin;return"linear-gradient(\n      to right,\n      #A6A7A9 0%,\n      #A6A7A9 ".concat(fromPosition/rangeDistance*100,"%,\n      #FFFFFF ").concat(fromPosition/rangeDistance*100,"%,\n      #FFFFFF ").concat(toPosition/rangeDistance*100,"%, \n      #A6A7A9 ").concat(toPosition/rangeDistance*100,"%, \n      #A6A7A9 100%)")}()},type:"range",value:state.valueMaxCurrent})]})})};InputRangeDual.propTypes={valueMax:prop_types.number,valueMin:prop_types.number,valueMaxCurrent:prop_types.number,valueMinCurrent:prop_types.number,onChange:prop_types.func};var StyledBox=(0,styled_components_browser_esm.default)(Box.a)(Histogram_templateObject||(Histogram_templateObject=function Histogram_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  max-width: 195px;\n"]))),Histogram=_ref=>{var{viewer}=_ref,[pathData,setPathData]=(0,react.useState)("");return(0,react.useEffect)(()=>{!function setupHistogram(){var histogram=[0];histogram[5]=0,histogram[255]=0,histogram[255]=0;var _maxCount=0;viewer.data.forEach(point=>{var _histogram$point;point<viewer.threshold.min||point>viewer.threshold.max||(histogram[point]=(null!==(_histogram$point=histogram[point])&&void 0!==_histogram$point?_histogram$point:0)+1,histogram[point]>_maxCount&&(_maxCount=histogram[point]))});var scaleFactor=30/_maxCount;function calculateY(x){var _histogram$x;return(_maxCount-(null!==(_histogram$x=histogram[x])&&void 0!==_histogram$x?_histogram$x:0))*scaleFactor}for(var path="M 0, ".concat(calculateY(0)),x=1;x<histogram.length;x++)if(void 0!==histogram[x]){var y=calculateY(x);path+=" L ".concat(x,",").concat(y)}setPathData(path)}()},[]),(0,jsx_runtime.jsxs)(StyledBox,{flex:!0,direction:"column",justify:"between",children:[(0,jsx_runtime.jsx)("svg",{viewBox:"0 0 260 ".concat(35),width:"195px",height:"30px",children:(0,jsx_runtime.jsx)("path",{d:pathData,stroke:"white",strokeWidth:"3",fill:"none"})}),(0,jsx_runtime.jsx)(InputRangeDual,{onChange:(min,max)=>viewer.setThreshold({min,max}),valueMax:255,valueMaxCurrent:viewer.threshold.max,valueMin:5,valueMinCurrent:viewer.threshold.min})]})};Histogram.propTypes={viewer:prop_types.object};var StyledIcon=__webpack_require__("../../node_modules/grommet-icons/es6/StyledIcon.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var Edit=(0,react.forwardRef)(function(props,ref){return react.createElement(StyledIcon.v,_extends({ref,viewBox:"0 0 24 24",a11yTitle:"Edit"},props),react.createElement("path",{fill:"none",stroke:"#000",strokeWidth:"2",d:"m14 4 6 6-6-6zm8.294 1.294c.39.39.387 1.025-.008 1.42L9 20l-7 2 2-7L17.286 1.714a1 1 0 0 1 1.42-.008l3.588 3.588zM3 19l2 2m2-4 8-8"}))});Edit.displayName="Edit";var Revert=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Revert.js"),Blank=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Blank.js");function DeleteIcon_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function DeleteIcon_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?DeleteIcon_ownKeys(Object(t),!0).forEach(function(r){DeleteIcon_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):DeleteIcon_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function DeleteIcon_defineProperty(e,r,t){return(r=function DeleteIcon_toPropertyKey(t){var i=function DeleteIcon_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const components_DeleteIcon=function DeleteIcon(props){return(0,jsx_runtime.jsxs)(Blank.h,DeleteIcon_objectSpread(DeleteIcon_objectSpread({viewBox:"0 0 16 17"},props),{},{children:[(0,jsx_runtime.jsx)("path",{d:"M2.53473 2.80786L3.29384 14.3463C3.32989 15.013 3.84039 15.5001 4.50841 15.5001H11.4922C12.1629 15.5001 12.6639 15.013 12.7068 14.3463L13.4659 2.80786",stroke:"#A6A7A9",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,jsx_runtime.jsx)("path",{d:"M1.31989 2.80786H14.6802",stroke:"#A6A7A9",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round"}),(0,jsx_runtime.jsx)("path",{d:"M5.57092 2.80769V1.36539C5.57056 1.25165 5.59389 1.13897 5.63954 1.03382C5.6852 0.928681 5.75228 0.83315 5.83694 0.752725C5.9216 0.672301 6.02215 0.60857 6.13283 0.565198C6.24351 0.521827 6.36212 0.499671 6.48184 0.500004H9.51827C9.63799 0.499671 9.7566 0.521827 9.86728 0.565198C9.97796 0.60857 10.0785 0.672301 10.1632 0.752725C10.2478 0.83315 10.3149 0.928681 10.3606 1.03382C10.4062 1.13897 10.4295 1.25165 10.4292 1.36539V2.80769M8.00006 5.11537V13.1923M5.26727 5.11537L5.57092 13.1923M10.7328 5.11537L10.4292 13.1923",stroke:"#A6A7A9",strokeLinecap:"round",strokeLinejoin:"round"})]}))};var MarkButtons_templateObject,IconActionButton=__webpack_require__("../lib-react-components/dist/esm/IconActionButton/IconActionButton.js");var StyledMarkButtons=styled_components_browser_esm.default.div(MarkButtons_templateObject||(MarkButtons_templateObject=function MarkButtons_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: flex;\n  align-items: center;\n  flex-direction: row;\n  \n  button {\n      margin-right: 10px;\n  }\n"]))),MarkButtons=_ref=>{var{annotations}=_ref,[isDisabled,setIsDisabled]=(0,react.useState)(!0);function checkState(){setIsDisabled(null===annotations.config.activeAnnotation)}return(0,react.useEffect)(()=>(annotations.on("add:annotation",checkState),annotations.on("update:annotation",checkState),annotations.on("active:annotation",checkState),()=>{annotations.off("add:annotation",checkState),annotations.off("update:annotation",checkState),annotations.off("active:annotation",checkState)}),[]),(0,jsx_runtime.jsxs)(StyledMarkButtons,{children:[(0,jsx_runtime.jsx)(IconActionButton.A,{a11yTitle:"Add a new mark",disabled:isDisabled,icon:(0,jsx_runtime.jsx)(Edit,{}),onClick:function markCreate(){annotations.actions.annotation.inactive()}}),(0,jsx_runtime.jsx)(IconActionButton.A,{a11yTitle:"Undo last action on mark",disabled:isDisabled,icon:(0,jsx_runtime.jsx)(Revert.z,{}),onClick:function markUndo(){null!==annotations.config.activeAnnotation&&annotations.actions.point.undo({index:annotations.config.activeAnnotation})}}),(0,jsx_runtime.jsx)(IconActionButton.A,{a11yTitle:"Delete last mark",disabled:isDisabled,icon:(0,jsx_runtime.jsx)(components_DeleteIcon,{}),onClick:function markDelete(){null!==annotations.config.activeAnnotation&&window.confirm("Are you sure you would like to delete this mark? This action cannot be undone.")&&annotations.actions.annotation.remove({index:annotations.config.activeAnnotation})}})]})},FormUp=__webpack_require__("../../node_modules/grommet-icons/es6/icons/FormUp.js"),FormDown=__webpack_require__("../../node_modules/grommet-icons/es6/icons/FormDown.js"),pointColor=__webpack_require__("../lib-subject-viewers/dist/esm/VolumetricViewer/helpers/pointColor.js");function ForwardTen_extends(){return ForwardTen_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ForwardTen_extends.apply(null,arguments)}var Slider_templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,ForwardTen=(0,react.forwardRef)(function(props,ref){return react.createElement(StyledIcon.v,ForwardTen_extends({ref,viewBox:"0 0 24 24",a11yTitle:"ForwardTen"},props),react.createElement("path",{fill:"none",stroke:"#000",strokeWidth:"2",d:"M20.889 7.556C19.33 4.267 15.93 2 12 2 6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10m0-8v4h-4m-9 8V9l-2 .533M17 12c0-2-1-3.5-2.5-3.5S12 10 12 12s1 3.5 2.5 3.5S17 14 17 12zm-2.5-3.5C16.925 8.5 17 11 17 12s0 3.5-2.5 3.5S12 13 12 12s.059-3.5 2.5-3.5z"}))});function Slider_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}ForwardTen.displayName="ForwardTen";var Plane_templateObject,Plane_templateObject2,Plane_templateObject3,Plane_templateObject4,Plane_templateObject5,_templateObject6,_templateObject7,COLORS_active="#265B68",COLORS_black="#000",COLORS_hover="#ADDDE0",COLORS_white="#FFF",svgSliderStyles='\n  appearance: none;\n  background-image: url("data:image/svg+xml;base64,'.concat(btoa("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 32'>\n  <rect width='100%' height='100%' rx='8' ry='8' style='fill: rgb(0,93,105);' />\n  <path d='M16 10 l-7 6 l7 6;' style='stroke:rgb(173, 221, 224); stroke-width:2; fill: none;'/>\n  <path d='M24 10 l7 6 l-7 6;' style='stroke:rgb(173, 221, 224); stroke-width:2; fill: none;'/>\n</svg>"),'");\n  background-size: cover;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n  height: 32px;\n  width: 40px;\n'),StyledSlider=(0,styled_components_browser_esm.default)(Box.a)(Slider_templateObject||(Slider_templateObject=Slider_taggedTemplateLiteral(['\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  height: 60px;\n  width: 60px;\n\n  input[type="range"] {\n    ',"\n    -webkit-appearance: none;\n    border-radius: 5px;\n    height: 4px;\n    transform: rotate(90deg) translateX(125px);\n    width: 250px;\n\n    &::-moz-range-thumb {\n      ","\n    }\n    &::-webkit-slider-thumb {\n      ","\n    }\n  }\n  \n  .plane-slider-forward {\n    ","\n    background: none;\n    border: none;\n    border-radius: 20px;\n    height: fit-content;\n    padding: 0;\n    width: fit-content;\n    \n    &:active {\n      background-color: ",";\n    }\n\n    svg {\n      height: 20px;\n      width: 20px;\n      padding: 10px;\n\n      &:hover, &:active {\n        stroke: ",";\n\n      }\n    }\n  }\n\n  @media (hover: hover) {\n    .plane-slider-forward:hover {\n      background-color: ",";\n      stroke: ",";\n    }\n\n    .plane-slider-forward:active {\n      background-color: ",";\n      stroke: ",";\n    }\n  }\n"])),props=>props.theme.dark?(0,styled_components_browser_esm.css)(_templateObject2||(_templateObject2=Slider_taggedTemplateLiteral(["background: ",";"])),COLORS_white):(0,styled_components_browser_esm.css)(_templateObject3||(_templateObject3=Slider_taggedTemplateLiteral(["background: ",";"])),COLORS_black),svgSliderStyles,svgSliderStyles,props=>props.theme.dark?(0,styled_components_browser_esm.css)(_templateObject4||(_templateObject4=Slider_taggedTemplateLiteral(["color: ",";"])),COLORS_white):(0,styled_components_browser_esm.css)(_templateObject5||(_templateObject5=Slider_taggedTemplateLiteral(["color: ",";"])),COLORS_black),COLORS_active,COLORS_white,COLORS_hover,COLORS_white,COLORS_active,COLORS_white),Slider=_ref=>{var{dimension,viewer}=_ref,currentFrame=viewer.base-1-viewer.getPlaneFrameIndex({dimension});return(0,jsx_runtime.jsxs)(StyledSlider,{children:[(0,jsx_runtime.jsx)("button",{className:"plane-slider-forward no-select",onClick:function advanceFrame(){viewer.setPlaneFrameActive({dimension,frame:(viewer.getPlaneFrameIndex({dimension})-10+viewer.base)%viewer.base})},"aria-label":"Advance 10 Frames",children:(0,jsx_runtime.jsx)(ForwardTen,{})}),(0,jsx_runtime.jsx)("input",{"aria-label":"Plane ".concat(dimension," Slider"),max:viewer.base-1,min:"0",onChange:function inChange(e){var nextFrame=viewer.base-1-+e.target.value;viewer.setPlaneFrameActive({dimension,frame:nextFrame})},type:"range",value:currentFrame})]})};function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function Plane_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Slider.propTypes={dimension:prop_types.number,frame:prop_types.string,viewer:prop_types.object};var ComponentFull_templateObject,ComponentFull_templateObject2,ComponentFull_templateObject3,Plane_StyledBox=(0,styled_components_browser_esm.default)(Box.a)(Plane_templateObject||(Plane_templateObject=Plane_taggedTemplateLiteral(["\n  ","\n\n  border-radius: 16px;\n  margin-bottom: 20px;\n  width: 390px;\n\n  button {\n    border: none;\n  }\n\n  &.expanded {\n    border-bottom-right-radius: 0px;\n  }\n\n  &.plane-container-0 {\n    border: 1px solid #E45950;\n  }\n\n  &.plane-container-1 {\n    border: 1px solid #06FE76;\n  }\n\n  &.plane-container-2 {\n    border: 1px solid #235DFF;\n  }\n\n  .plane-title {\n    ","\n    align-items: center;\n    border-top-left-radius: 16px;\n    border-top-right-radius: 16px;\n    display: flex;\n    flex-direction: row;\n    font-size: 24px;\n    height: ","px;\n\n    &.collapsed {\n      border-bottom-left-radius: 16px;\n      border-bottom-right-radius: 16px;\n    }\n\n    .plane-title-dimension {\n      text-align: center;\n      text-transform: uppercase;\n      width: ","px;\n    }\n\n    .plane-title-frame {\n      flex: 1;\n      font-size: 16px !important;\n      line-height: 18.7px;\n      text-align: left;\n    }\n\n    .plane-title-label {\n      ","\n      font-size: 12px;\n      line-height: 12px;\n    }\n\n    .plane-title-toggle {\n      align-items: center;\n      cursor: pointer;\n      display: flex;\n      margin-right: 10px;\n      padding: 6px;\n    }\n  }\n\n  .plane-content {\n    display: flex;\n    flex-direction: row;\n\n    .plane-canvas {\n      height: ","px;\n      transform: translateY(2px);\n      width: ","px;\n    }\n  }\n"])),props=>props.theme.dark?(0,styled_components_browser_esm.css)(Plane_templateObject2||(Plane_templateObject2=Plane_taggedTemplateLiteral(["background-color: #404040;"]))):(0,styled_components_browser_esm.css)(Plane_templateObject3||(Plane_templateObject3=Plane_taggedTemplateLiteral(["background-color: #EFF2F5;"]))),props=>props.theme.dark?(0,styled_components_browser_esm.css)(Plane_templateObject4||(Plane_templateObject4=Plane_taggedTemplateLiteral(["background: linear-gradient(#5C5C5C, #404040);"]))):(0,styled_components_browser_esm.css)(Plane_templateObject5||(Plane_templateObject5=Plane_taggedTemplateLiteral(["background: linear-gradient(#FFFFFF, #EFF2F5);"]))),60,60,props=>props.theme.dark?(0,styled_components_browser_esm.css)(_templateObject6||(_templateObject6=Plane_taggedTemplateLiteral(["color: #E2E5E9;"]))):(0,styled_components_browser_esm.css)(_templateObject7||(_templateObject7=Plane_taggedTemplateLiteral(["color: ##5C5C5C;"]))),330,330),Plane=_ref=>{var{annotations,dimension,tool,viewer}=_ref,[hideCoor,setHideCoor]=(0,react.useState)(),[expanded,setExpanded]=(0,react.useState)(!1),[currentFrameIndex,setCurrentFrameIndex]=(0,react.useState)(0),canvasRef=(0,react.useRef)(null),containerRef=(0,react.useRef)(null),planeId=(0,react.useId)(),frameCanvasRef=(0,react.useRef)(null);function drawFrame(_x){return _drawFrame.apply(this,arguments)}function _drawFrame(){return _drawFrame=function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(function*(e){var _canvasRef$current;if(frameCanvasRef.current&&canvasRef.current){var context=frameCanvasRef.current.getContext("2d");viewer.getPlaneFrame({dimension}).forEach((lines,x)=>{lines.forEach((point,y)=>{!function drawPoint(_ref2){var{context,point,x,y}=_ref2;if(null==point)return context.fillStyle="#000",void context.fillRect(x,y,1,1);var annotationIndex=viewer.getPointAnnotationIndex({point});if(viewer.isPointInThreshold({point})||-1!==annotationIndex){var isInactive=-1!==annotationIndex&&(null==annotations?void 0:annotations.config.activeAnnotation)!==annotationIndex;context.fillStyle=(0,pointColor.i)({annotationIndex,isInactive,pointValue:viewer.getPointValue({point}),threshold:viewer.threshold})}else context.fillStyle="#000";context.fillRect(x,y,1,1)}({context,point,x,y})})});var imageBitmap=yield window.createImageBitmap(frameCanvasRef.current,{resizeWidth:330,resizeHeight:330,resizeQuality:"pixelated"});null===(_canvasRef$current=canvasRef.current)||void 0===_canvasRef$current||_canvasRef$current.getContext("2d").drawImage(imageBitmap,0,0),imageBitmap.close(),setCurrentFrameIndex(viewer.getPlaneFrameIndex({dimension}))}}),_drawFrame.apply(this,arguments)}function onClick(e){if(null!=tool&&tool.events.click){var{button,clientX,clientY,shiftKey}=e,{left,top}=canvasRef.current.getBoundingClientRect(),pixelLength=330/viewer.base,x=Math.floor((clientX-left)/pixelLength),y=Math.floor((clientY-top)/pixelLength),point=viewer.getPlaneFrame({dimension})[x][y];tool.events.click&&tool.events.click({button,point,shiftKey}),e.preventDefault()}}return(0,react.useEffect)(()=>(frameCanvasRef.current||(frameCanvasRef.current=document.createElement("canvas"),frameCanvasRef.current.width=viewer.base,frameCanvasRef.current.height=viewer.base),setHideCoor(0!==dimension),setExpanded(0===dimension),drawFrame(),annotations&&(annotations.on("active:annotation",drawFrame),annotations.on("add:annotation",drawFrame),annotations.on("update:annotation",drawFrame)),viewer.on("change:dimension-".concat(dimension,":frame"),drawFrame),viewer.on("change:threshold",drawFrame),()=>{annotations&&(annotations.off("active:annotation",drawFrame),annotations.off("add:annotation",drawFrame),annotations.off("update:annotation",drawFrame)),viewer.off("change:dimension-".concat(dimension,":frame"),drawFrame),viewer.off("change:threshold",drawFrame),frameCanvasRef.current=null}),[]),(0,react.useEffect)(()=>{expanded&&drawFrame()},[expanded]),(0,jsx_runtime.jsxs)(Plane_StyledBox,{className:"plane-container plane-container-".concat(dimension," ").concat(expanded?"expanded":"collapsed"," no-select"),ref:containerRef,children:[(0,jsx_runtime.jsxs)("button",{"aria-controls":"section-".concat(planeId),"aria-expanded":expanded.toString(),"aria-label":"Toggle ".concat(viewer.dimensions[dimension]," Plane Visibility"),className:"plane-title ".concat(expanded?"expanded":"collapsed"),id:"accordion-".concat(planeId),onClick:function toggleContentVisibility(){setHideCoor(!1),setExpanded(!expanded)},type:"button",children:[(0,jsx_runtime.jsx)(Box.a,{className:"plane-title-dimension",children:viewer.getDimensionLabel({dimension})}),(0,jsx_runtime.jsx)(Box.a,{className:"plane-title-frame",children:hideCoor?"":currentFrameIndex}),(0,jsx_runtime.jsx)(Box.a,{className:"plane-title-label",children:expanded?"Collapse":"Expand"}),(0,jsx_runtime.jsx)("div",{className:"plane-title-toggle",children:expanded?(0,jsx_runtime.jsx)(FormUp.I,{}):(0,jsx_runtime.jsx)(FormDown.t,{})})]}),expanded&&(0,jsx_runtime.jsxs)(Box.a,{"aria-labelledby":"accordion-".concat(planeId),className:"plane-content",id:"section-".concat(planeId),role:"region",children:[(0,jsx_runtime.jsx)(Slider,{dimension,viewer}),(0,jsx_runtime.jsx)(Box.a,{className:"plane-canvas",children:(0,jsx_runtime.jsx)("canvas",{className:"plane-".concat(dimension),"data-testid":"plane-".concat(dimension),height:330,onClick,onContextMenu:onClick,onWheel:function onWheel(e){var frameCurrent=viewer.getPlaneFrameIndex({dimension}),frameNew=e.deltaY>0&&frameCurrent>0?frameCurrent-1:e.deltaY<0&&frameCurrent<viewer.base-1?frameCurrent+1:frameCurrent;viewer.setPlaneFrameActive({dimension,frame:frameNew})},ref:canvasRef,width:330})})]})]})};function ComponentFull_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Plane.propTypes={annotations:prop_types.object,dimension:prop_types.number,tool:prop_types.object,viewer:prop_types.object};var ComponentFull_StyledBox=(0,styled_components_browser_esm.default)(Box.a)(ComponentFull_templateObject||(ComponentFull_templateObject=ComponentFull_taggedTemplateLiteral(["\n  ","\n\n  border-radius: 16px;\n  width: 100%;\n\n  .volume-container {\n    background-color: #000000;\n    border-radius: 16px;\n    position: relative;\n\n    .volume-cube {\n      width: 100%;\n    }\n  }\n\n  @media (width > 1200px) {\n    max-width: 975px;\n\n    .planes-container {\n      margin: 20px;\n    }\n\n    .volume-container {\n      height: 575px;\n      min-width: 330px;\n      padding: 20px;\n      border-top-right-radius: 16px;\n\n      .volume-cube {\n        max-width: 460px;\n      }\n\n      .volume-controls {\n        margin-top: 0;\n        max-height: 60px;\n        width: 100%;\n      }\n    }\n  }\n\n  @media (width <= 1200px) {\n    background: none;\n    border: none;\n    flex-direction: column-reverse;\n    max-width: 410px;\n\n    .planes-container {\n      margin: 20px 0 20px 20px;\n    }\n\n    .volume-container {\n      border-radius: 16px;\n      margin: 0 0 0 20px;\n      width: 390px;\n\n      .volume-cube {\n        max-width: 325px;\n        width: 100%;\n      }\n\n      .volume-controls {\n        margin: 20px 0;\n        width: 90%;\n      }\n    }\n  }\n\n  .no-select {\n    -moz-user-select: none;\n    -ms-user-select: none;\n    -webkit-tap-highlight-color: transparent;\n    -webkit-touch-callout: none;\n    -webkit-user-drag: none;\n    -webkit-user-select: none;\n    pointer-events: auto;\n    touch-action: none;\n    user-drag: none;\n    user-select: none;\n  }\n"])),props=>props.theme.dark?(0,styled_components_browser_esm.css)(ComponentFull_templateObject2||(ComponentFull_templateObject2=ComponentFull_taggedTemplateLiteral(["\n      background-color: none;\n      color: #FFFFFF;\n    "]))):(0,styled_components_browser_esm.css)(ComponentFull_templateObject3||(ComponentFull_templateObject3=ComponentFull_taggedTemplateLiteral(["\n      background-color: #FFFFFF;\n      border: .5px solid #A6A7A9;\n      border-bottom: none;\n      color: #000000;\n    "])))),ComponentFull=_ref=>{var{models}=_ref;return(0,jsx_runtime.jsx)(Box.a,{flex:!0,align:"end",children:(0,jsx_runtime.jsxs)(ComponentFull_StyledBox,{direction:"row",children:[(0,jsx_runtime.jsx)(Box.a,{className:"planes-container",children:models.viewer.dimensions.map((dimensionName,dimension)=>(0,jsx_runtime.jsx)(Plane,{annotations:models.annotations,dimension,tool:models.tool,viewer:models.viewer},"dimension-".concat(dimensionName)))}),(0,jsx_runtime.jsxs)(Box.a,{className:"volume-container",flex:!0,align:"center",justify:"between",children:[(0,jsx_runtime.jsx)(Box.a,{className:"volume-cube",children:(0,jsx_runtime.jsx)(Cube.I,{annotations:models.annotations,tool:models.tool,viewer:models.viewer})}),(0,jsx_runtime.jsxs)(Box.a,{className:"volume-controls",flex:!0,direction:"row",justify:"between",children:[models.annotations?(0,jsx_runtime.jsx)(MarkButtons,{annotations:models.annotations}):(0,jsx_runtime.jsx)("div",{style:{flex:1}}),(0,jsx_runtime.jsx)(Histogram,{viewer:models.viewer})]})]})]})})};ComponentFull.propTypes={data:prop_types.string,models:prop_types.object};var ModelViewer=__webpack_require__("../lib-subject-viewers/dist/esm/VolumetricViewer/models/ModelViewer.js");function ModelAnnotations_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function ModelAnnotations_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ModelAnnotations_ownKeys(Object(t),!0).forEach(function(r){ModelAnnotations_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ModelAnnotations_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function ModelAnnotations_defineProperty(e,r,t){return(r=function ModelAnnotations_toPropertyKey(t){var i=function ModelAnnotations_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var ANNOTATION_COUNT=0,ModelAnnotations=_ref2=>{var{onAnnotation}=_ref2,annotationModel={annotations:[],config:{activeAnnotation:null,algorithm:null,viewer:!1},initialize:config=>{annotationModel.config=ModelAnnotations_objectSpread(ModelAnnotations_objectSpread({},annotationModel.config),config)},actions:{annotation:{add:_ref3=>{var{point}=_ref3,annotationIndex=annotationModel.annotations.length,annotation=(_ref=>{var{point}=_ref;return{label:"Annotation ".concat(++ANNOTATION_COUNT),threshold:15,points:{active:[point],connected:[],all:(0,SortedSet.cj)({data:[]})}}})({point});annotationModel.config.algorithm?(annotation.points.all=annotationModel.config.algorithm({annotation,point,viewer:annotationModel.config.viewer}),annotation.points.connected[0]=annotation.points.all.data):annotation.points.connected[0]=[],annotationModel.annotations.push(annotation),annotationModel.config.activeAnnotation=annotationIndex,annotationModel.config.viewer.setPointsAnnotationIndex({points:annotation.points.connected[0],index:annotationIndex}),annotationModel.publish("add:annotation",{annotation,annotationIndex,annotations:annotationModel.annotations}),annotationModel.publishCallback()},active:_ref4=>{var{index}=_ref4;annotationModel.config.activeAnnotation!==index&&(annotationModel.config.activeAnnotation=index,annotationModel.publish("active:annotation",{annotationIndex:index,annotations:annotationModel.annotations}))},inactive:()=>{annotationModel.config.activeAnnotation=null,annotationModel.publish("active:annotation",{annotationIndex:null,annotations:annotationModel.annotations})},remove:_ref5=>{for(var{index}=_ref5,annotation=annotationModel.annotations[index],i=annotation.points.active.length-1;i>=0;i--)annotationModel.actions.point.undo({index});annotationModel.config.activeAnnotation=null,annotationModel.publish("update:annotation",{annotation,annotationIndex:index,annotations:annotationModel.annotations}),annotationModel.publishCallback()}},point:{add:_ref6=>{var{annotationIndex=null,point}=_ref6;if(point){var currentIndex=annotationModel.config.viewer.getPointAnnotationIndex({point});if(-1!==currentIndex)return annotationModel.actions.annotation.active({index:currentIndex});if(null===annotationIndex&&null===annotationModel.config.activeAnnotation)annotationModel.actions.annotation.add({point});else{var _index=annotationIndex||annotationModel.config.activeAnnotation,annotation=annotationModel.annotations[_index],pointIndex=annotation.points.active.length,connectedPoints=annotationModel.config.algorithm?annotationModel.config.algorithm({annotation,point,viewer:annotationModel.config.viewer}):(0,SortedSet.cj)({data:[]});annotation.points.active[pointIndex]=point,annotation.points.connected[pointIndex]=connectedPoints.data,annotation.points.all=(0,SortedSet.xP)({sets:[annotation.points.all,connectedPoints]}),annotationModel.config.viewer.setPointsAnnotationIndex({points:annotation.points.connected[pointIndex],index:_index}),annotationModel.publish("update:annotation",{annotation,annotationIndex:_index,annotations:annotationModel.annotations}),annotationModel.publishCallback()}}},undo:_ref7=>{var{index}=_ref7,annotation=annotationModel.annotations[index];annotation.points.active.pop();var points=annotation.points.connected.pop();annotationModel.config.viewer.setPointsAnnotationIndex({points,index:-1}),annotation.points.all.remove({value:points}),0===annotation.points.active.length&&(annotationModel.config.activeAnnotation=null),annotationModel.publish("update:annotation",{annotation,annotationIndex:index,annotations:annotationModel.annotations}),annotationModel.publishCallback()}}},publishCallback:()=>{if(onAnnotation){var annotationExport=JSON.parse(JSON.stringify(annotationModel.annotations)).filter(a=>a.points.active.length>0).map(a=>(a.points.active=a.points.active.map(point=>function absToRelative(_ref8){var{point}=_ref8,[x,y,z]=annotationModel.config.viewer.getPointCoordinates({point});return{x,y,z}}({point})),delete a.points.connected,delete a.points.all,a));onAnnotation(annotationExport),annotationModel.publish("publish:annotation",annotationExport)}},export:()=>annotationModel.annotations.map(annotation=>({label:annotation.label,points:{active:[...annotation.points.active],connected:[...annotation.points.connected]},threshold:annotation.threshold})),dispose:()=>{annotationModel.annotations=[],annotationModel.config.activeAnnotation=null,annotationModel.config.algorithm=null,annotationModel.config.viewer=null,annotationModel._listeners=[]},_listeners:[],publish:(eventName,data)=>{annotationModel._listeners.forEach(listener=>{listener.eventName===eventName&&listener.cb(data)})},on:(eventName,cb)=>{annotationModel._listeners.push({eventName,cb})},off:(eventName,cb)=>{var index=annotationModel._listeners.findIndex(listener=>listener.eventName===eventName&&listener.cb===cb);index>-1&&annotationModel._listeners.splice(index,1)}};return annotationModel},useVolumetricSubject=__webpack_require__("../lib-subject-viewers/dist/esm/hooks/useVolumetricSubject.js"),VolumetricFull_DEFAULT_HANDLER=()=>{};function VolumetricFull(_ref){var{loadingState=async_states_default().initialized,onAnnotation=VolumetricFull_DEFAULT_HANDLER,onError=VolumetricFull_DEFAULT_HANDLER,onReady=VolumetricFull_DEFAULT_HANDLER,subject}=_ref,{data,loading,error}=(0,useVolumetricSubject.q)({onError,onReady,subject}),[modelState,setModelState]=(0,react.useState)(null);(0,react.useEffect)(()=>{if(data){var toolModel,state={annotations:ModelAnnotations({onAnnotation}),tool:(toolModel={annotations:null,initialize:_ref=>{var{annotations}=_ref;toolModel.annotations=annotations},events:{click:_ref2=>{var{button=0,point,shiftKey=!1}=_ref2;0===button&&shiftKey?toolModel.annotations.actions.annotation.add({point}):0===button&&toolModel.annotations.actions.point.add({point})}}},toolModel),viewer:(0,ModelViewer.g)()};return state.annotations.initialize({algorithm:AlgorithmAStar,viewer:state.viewer}),state.tool.initialize({annotations:state.annotations}),state.viewer.initialize({annotations:state.annotations,data,tool:state.tool}),setModelState(state),()=>{var _state$viewer,_state$annotations;null!==(_state$viewer=state.viewer)&&void 0!==_state$viewer&&_state$viewer.dispose&&state.viewer.dispose(),null!==(_state$annotations=state.annotations)&&void 0!==_state$annotations&&_state$annotations.dispose&&state.annotations.dispose()}}},[data]);var isLoading=loadingState===async_states_default().initialized||loadingState===async_states_default().loading||loading||null===modelState,isError=loadingState===async_states_default().error||error||null===data;return"mock-subject-json"===data?(0,jsx_runtime.jsx)("div",{"data-testid":"subject-viewer-volumetric"}):isLoading?(0,jsx_runtime.jsx)("p",{children:"Loading..."}):isError?(0,jsx_runtime.jsx)("p",{children:"Error"}):(0,jsx_runtime.jsx)(ComponentFull,{"data-testid":"subject-viewer-volumetric",data,models:modelState})}VolumetricFull.propTypes={loadingState:prop_types.string,onAnnotation:prop_types.func,onError:prop_types.func,onReady:prop_types.func,subject:prop_types.object,view:prop_types.string}}}]);