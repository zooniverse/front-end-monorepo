{"version":3,"file":"screens-SubjectTalkPage-components-SubjectTalkViewer-SubjectTalkViewer-stories.3a92eaa8.iframe.bundle.js","mappings":";AAiBA;AACA","sources":["webpack://@zooniverse/fe-project/./src/screens/SubjectTalkPage/components/SubjectTalkViewer/SubjectTalkViewer.jsx"],"sourcesContent":["import {\n  Media,\n  MetaTools\n} from '@zooniverse/react-components'\nimport { Box } from 'grommet'\nimport dynamic from 'next/dynamic'\nimport { useTranslation } from 'next-i18next'\nimport { shape, string } from 'prop-types'\nimport { useState } from 'react'\nimport styled from 'styled-components'\n\n// Dynamically import FlipbookControls with SSR disabled\nconst FlipbookControls = dynamic(() => import('@zooniverse/classifier').then(mod => mod.FlipbookControls), {\n  ssr: false\n})\n\nconst StyledMedia = styled(Media)`\n  filter: ${props => props.$invert ? 'invert(1)' : 'none'};\n`\n\nfunction processSubjectLocations(rawLocations) {\n  return rawLocations.map(location => {\n    const [mimeType, url] = Object.entries(location)[0];\n    const [type] = mimeType.split('/');\n    return {\n      mimeType: mimeType,\n      type: type,\n      url: url\n    }\n  })\n}\n\nfunction SubjectTalkViewer({\n    login,\n    projectId,\n    projectSlug,\n    subject,\n    userId\n  }) {\n  const [frame, setFrame] = useState(0)\n  const [flipbookSpeed, setFlipbookSpeed] = useState(1)\n  const [invert, setInvert] = useState(false)\n  const [playing, setPlaying] = useState(false)\n\n  const { t } = useTranslation('screens')\n  \n  const subjectId = subject?.id\n  const processedLocations = processSubjectLocations(subject?.locations)\n\n  function onInvert() {\n    setInvert(!invert)\n  }\n\n  function onPlayPause() {\n    setPlaying(!playing)\n  }\n\n  return (\n    <Box\n      background={{\n        dark: 'dark-3',\n        light: 'neutral-6'\n      }}\n      border={{ color: 'light-5', side: 'all', size: '0.5px' }}\n      height={{ min: '300px', max: '90vh' }}\n      round={{ size: '8px', corner: 'bottom' }}\n    >\n      <StyledMedia\n        alt={t('Home.ZooniverseTalk.RecentSubjects.subjectLabel', { id: subjectId })}\n        background={{\n          dark: 'dark-3',\n          light: 'neutral-6'\n        }}\n        fit='contain'\n        flex='shrink'\n        $invert={invert}\n        placeholder={\n          <Box\n            align='center'\n            justify='center'\n            height='40vh'\n            width='600px'\n            background={{\n              image: `url(https://static.zooniverse.org/fem-assets/subject-placeholder.jpg)`,\n              size: 'cover',\n              position: 'center'\n            }}\n          />\n        }\n        subject={subject}\n        src={processedLocations?.[frame]?.url}\n      />\n      <Box flex={false}>\n        {subject?.locations?.length > 1 ? (\n          <FlipbookControls\n            currentFrame={frame}\n            flipbookSpeed={flipbookSpeed}\n            locations={processedLocations}\n            onFrameChange={setFrame}\n            onPlayPause={onPlayPause}\n            playing={playing}\n            playIterations={1}\n            setFlipbookSpeed={setFlipbookSpeed}\n          />\n        ) : null}\n        <MetaTools\n          invert={invert}\n          location={subject?.locations?.[frame]}\n          login={login}\n          onInvert={onInvert}\n          projectId={projectId}\n          projectSlug={projectSlug}\n          subjectId={subjectId}\n          userId={userId}\n        />\n      </Box>\n    </Box>\n  )\n}\n\nSubjectTalkViewer.propTypes = {\n  login: string,\n  projectId: string,\n  projectSlug: string,\n  subject: shape({\n    id: string\n  }),\n  userId: string\n}\n\nexport default SubjectTalkViewer\n"],"names":[],"ignoreList":[],"sourceRoot":""}