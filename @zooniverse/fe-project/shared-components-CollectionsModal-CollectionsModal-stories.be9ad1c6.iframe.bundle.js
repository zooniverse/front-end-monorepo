"use strict";(self.webpackChunk_zooniverse_fe_project=self.webpackChunk_zooniverse_fe_project||[]).push([[2011],{"./src/shared/components/CollectionsModal/CollectionsModal.stories.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__,mockCollections:()=>mockCollections});var _home_runner_work_front_end_monorepo_front_end_monorepo_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/index.js"),mobx_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),_stores_Store__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stores/Store.js"),_stores_User_Collections_Collections__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./stores/User/Collections/Collections.js"),_CollectionsModalContainer__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/shared/components/CollectionsModal/CollectionsModalContainer.jsx"),__jsx=react__WEBPACK_IMPORTED_MODULE_1__.createElement;const __WEBPACK_DEFAULT_EXPORT__={title:"Project App / shared / Collections Modal",component:_CollectionsModalContainer__WEBPACK_IMPORTED_MODULE_5__.A,excludeStories:["mockCollections"],parameters:{docs:{description:{component:"Note that the User > Collections store method searchCollections()\nis not mocked in storybook and will not accurately filter the\nsample collections below"}}}};var usersCollections=["Gravity Spy","TESS","Planet Four","Transcriptions"].map((function(collection,index){return _stores_User_Collections_Collections__WEBPACK_IMPORTED_MODULE_4__.p.create({display_name:collection,id:index.toString(),links:{owner:{id:"123"}}})})),otherOwnerCollection=_stores_User_Collections_Collections__WEBPACK_IMPORTED_MODULE_4__.p.create({display_name:"Transcriptions",id:"934667",links:{owner:{display_name:"Zooni",id:"456"}}}),mockCollections=[].concat((0,_home_runner_work_front_end_monorepo_front_end_monorepo_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_0__.A)(usersCollections),[otherOwnerCollection]),snapshot={project:{strings:{display_name:"Snapshot Serengeti"}},user:{collections:{collections:mockCollections},id:"123"}},store=_stores_Store__WEBPACK_IMPORTED_MODULE_3__.A.create(snapshot),Default=function Default(){return __jsx(mobx_react__WEBPACK_IMPORTED_MODULE_2__.Kq,{store},__jsx(_CollectionsModalContainer__WEBPACK_IMPORTED_MODULE_5__.A,{collectionsModalActive:!0,subjectID:"1234"}))};Default.displayName="Default",Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"() => {\n  return <Provider store={store}>\n      <CollectionsModalContainer collectionsModalActive subjectID='1234' />\n    </Provider>;\n}",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["mockCollections","Default"]},"./src/shared/components/CollectionsModal/CollectionsModalContainer.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>CollectionsModal_CollectionsModalContainer});var defineProperty=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react=__webpack_require__("../../node_modules/react/index.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),Modal=__webpack_require__("../lib-react-components/dist/esm/Modal/Modal.js"),es=__webpack_require__("../../node_modules/react-i18next/dist/es/index.js"),__jsx=react.createElement;function CollectionsModal(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,children=_ref.children,closeFn=_ref.closeFn,t=(0,es.Bd)("components").t;return __jsx(Modal.A,{active,closeFn,title:t("CollectionsModal.title")},children)}CollectionsModal.displayName="CollectionsModal",CollectionsModal.propTypes={active:prop_types.bool,closeFn:prop_types.func.isRequired};const CollectionsModal_CollectionsModal=CollectionsModal;CollectionsModal.__docgenInfo={description:"",methods:[],displayName:"CollectionsModal",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},closeFn:{description:"",type:{name:"func"},required:!0}}};var asyncToGenerator=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("../../node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),Grid=__webpack_require__("../../node_modules/grommet/es6/components/Grid/Grid.js"),FormField=__webpack_require__("../../node_modules/grommet/es6/components/FormField/FormField.js"),Select=__webpack_require__("../../node_modules/grommet/es6/components/Select/Select.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),Button=__webpack_require__("../../node_modules/grommet/es6/components/Button/Button.js"),SelectCollection_jsx=react.createElement;function SelectCollection(_ref){var _ref$collections=_ref.collections,collections=void 0===_ref$collections?[]:_ref$collections,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,onSearch=_ref.onSearch,onSelect=_ref.onSelect,onSubmit=_ref.onSubmit,_ref$selected=_ref.selected,selected=void 0===_ref$selected?{}:_ref$selected,_ref$userID=_ref.userID,userID=void 0===_ref$userID?"":_ref$userID,_useState=(0,react.useState)(""),searchText=_useState[0],setSearchText=_useState[1],t=(0,es.Bd)("components").t;function _onTextChange(){return(_onTextChange=(0,asyncToGenerator.A)(regenerator_default().mark((function _callee(text){var search;return regenerator_default().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return search=text.trim(),_context.next=1,onSearch({favorite:!1,current_user_roles:"owner,collaborator,contributor",search:search.length>3?search:void 0});case 1:setSearchText(search);case 2:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}var options=searchText.length>3?collections:collections.filter((function collectionNameFilter(collection){var _collection$display_n,displayNameLowerCase=null==collection||null===(_collection$display_n=collection.display_name)||void 0===_collection$display_n?void 0:_collection$display_n.toLowerCase();return!!displayNameLowerCase&&displayNameLowerCase.includes(searchText.toLowerCase())}));return SelectCollection_jsx(Grid.x,{as:"form",columns:["2fr","1fr"],gap:"small",rows:["1fr"],method:"post",action:"",onSubmit},SelectCollection_jsx(FormField.z,{htmlFor:"collectionsSearch",label:t("CollectionsModal.SelectCollection.label")},SelectCollection_jsx(Select.l,{dropHeight:"medium",dropProps:{trapFocus:!1},id:"collectionsSearch",labelKey:function collectionLabel(collection){var _collection$links,_collection$links2;return(null==collection||null===(_collection$links=collection.links)||void 0===_collection$links||null===(_collection$links=_collection$links.owner)||void 0===_collection$links?void 0:_collection$links.id)===userID?null==collection?void 0:collection.display_name:"".concat(null==collection?void 0:collection.display_name," (").concat(null==collection||null===(_collection$links2=collection.links)||void 0===_collection$links2||null===(_collection$links2=_collection$links2.owner)||void 0===_collection$links2?void 0:_collection$links2.display_name,")")},name:"display_name",onChange:onSelect,onSearch:function onTextChange(_x){return _onTextChange.apply(this,arguments)},options,valueKey:"id",value:selected})),SelectCollection_jsx(Box.a,{align:"center",margin:{top:"medium"},pad:{top:"small"}},SelectCollection_jsx(Button.$,{disabled,label:t("CollectionsModal.SelectCollection.addButton"),type:"submit"})))}SelectCollection.displayName="SelectCollection",SelectCollection.propTypes={disabled:prop_types.bool,selected:(0,prop_types.shape)({})};const SelectCollection_SelectCollection=(0,mobxreact_esm.PA)(SelectCollection);SelectCollection.__docgenInfo={description:"",methods:[],displayName:"SelectCollection",props:{collections:{defaultValue:{value:"[]",computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},selected:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{}},required:!1},userID:{defaultValue:{value:"''",computed:!1},required:!1}}};var TextInput=__webpack_require__("../../node_modules/grommet/es6/components/TextInput/TextInput.js"),CheckBox=__webpack_require__("../../node_modules/grommet/es6/components/CheckBox/CheckBox.js"),CreateCollection_jsx=react.createElement,defaultCollection={display_name:"",private:!1},DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function CreateCollection(_ref){var _ref$collection=_ref.collection,collection=void 0===_ref$collection?defaultCollection:_ref$collection,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$onChange=_ref.onChange,onChange=void 0===_ref$onChange?DEFAULT_HANDLER:_ref$onChange,_ref$onSubmit=_ref.onSubmit,onSubmit=void 0===_ref$onSubmit?DEFAULT_HANDLER:_ref$onSubmit,t=(0,es.Bd)("components").t,checkboxRef=(0,react.useRef)(),textInputRef=(0,react.useRef)(),display_name=collection.display_name,isPrivate=collection.private;function updateCollection(){var display_name=textInputRef.current.value,isPrivate=checkboxRef.current.checked;onChange({display_name,private:isPrivate})}return CreateCollection_jsx(Grid.x,{as:"form",columns:["2fr","1fr"],gap:"small",rows:["1fr"],method:"post",action:"",onSubmit},CreateCollection_jsx(FormField.z,{htmlFor:"collectionName",label:t("CollectionsModal.CreateCollection.label")},CreateCollection_jsx(TextInput.k,{id:"collectionName",onChange:updateCollection,ref:textInputRef,value:display_name})),CreateCollection_jsx(Box.a,{align:"center",margin:{top:"medium"},pad:{top:"small"}},CreateCollection_jsx(Button.$,{disabled,label:t("CollectionsModal.CreateCollection.createButton"),type:"submit"})),CreateCollection_jsx(CheckBox.o,{checked:isPrivate,label:t("CollectionsModal.CreateCollection.private"),onChange:updateCollection,ref:checkboxRef}))}CreateCollection.displayName="CreateCollection",CreateCollection.propTypes={collection:(0,prop_types.shape)({display_name:prop_types.string,private:prop_types.bool}),disabled:prop_types.bool,onChange:prop_types.func,onSubmit:prop_types.func};const CreateCollection_CreateCollection=CreateCollection;CreateCollection.__docgenInfo={description:"",methods:[],displayName:"CreateCollection",props:{collection:{defaultValue:{value:"{\n  display_name: '',\n  private: false\n}",computed:!1},description:"",type:{name:"shape",value:{display_name:{name:"string",required:!1},private:{name:"bool",required:!1}}},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},onChange:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"custom",raw:"func"},required:!1},onSubmit:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"custom",raw:"func"},required:!1}}};var CollectionsModalContainer_jsx=react.createElement;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var CollectionsModalContainer_DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0},defaultNewCollection={display_name:"",private:!1},CollectionsModalContainer=function CollectionsModalContainer(_ref){var _ref$collectionsModal=_ref.collectionsModalActive,collectionsModalActive=void 0!==_ref$collectionsModal&&_ref$collectionsModal,_ref$setCollectionsMo=_ref.setCollectionsModalActive,setCollectionsModalActive=void 0===_ref$setCollectionsMo?CollectionsModalContainer_DEFAULT_HANDLER:_ref$setCollectionsMo,_ref$subjectID=_ref.subjectID,subjectID=void 0===_ref$subjectID?"":_ref$subjectID,_useStore=function useStore(){var _store$user,store=(0,react.useContext)(mobxreact_esm.Db).store,id=store.user.id,_store$user$collectio=null===(_store$user=store.user)||void 0===_store$user?void 0:_store$user.collections;return{addSubjects:_store$user$collectio.addSubjects,collections:_store$user$collectio.collections,createCollection:_store$user$collectio.createCollection,searchCollections:_store$user$collectio.searchCollections,userID:id}}(),_useStore$addSubjects=_useStore.addSubjects,addSubjects=void 0===_useStore$addSubjects?CollectionsModalContainer_DEFAULT_HANDLER:_useStore$addSubjects,_useStore$collections=_useStore.collections,collections=void 0===_useStore$collections?[]:_useStore$collections,_useStore$createColle=_useStore.createCollection,createCollection=void 0===_useStore$createColle?CollectionsModalContainer_DEFAULT_HANDLER:_useStore$createColle,_useStore$searchColle=_useStore.searchCollections,searchCollections=void 0===_useStore$searchColle?CollectionsModalContainer_DEFAULT_HANDLER:_useStore$searchColle,_useStore$userID=_useStore.userID,userID=void 0===_useStore$userID?"":_useStore$userID,_useState=(0,react.useState)(defaultNewCollection),newCollection=_useState[0],setNewCollection=_useState[1],_useState2=(0,react.useState)(void 0),selectedCollection=_useState2[0],setSelectedCollection=_useState2[1];function close(){setCollectionsModalActive(!1)}return CollectionsModalContainer_jsx(CollectionsModal_CollectionsModal,{active:collectionsModalActive,closeFn:close},CollectionsModalContainer_jsx(SelectCollection_SelectCollection,{collections,disabled:!selectedCollection,onSearch:searchCollections,onSelect:function onSelect(event){var collection=event.value;setSelectedCollection(collection)},onSubmit:function addToCollection(event){event.preventDefault(),addSubjects(selectedCollection.id,[subjectID]),close()},selected:selectedCollection,userID}),CollectionsModalContainer_jsx(CreateCollection_CreateCollection,{disabled:!newCollection.display_name,collection:newCollection,onChange:function updateCollection(collectionDetails){var updatedCollection=_objectSpread(_objectSpread({},newCollection),collectionDetails);setNewCollection(updatedCollection)},onSearch:searchCollections,onSubmit:function createNewCollection(event){event.preventDefault(),createCollection(newCollection,[subjectID]),close()}}))};CollectionsModalContainer.displayName="CollectionsModalContainer";const CollectionsModal_CollectionsModalContainer=(0,mobxreact_esm.PA)(CollectionsModalContainer);CollectionsModalContainer.propTypes={collectionsModalActive:prop_types.bool,setCollectionsModalActive:prop_types.func,subjectID:prop_types.string},CollectionsModalContainer.__docgenInfo={description:"",methods:[],displayName:"CollectionsModalContainer",props:{collectionsModalActive:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},setCollectionsModalActive:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"custom",raw:"func"},required:!1},subjectID:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"custom",raw:"string"},required:!1}}}}}]);