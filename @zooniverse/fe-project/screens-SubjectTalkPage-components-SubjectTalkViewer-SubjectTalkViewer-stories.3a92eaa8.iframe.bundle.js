"use strict";(self.webpackChunk_zooniverse_fe_project=self.webpackChunk_zooniverse_fe_project||[]).push([[2963],{"../lib-react-components/dist/esm/IconActionButton/IconActionButton.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var grommet__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/grommet/es6/components/Button/Button.js"),grommet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),grommet__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),grommet__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/grommet/es6/components/Tip/Tip.js"),prop_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/prop-types/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),_excluded=["active","a11yTitle","disabled","dropProps","icon","href","onBlur","onClick","onFocus","onPointerDown","onPointerOut","onPointerOver","onPointerUp","role"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var StyledButton=(0,styled_components__WEBPACK_IMPORTED_MODULE_5__.default)(grommet__WEBPACK_IMPORTED_MODULE_0__.$).withConfig({displayName:"IconActionButton__StyledButton",componentId:"sc-j72o44-0"})(["align-items:center;aspect-ratio:1;background-color:",";border:1.5px solid transparent;border-radius:50%;display:flex;height:",";justify-content:center;width:",";> svg{fill:",";stroke:",";width:min(50%,1.2rem);}&:disabled{cursor:not-allowed;background-color:",";> svg{fill:",";}}&:hover:not(:disabled){background-color:",";> svg{fill:",";stroke:",";}.invert-icon{circle{fill:",";}path{fill:",";}}}&:focus-visible:not(:disabled){border:1.5px solid ",";box-shadow:0px 0px 8px ",";outline:none;}&:active:not(:disabled),&[aria-pressed='true'],&[aria-checked='true']{background-color:",";> svg{fill:",";stroke:",";}}"],props=>props.theme.dark?props.theme.global.colors["dark-3"]:props.theme.global.colors["neutral-6"],props=>props.height||"40px",props=>props.width||"40px",props=>props.theme.dark?props.theme.global.colors["neutral-6"]:props.theme.global.colors["dark-5"],props=>props.theme.dark?props.theme.global.colors["neutral-6"]:props.theme.global.colors["dark-5"],props=>props.theme.global.colors["light-4"],props=>props.theme.global.colors["light-5"],props=>props.theme.global.colors["accent-1"],props=>props.theme.global.colors["neutral-6"],props=>props.theme.global.colors["neutral-6"],props=>props.theme.dark?props.theme.global.colors["accent-1"]:props.theme.global.colors["neutral-6"],props=>props.theme.dark?props.theme.global.colors["neutral-6"]:props.theme.global.colors["accent-1"],props=>props.theme.global.colors["accent-1"],props=>props.theme.global.colors["accent-1"],props=>props.theme.global.colors["neutral-1"],props=>props.theme.global.colors["neutral-6"],props=>props.theme.global.colors["neutral-6"]),HoverContent=(0,styled_components__WEBPACK_IMPORTED_MODULE_5__.default)(grommet__WEBPACK_IMPORTED_MODULE_1__.a).withConfig({displayName:"IconActionButton__HoverContent",componentId:"sc-j72o44-1"})(["display:none;@media (hover:hover){display:flex;}"]),TipContent=_ref=>{var{message=""}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(HoverContent,{direction:"row",align:"center",width:"100%",animation:{delay:250,duration:200,type:"fadeIn"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(grommet__WEBPACK_IMPORTED_MODULE_1__.a,{background:"dark-4",round:"5px",pad:"5px",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(grommet__WEBPACK_IMPORTED_MODULE_2__.E,{children:message})})})},DEFAULT_DROP_PROPS={align:{top:"bottom"}},DEFAULT_HANDLER=()=>!0;function IconActionButton(_ref2){var{active=!1,a11yTitle,disabled=!1,dropProps=DEFAULT_DROP_PROPS,icon,href,onBlur=DEFAULT_HANDLER,onClick=DEFAULT_HANDLER,onFocus=DEFAULT_HANDLER,onPointerDown=DEFAULT_HANDLER,onPointerOut=DEFAULT_HANDLER,onPointerOver=DEFAULT_HANDLER,onPointerUp=DEFAULT_HANDLER,role}=_ref2,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref2,_excluded),eventHandlers=disabled?{}:{onBlur,onClick,onFocus,onPointerDown,onPointerOut,onPointerOver,onPointerUp},ariaPressed="checkbox"===role||href?void 0:active.toString();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(grommet__WEBPACK_IMPORTED_MODULE_3__.Y,{content:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(TipContent,{message:a11yTitle}),plain:!0,dropProps,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(StyledButton,_objectSpread(_objectSpread({a11yTitle,active,"aria-pressed":ariaPressed,disabled,href,icon,plain:!0,role},eventHandlers),props))})}IconActionButton.propTypes={active:prop_types__WEBPACK_IMPORTED_MODULE_4__.bool,a11yTitle:prop_types__WEBPACK_IMPORTED_MODULE_4__.string,disabled:prop_types__WEBPACK_IMPORTED_MODULE_4__.bool,dropProps:(0,prop_types__WEBPACK_IMPORTED_MODULE_4__.shape)({align:(0,prop_types__WEBPACK_IMPORTED_MODULE_4__.shape)({top:prop_types__WEBPACK_IMPORTED_MODULE_4__.string,bottom:prop_types__WEBPACK_IMPORTED_MODULE_4__.string,left:prop_types__WEBPACK_IMPORTED_MODULE_4__.string,right:prop_types__WEBPACK_IMPORTED_MODULE_4__.string})}),href:prop_types__WEBPACK_IMPORTED_MODULE_4__.string,icon:(0,prop_types__WEBPACK_IMPORTED_MODULE_4__.oneOfType)([prop_types__WEBPACK_IMPORTED_MODULE_4__.node,prop_types__WEBPACK_IMPORTED_MODULE_4__.object]),onBlur:prop_types__WEBPACK_IMPORTED_MODULE_4__.func,onClick:prop_types__WEBPACK_IMPORTED_MODULE_4__.func,onFocus:prop_types__WEBPACK_IMPORTED_MODULE_4__.func,onPointerDown:prop_types__WEBPACK_IMPORTED_MODULE_4__.func,onPointerOut:prop_types__WEBPACK_IMPORTED_MODULE_4__.func,onPointerOver:prop_types__WEBPACK_IMPORTED_MODULE_4__.func,onPointerUp:prop_types__WEBPACK_IMPORTED_MODULE_4__.func,role:prop_types__WEBPACK_IMPORTED_MODULE_4__.string,theme:(0,prop_types__WEBPACK_IMPORTED_MODULE_4__.shape)({dark:prop_types__WEBPACK_IMPORTED_MODULE_4__.bool})};const __WEBPACK_DEFAULT_EXPORT__=IconActionButton},"./src/screens/SubjectTalkPage/components/SubjectTalkViewer/SubjectTalkViewer.stories.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LoggedOut:()=>LoggedOut,MultiImageSubject:()=>MultiImageSubject,SingleImageSubject:()=>SingleImageSubject,VideoSubject:()=>VideoSubject,__namedExportsOrder:()=>__namedExportsOrder,default:()=>SubjectTalkViewer_stories});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),Media=__webpack_require__("../lib-react-components/dist/esm/Media/Media.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),src=__webpack_require__("../lib-panoptes-js/src/index.js"),index=__webpack_require__("../../node_modules/swr/dist/index/index.mjs"),auth=__webpack_require__("../../node_modules/panoptes-client/lib/auth.js"),auth_default=__webpack_require__.n(auth),react=__webpack_require__("../../node_modules/react/index.js");function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}var defaultToken,_getDefaultToken;function useUserCollections_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}(_getDefaultToken=_asyncToGenerator(function*(){defaultToken=null,yield auth_default().checkCurrent(),defaultToken=yield auth_default().checkBearerToken()}),function getDefaultToken(){return _getDefaultToken.apply(this,arguments)})();var SWRoptions={revalidateIfStale:!0,revalidateOnMount:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshInterval:0};function fetchUserCollections(_x){return _fetchUserCollections.apply(this,arguments)}function _fetchUserCollections(){return _fetchUserCollections=function useUserCollections_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){useUserCollections_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){useUserCollections_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(function*(_ref){var _response$body,{query,token}=_ref,authorization="Bearer ".concat(token),response=yield src._f.get({authorization,query});return null==response||null===(_response$body=response.body)||void 0===_response$body?void 0:_response$body.collections}),_fetchUserCollections.apply(this,arguments)}function useUserCollections(_ref2){var{query}=_ref2,token=function usePanoptesAuthToken(){var[token,setToken]=(0,react.useState)(defaultToken);function _fetchPanoptesAuthToken(){return(_fetchPanoptesAuthToken=_asyncToGenerator(function*(){yield auth_default().checkCurrent();var newToken=yield auth_default().checkBearerToken();newToken!==token&&setToken(newToken)})).apply(this,arguments)}return function fetchPanoptesAuthToken(){_fetchPanoptesAuthToken.apply(this,arguments)}(),token}(),key=token&&query?{query,token}:null;return(0,index.Ay)(key,fetchUserCollections,SWRoptions)}function addSubjectsToCollection_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function addSubjectsToCollection(_x){return _addSubjectsToCollection.apply(this,arguments)}function _addSubjectsToCollection(){return _addSubjectsToCollection=function addSubjectsToCollection_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){addSubjectsToCollection_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){addSubjectsToCollection_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(function*(_ref){var _response$body,{collectionId,subjectIds}=_ref,token=yield auth_default().checkBearerToken(),params={authorization:"Bearer ".concat(token),id:collectionId,subjects:subjectIds},response=yield src._f.addSubjects(params),[collection]=null==response||null===(_response$body=response.body)||void 0===_response$body?void 0:_response$body.collections;return collection}),_addSubjectsToCollection.apply(this,arguments)}function createCollection_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function createCollection(_x){return _createCollection.apply(this,arguments)}function _createCollection(){return _createCollection=function createCollection_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){createCollection_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){createCollection_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(function*(_ref){var{options,projectId,subjectIds}=_ref,token=yield auth_default().checkBearerToken(),authorization="Bearer ".concat(token),response=yield src._f.create({authorization,data:options,project:projectId,subjects:subjectIds}),[newCollection]=response.body.collections;return newCollection}),_createCollection.apply(this,arguments)}function removeSubjectsFromCollection_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _removeSubjectsFromCollection(){return _removeSubjectsFromCollection=function removeSubjectsFromCollection_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){removeSubjectsFromCollection_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){removeSubjectsFromCollection_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(function*(_ref){var{collectionId,subjectIds}=_ref,token=yield auth_default().checkBearerToken(),params={authorization:"Bearer ".concat(token),id:collectionId,subjects:subjectIds},response=yield src._f.removeSubjects(params);if(204===(null==response?void 0:response.status))return{id:collectionId};throw new Error("Unexpected response from removeSubjects")}),_removeSubjectsFromCollection.apply(this,arguments)}var Favorite=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Favorite.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),i18n=__webpack_require__("../lib-react-components/dist/esm/translations/i18n.js"),IconActionButton=__webpack_require__("../lib-react-components/dist/esm/IconActionButton/IconActionButton.js"),StyledFavorite=(0,styled_components_browser_esm.default)(Favorite.N).withConfig({displayName:"FavoritesIconButton__StyledFavorite",componentId:"sc-170r1qe-0"})(['path[fill="none"]{fill:',";}"],props=>props.$isFavorite?props.theme.global.colors.statusColors.error:"none"),DEFAULT_HANDLER=()=>!0;function FavoritesIconButton(_ref){var{checked=!1,disabled=!1,onClick=DEFAULT_HANDLER}=_ref,{t}=(0,i18n.B)(),label=checked?"FavouritesButton.remove":"FavouritesButton.add";return(0,jsx_runtime.jsx)(IconActionButton.A,{a11yTitle:t(label),"aria-checked":checked,disabled,icon:(0,jsx_runtime.jsx)(StyledFavorite,{$isFavorite:checked}),role:"checkbox",onClick:function toggleFavorite(){onClick()}})}FavoritesIconButton.propTypes={checked:prop_types.bool,disabled:prop_types.bool,onClick:prop_types.func};const FavoritesIconButton_FavoritesIconButton=FavoritesIconButton;var console=__webpack_require__("../../node_modules/console-browserify/index.js"),_excluded=["login","projectId","projectSlug","subjectId"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function FavoritesIconButtonContainer(_ref){var _favorites$0$links$su,_favorites$,{login,projectId,projectSlug,subjectId}=_ref,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),query={favorite:!0,project_ids:[projectId],owner:login},{data:favorites,error,isLoading,mutate}=useUserCollections({query:login&&query}),isFavorite=null!==(_favorites$0$links$su=null==favorites||null===(_favorites$=favorites[0])||void 0===_favorites$||null===(_favorites$=_favorites$.links)||void 0===_favorites$||null===(_favorites$=_favorites$.subjects)||void 0===_favorites$?void 0:_favorites$.includes(subjectId))&&void 0!==_favorites$0$links$su&&_favorites$0$links$su;function handleRemoveFromFavorites(){mutate(prevData=>{var indexToRemove=prevData[0].links.subjects.indexOf(subjectId),newSubjects=prevData[0].links.subjects.slice();return indexToRemove>-1&&newSubjects.splice(indexToRemove,1),[_objectSpread(_objectSpread({},prevData[0]),{},{links:_objectSpread(_objectSpread({},prevData[0].links),{},{subjects:newSubjects})})]},{revalidate:!1});try{!function removeSubjectsFromCollection(_x){return _removeSubjectsFromCollection.apply(this,arguments)}({collectionId:favorites[0].id,subjectIds:[subjectId]})}catch(error){console.error(error)}}return(0,jsx_runtime.jsx)(FavoritesIconButton_FavoritesIconButton,_objectSpread({checked:isFavorite,disabled:isLoading||!!error,onClick:function handleClick(){isFavorite?handleRemoveFromFavorites():function handleAddToFavorites(){mutate(prevData=>prevData&&0!==prevData.length?[_objectSpread(_objectSpread({},prevData[0]),{},{links:_objectSpread(_objectSpread({},prevData[0].links),{},{subjects:[...prevData[0].links.subjects,subjectId]})})]:[{links:{subjects:[subjectId]}}],{revalidate:!1});try{var _favorites$2;null!=favorites&&null!==(_favorites$2=favorites[0])&&void 0!==_favorites$2&&_favorites$2.id?addSubjectsToCollection({collectionId:favorites[0].id,subjectIds:[subjectId]}):createCollection({options:{display_name:"Favorites ".concat(projectSlug),favorite:!0,private:!0},projectId,subjectIds:[subjectId]})}catch(error){console.error(error)}}()}},props))}FavoritesIconButtonContainer.propTypes={login:prop_types.string,projectId:prop_types.string,projectSlug:prop_types.string,subjectId:prop_types.string.isRequired};const FavoritesIconButton_FavoritesIconButtonContainer=FavoritesIconButtonContainer;var Bookmark=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Bookmark.js"),Modal=__webpack_require__("../lib-react-components/dist/esm/Modal/Modal.js");function CollectionsModal(_ref){var{active=!1,children,closeFn}=_ref,{t}=(0,i18n.B)();return(0,jsx_runtime.jsx)(Modal.A,{active,closeFn,title:t("CollectionsModal.title"),children})}CollectionsModal.propTypes={active:prop_types.bool,closeFn:prop_types.func.isRequired};const CollectionsModal_CollectionsModal=CollectionsModal;var Grid=__webpack_require__("../../node_modules/grommet/es6/components/Grid/Grid.js"),FormField=__webpack_require__("../../node_modules/grommet/es6/components/FormField/FormField.js"),Select=__webpack_require__("../../node_modules/grommet/es6/components/Select/Select.js"),Button=__webpack_require__("../../node_modules/grommet/es6/components/Button/Button.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js");function SelectCollection_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function SelectCollection(_ref){var{collections=[],disabled=!1,onSearch,onSelect,onSubmit,selected={},userId=""}=_ref,[searchText,setSearchText]=(0,react.useState)(""),{t}=(0,i18n.B)();function _onTextChange(){return _onTextChange=function SelectCollection_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){SelectCollection_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){SelectCollection_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(function*(text){var search=text.trim();yield onSearch({favorite:!1,current_user_roles:"owner,collaborator,contributor",search:search.length>3?search:void 0}),setSearchText(search)}),_onTextChange.apply(this,arguments)}var options=searchText.length>3?collections:collections.filter(function collectionNameFilter(collection){var _collection$display_n,displayNameLowerCase=null==collection||null===(_collection$display_n=collection.display_name)||void 0===_collection$display_n?void 0:_collection$display_n.toLowerCase();return!!displayNameLowerCase&&displayNameLowerCase.includes(searchText.toLowerCase())});return(0,jsx_runtime.jsxs)(Grid.x,{as:"form",columns:["2fr","1fr"],gap:"small",rows:["1fr"],method:"post",action:"",onSubmit,children:[(0,jsx_runtime.jsx)(FormField.z,{htmlFor:"collectionsSearch",label:t("CollectionsModal.SelectCollection.label"),children:(0,jsx_runtime.jsx)(Select.l,{dropHeight:"medium",dropProps:{trapFocus:!1},id:"collectionsSearch",labelKey:function collectionLabel(collection){var _collection$links,_collection$links2;return(null==collection||null===(_collection$links=collection.links)||void 0===_collection$links||null===(_collection$links=_collection$links.owner)||void 0===_collection$links?void 0:_collection$links.id)===userId?null==collection?void 0:collection.display_name:"".concat(null==collection?void 0:collection.display_name," (").concat(null==collection||null===(_collection$links2=collection.links)||void 0===_collection$links2||null===(_collection$links2=_collection$links2.owner)||void 0===_collection$links2?void 0:_collection$links2.display_name,")")},name:"display_name",onChange:onSelect,onSearch:function onTextChange(_x){return _onTextChange.apply(this,arguments)},options,valueKey:"id",value:selected})}),(0,jsx_runtime.jsx)(Box.a,{align:"center",margin:{top:"medium"},pad:{top:"small"},children:(0,jsx_runtime.jsx)(Button.$,{disabled,label:t("CollectionsModal.SelectCollection.addButton"),type:"submit"})})]})}SelectCollection.propTypes={disabled:prop_types.bool,selected:(0,prop_types.shape)({id:prop_types.string})};const SelectCollection_SelectCollection=(0,mobxreact_esm.PA)(SelectCollection);var TextInput=__webpack_require__("../../node_modules/grommet/es6/components/TextInput/TextInput.js"),CheckBox=__webpack_require__("../../node_modules/grommet/es6/components/CheckBox/CheckBox.js"),defaultCollection={display_name:"",private:!1},CreateCollection_DEFAULT_HANDLER=()=>!0;function CreateCollection(_ref){var{collection=defaultCollection,disabled=!1,onChange=CreateCollection_DEFAULT_HANDLER,onSubmit=CreateCollection_DEFAULT_HANDLER}=_ref,{t}=(0,i18n.B)(),checkboxRef=(0,react.useRef)(),textInputRef=(0,react.useRef)(),{display_name,private:isPrivate}=collection;function updateCollection(){var display_name=textInputRef.current.value,isPrivate=checkboxRef.current.checked;onChange({display_name,private:isPrivate})}return(0,jsx_runtime.jsxs)(Grid.x,{as:"form",columns:["2fr","1fr"],gap:"small",rows:["1fr"],method:"post",action:"",onSubmit,children:[(0,jsx_runtime.jsx)(FormField.z,{htmlFor:"collectionName",label:t("CollectionsModal.CreateCollection.label"),children:(0,jsx_runtime.jsx)(TextInput.k,{id:"collectionName",onChange:updateCollection,ref:textInputRef,value:display_name})}),(0,jsx_runtime.jsx)(Box.a,{align:"center",margin:{top:"medium"},pad:{top:"small"},children:(0,jsx_runtime.jsx)(Button.$,{disabled,label:t("CollectionsModal.CreateCollection.createButton"),type:"submit"})}),(0,jsx_runtime.jsx)(CheckBox.o,{checked:isPrivate,label:t("CollectionsModal.CreateCollection.private"),onChange:updateCollection,ref:checkboxRef})]})}CreateCollection.propTypes={collection:(0,prop_types.shape)({display_name:prop_types.string,private:prop_types.bool}),disabled:prop_types.bool,onChange:prop_types.func,onSubmit:prop_types.func};const CreateCollection_CreateCollection=CreateCollection;function CollectionsModalContainer_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function CollectionsModalContainer_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?CollectionsModalContainer_ownKeys(Object(t),!0).forEach(function(r){CollectionsModalContainer_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):CollectionsModalContainer_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function CollectionsModalContainer_defineProperty(e,r,t){return(r=function CollectionsModalContainer_toPropertyKey(t){var i=function CollectionsModalContainer_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var CollectionsModalContainer_DEFAULT_HANDLER=()=>!0,DEFAULT_COLLECTION_QUERY={favorite:!1,current_user_roles:"owner,collaborator,contributor",page_size:100},defaultNewCollection={display_name:"",private:!1},CollectionsModalContainer=_ref=>{var{collectionsModalActive=!1,projectId="",setCollectionsModalActive=CollectionsModalContainer_DEFAULT_HANDLER,subjectId="",userId=""}=_ref,[collectionsQuery,setCollectionsQuery]=(0,react.useState)(DEFAULT_COLLECTION_QUERY),[newCollection,setNewCollection]=(0,react.useState)(defaultNewCollection),[selectedCollection,setSelectedCollection]=(0,react.useState)(void 0),{data:collections,error,isLoading}=useUserCollections({query:collectionsModalActive&&collectionsQuery});function searchCollections(query){setCollectionsQuery(query)}function close(){setCollectionsModalActive(!1)}return(0,jsx_runtime.jsxs)(CollectionsModal_CollectionsModal,{active:collectionsModalActive,closeFn:close,children:[(0,jsx_runtime.jsx)(SelectCollection_SelectCollection,{collections,disabled:!selectedCollection,onSearch:searchCollections,onSelect:function onSelect(event){var collection=event.value;setSelectedCollection(collection)},onSubmit:function addToCollection(event){event.preventDefault(),addSubjectsToCollection({collectionId:selectedCollection.id,subjectIds:[subjectId]}),close()},selected:selectedCollection,userId}),(0,jsx_runtime.jsx)(CreateCollection_CreateCollection,{disabled:!newCollection.display_name,collection:newCollection,onChange:function updateCollection(collectionDetails){var updatedCollection=CollectionsModalContainer_objectSpread(CollectionsModalContainer_objectSpread({},newCollection),collectionDetails);setNewCollection(updatedCollection)},onSearch:searchCollections,onSubmit:function createNewCollection(event){event.preventDefault(),createCollection({options:newCollection,projectId,subjectIds:[subjectId]}),close()}})]})};const CollectionsModal_CollectionsModalContainer=CollectionsModalContainer;CollectionsModalContainer.propTypes={collectionsModalActive:prop_types.bool,projectId:prop_types.string,setCollectionsModalActive:prop_types.func,subjectId:prop_types.string,userId:prop_types.string};var CollectIconButton_excluded=["projectId","subjectId","userId"];function CollectIconButton_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function CollectIconButton_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?CollectIconButton_ownKeys(Object(t),!0).forEach(function(r){CollectIconButton_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):CollectIconButton_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function CollectIconButton_defineProperty(e,r,t){return(r=function CollectIconButton_toPropertyKey(t){var i=function CollectIconButton_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function CollectIconButton(_ref){var{projectId,subjectId,userId}=_ref,props=function CollectIconButton_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function CollectIconButton_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,CollectIconButton_excluded),[collectionsModalActive,setCollectionsModalActive]=(0,react.useState)(!1),{t}=(0,i18n.B)();return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CollectionsModal_CollectionsModalContainer,{collectionsModalActive,projectId,setCollectionsModalActive,subjectId,userId}),(0,jsx_runtime.jsx)(IconActionButton.A,CollectIconButton_objectSpread({a11yTitle:t("CollectIconButton.collect"),icon:(0,jsx_runtime.jsx)(Bookmark.X,{}),onClick:function handleCollectionsModal(){setCollectionsModalActive(!collectionsModalActive)}},props))]})}CollectIconButton.propTypes={projectId:prop_types.string,subjectId:prop_types.string.isRequired,userId:prop_types.string};const CollectIconButton_CollectIconButton=CollectIconButton;var Notification=__webpack_require__("../../node_modules/grommet/es6/components/Notification/Notification.js"),ShareOption=__webpack_require__("../../node_modules/grommet-icons/es6/icons/ShareOption.js"),ShareIconButton_console=__webpack_require__("../../node_modules/console-browserify/index.js");function ShareIconButton_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function ShareIconButton_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ShareIconButton_ownKeys(Object(t),!0).forEach(function(r){ShareIconButton_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ShareIconButton_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function ShareIconButton_defineProperty(e,r,t){return(r=function ShareIconButton_toPropertyKey(t){var i=function ShareIconButton_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ShareIconButton_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function ShareIconButton_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){ShareIconButton_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){ShareIconButton_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const ShareIconButton_ShareIconButton=function ShareIconButton(_ref){var props=_extends({},(function _objectDestructuringEmpty(t){if(null==t)throw new TypeError("Cannot destructure "+t)}(_ref),_ref)),[visible,setVisible]=(0,react.useState)(!1),{t}=(0,i18n.B)();function _writeClipboardText(){return(_writeClipboardText=ShareIconButton_asyncToGenerator(function*(){var url=window.location.href;try{yield navigator.clipboard.writeText(url)}catch(error){ShareIconButton_console.error(error.message)}})).apply(this,arguments)}function _onOpen(){return _onOpen=ShareIconButton_asyncToGenerator(function*(){yield function writeClipboardText(){return _writeClipboardText.apply(this,arguments)}(),setVisible(!0)}),_onOpen.apply(this,arguments)}return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(IconActionButton.A,ShareIconButton_objectSpread({a11yTitle:t("ShareIconButton.share"),icon:(0,jsx_runtime.jsx)(ShareOption.D,{}),onClick:function onOpen(){return _onOpen.apply(this,arguments)}},props)),visible&&(0,jsx_runtime.jsx)(Notification.E,{message:t("ShareIconButton.copied"),onClose:function onClose(){setVisible(!1)},time:4e3,toast:!0})]})};var Blank=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Blank.js");function InvertIcon_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function InvertIcon_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?InvertIcon_ownKeys(Object(t),!0).forEach(function(r){InvertIcon_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):InvertIcon_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function InvertIcon_defineProperty(e,r,t){return(r=function InvertIcon_toPropertyKey(t){var i=function InvertIcon_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var StyledBlank=(0,styled_components_browser_esm.default)(Blank.h).withConfig({displayName:"InvertIcon__StyledBlank",componentId:"sc-17okt0g-0"})(["circle{fill:",";}path{fill:",";}"],props=>props.theme.dark?props.theme.global.colors["neutral-6"]:props.theme.global.colors["dark-5"],props=>props.theme.dark?props.theme.global.colors["dark-5"]:props.theme.global.colors["neutral-6"]);function InvertIcon(props){return(0,jsx_runtime.jsxs)(StyledBlank,InvertIcon_objectSpread(InvertIcon_objectSpread({className:"invert-icon",viewBox:"0 0 32 32"},props),{},{children:[(0,jsx_runtime.jsx)("circle",{cx:"16",cy:"16",r:"15",strokeWidth:1.5}),(0,jsx_runtime.jsx)("path",{d:"M16,1.5c6.6,0,14.5,5.4,14.5,14.5s-5.4,14.5-14.5,14.5"})]}))}var InvertIconButton_excluded=["checked"];function InvertIconButton_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function InvertIconButton_defineProperty(e,r,t){return(r=function InvertIconButton_toPropertyKey(t){var i=function InvertIconButton_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function InvertIconButton(_ref){var{checked=!1}=_ref,props=function InvertIconButton_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function InvertIconButton_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,InvertIconButton_excluded),{t}=(0,i18n.B)(),label=checked?"InvertIconButton.reset":"InvertIconButton.invert";return(0,jsx_runtime.jsx)(IconActionButton.A,function InvertIconButton_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?InvertIconButton_ownKeys(Object(t),!0).forEach(function(r){InvertIconButton_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):InvertIconButton_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({a11yTitle:t(label),active:checked,"aria-checked":checked,icon:(0,jsx_runtime.jsx)(InvertIcon,{}),role:"checkbox"},props))}InvertIconButton.propTypes={checked:prop_types.bool};const InvertIconButton_InvertIconButton=InvertIconButton;var Image=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Image.js"),ImageIconButton_excluded=["disabled","href"];function ImageIconButton_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function ImageIconButton_defineProperty(e,r,t){return(r=function ImageIconButton_toPropertyKey(t){var i=function ImageIconButton_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ImageIconButton(_ref){var{disabled=!1,href=null}=_ref,props=function ImageIconButton_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function ImageIconButton_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,ImageIconButton_excluded),{t}=(0,i18n.B)();return(0,jsx_runtime.jsx)(IconActionButton.A,function ImageIconButton_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ImageIconButton_ownKeys(Object(t),!0).forEach(function(r){ImageIconButton_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ImageIconButton_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({a11yTitle:t("ImageIconButton.viewImage"),disabled,href:disabled?void 0:href,icon:(0,jsx_runtime.jsx)(Image._,{}),target:disabled?void 0:"_blank"},props))}ImageIconButton.propTypes={disabled:prop_types.bool,href:prop_types.string};const ImageIconButton_ImageIconButton=ImageIconButton;var MetaTools_excluded=["invert","location","login","onInvert","projectId","projectSlug","subjectId","userId"];function MetaTools_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function MetaTools_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?MetaTools_ownKeys(Object(t),!0).forEach(function(r){MetaTools_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):MetaTools_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function MetaTools_defineProperty(e,r,t){return(r=function MetaTools_toPropertyKey(t){var i=function MetaTools_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var DEFAULT_LOCATION={};function MetaTools(_ref){var{invert=!1,location=DEFAULT_LOCATION,login,onInvert=null,projectId,projectSlug,subjectId,userId}=_ref,rest=function MetaTools_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function MetaTools_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,MetaTools_excluded),[mimeType,subjectURL]=Object.entries(location)[0],isImage=null==mimeType?void 0:mimeType.includes("image");return(0,jsx_runtime.jsxs)(Box.a,MetaTools_objectSpread(MetaTools_objectSpread({align:"center",direction:"row",flex:!1,gap:"xsmall",justify:"center",pad:"xsmall"},rest),{},{children:[(0,jsx_runtime.jsx)(FavoritesIconButton_FavoritesIconButtonContainer,{disabled:!login,login,projectId,projectSlug,subjectId}),(0,jsx_runtime.jsx)(CollectIconButton_CollectIconButton,{disabled:!login,projectId,subjectId,userId}),(0,jsx_runtime.jsx)(ShareIconButton_ShareIconButton,{}),onInvert?(0,jsx_runtime.jsx)(InvertIconButton_InvertIconButton,{checked:invert,onClick:onInvert}):null,isImage?(0,jsx_runtime.jsx)(ImageIconButton_ImageIconButton,{href:subjectURL}):null]}))}MetaTools.propTypes={invert:prop_types.bool,location:(0,prop_types.objectOf)(prop_types.string),login:prop_types.string,onInvert:prop_types.func,projectId:prop_types.string,projectSlug:prop_types.string,subjectId:prop_types.string,userId:prop_types.string};const MetaTools_MetaTools=MetaTools;var dynamic=__webpack_require__("../../node_modules/next/dynamic.js"),dynamic_default=__webpack_require__.n(dynamic),es=__webpack_require__("../../node_modules/react-i18next/dist/es/index.js");let t;const FlipbookControls=dynamic_default()(()=>Promise.all([__webpack_require__.e(9330),__webpack_require__.e(4769),__webpack_require__.e(7172),__webpack_require__.e(4815),__webpack_require__.e(5068),__webpack_require__.e(1122),__webpack_require__.e(7734),__webpack_require__.e(6890)]).then(__webpack_require__.bind(__webpack_require__,"../lib-classifier/dist/esm/components/Classifier/index.js")).then(mod=>mod.FlipbookControls),{loadableGenerated:{webpack:()=>["../lib-classifier/dist/esm/components/Classifier/index.js"]},ssr:!1}),StyledMedia=(0,styled_components_browser_esm.default)(Media.A)(t||(t=(t=>t)`
  filter: ${0};
`),props=>props.$invert?"invert(1)":"none");function SubjectTalkViewer({login,projectId,projectSlug,subject,userId}){var _processedLocations_frame,_subject_locations,_subject_locations1;const[frame,setFrame]=(0,react.useState)(0),[flipbookSpeed,setFlipbookSpeed]=(0,react.useState)(1),[invert,setInvert]=(0,react.useState)(!1),[playing,setPlaying]=(0,react.useState)(!1),{t}=(0,es.Bd)("screens"),subjectId=null==subject?void 0:subject.id,processedLocations=function processSubjectLocations(rawLocations){return rawLocations.map(location=>{const[mimeType,url]=Object.entries(location)[0],[type]=mimeType.split("/");return{mimeType,type,url}})}(null==subject?void 0:subject.locations);return(0,jsx_runtime.jsxs)(Box.a,{background:{dark:"dark-3",light:"neutral-6"},border:{color:"light-5",side:"all",size:"0.5px"},height:{min:"300px",max:"90vh"},round:{size:"8px",corner:"bottom"},children:[(0,jsx_runtime.jsx)(StyledMedia,{alt:t("Home.ZooniverseTalk.RecentSubjects.subjectLabel",{id:subjectId}),background:{dark:"dark-3",light:"neutral-6"},fit:"contain",flex:"shrink",$invert:invert,placeholder:(0,jsx_runtime.jsx)(Box.a,{align:"center",justify:"center",height:"40vh",width:"600px",background:{image:"url(https://static.zooniverse.org/fem-assets/subject-placeholder.jpg)",size:"cover",position:"center"}}),subject,src:null==processedLocations||null===(_processedLocations_frame=processedLocations[frame])||void 0===_processedLocations_frame?void 0:_processedLocations_frame.url}),(0,jsx_runtime.jsxs)(Box.a,{flex:!1,children:[(null==subject||null===(_subject_locations=subject.locations)||void 0===_subject_locations?void 0:_subject_locations.length)>1?(0,jsx_runtime.jsx)(FlipbookControls,{currentFrame:frame,flipbookSpeed,locations:processedLocations,onFrameChange:setFrame,onPlayPause:function onPlayPause(){setPlaying(!playing)},playing,playIterations:1,setFlipbookSpeed}):null,(0,jsx_runtime.jsx)(MetaTools_MetaTools,{invert,location:null==subject||null===(_subject_locations1=subject.locations)||void 0===_subject_locations1?void 0:_subject_locations1[frame],login,onInvert:function onInvert(){setInvert(!invert)},projectId,projectSlug,subjectId,userId})]})]})}SubjectTalkViewer.propTypes={login:prop_types.string,projectId:prop_types.string,projectSlug:prop_types.string,subject:(0,prop_types.shape)({id:prop_types.string}),userId:prop_types.string};const SubjectTalkViewer_SubjectTalkViewer=SubjectTalkViewer;SubjectTalkViewer.__docgenInfo={description:"",methods:[],displayName:"SubjectTalkViewer",props:{login:{description:"",type:{name:"custom",raw:"string"},required:!1},projectId:{description:"",type:{name:"custom",raw:"string"},required:!1},projectSlug:{description:"",type:{name:"custom",raw:"string"},required:!1},subject:{description:"",type:{name:"shape",value:{id:{name:"string",required:!1}}},required:!1},userId:{description:"",type:{name:"custom",raw:"string"},required:!1}}};const SingleImageSubjectMock={id:"1234",locations:[{"image/jpeg":"https://panoptes-uploads-staging.zooniverse.org/subject_location/89cdf135-3349-4149-8255-57bc7875323f.png"}]},SubjectTalkViewer_stories={title:"Project App / Screens / Subject Talk / SubjectTalkViewer",component:SubjectTalkViewer_SubjectTalkViewer},SingleImageSubject={args:{login:"zootester1",subject:SingleImageSubjectMock}},MultiImageSubject={args:{login:"zootester1",subject:{id:"5678",locations:[{"image/jpeg":"https://panoptes-uploads.zooniverse.org/production/subject_location/3eecf251-7205-4ef3-b13f-e930c97d92de.jpeg"},{"image/jpeg":"https://panoptes-uploads.zooniverse.org/production/subject_location/11f98201-1c3f-44d5-965b-e00373daeb18.jpeg"},{"image/jpeg":"https://panoptes-uploads.zooniverse.org/production/subject_location/512649e3-33d7-4811-b0f2-64703e687160.jpeg"}]}}},VideoSubject={args:{login:"zootester1",subject:{id:"91011",locations:[{"video/mp4":"https://panoptes-uploads.zooniverse.org/subject_location/5338cc13-764a-4b04-88b4-cab728cb7898.mp4"}]}}},LoggedOut={args:{subject:SingleImageSubjectMock}},__namedExportsOrder=["SingleImageSubject","MultiImageSubject","VideoSubject","LoggedOut"]}}]);
//# sourceMappingURL=screens-SubjectTalkPage-components-SubjectTalkViewer-SubjectTalkViewer-stories.3a92eaa8.iframe.bundle.js.map