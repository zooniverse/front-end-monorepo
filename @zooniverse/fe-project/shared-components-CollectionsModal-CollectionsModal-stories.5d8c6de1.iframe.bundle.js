"use strict";(self.webpackChunk_zooniverse_fe_project=self.webpackChunk_zooniverse_fe_project||[]).push([[2011],{"./src/shared/components/CollectionsModal/CollectionsModal.stories.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__,mockCollections:()=>mockCollections});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),mobx_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),_stores_Store__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stores/Store.js"),_stores_User_Collections_Collections__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stores/User/Collections/Collections.js"),_CollectionsModalContainer__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/shared/components/CollectionsModal/CollectionsModalContainer.jsx");const __WEBPACK_DEFAULT_EXPORT__={title:"Project App / shared / Collections Modal",component:_CollectionsModalContainer__WEBPACK_IMPORTED_MODULE_4__.A,excludeStories:["mockCollections"]},mockCollections=[...["Gravity Spy","TESS","Planet Four","Transcriptions"].map((collection,index)=>_stores_User_Collections_Collections__WEBPACK_IMPORTED_MODULE_3__.p.create({display_name:collection,id:index.toString(),links:{owner:{id:"123"}}})),_stores_User_Collections_Collections__WEBPACK_IMPORTED_MODULE_3__.p.create({display_name:"Transcriptions",id:"934667",links:{owner:{display_name:"Zooni",id:"456"}}})],snapshot={project:{strings:{display_name:"Snapshot Serengeti"}},user:{collections:{collections:mockCollections},id:"123"}},store=_stores_Store__WEBPACK_IMPORTED_MODULE_2__.A.create(snapshot),Default=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(mobx_react__WEBPACK_IMPORTED_MODULE_1__.Kq,{store,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_CollectionsModalContainer__WEBPACK_IMPORTED_MODULE_4__.A,{collectionsModalActive:!0,subjectID:"1234"})}),__namedExportsOrder=["mockCollections","Default"]},"./src/shared/components/CollectionsModal/CollectionsModalContainer.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:()=>CollectionsModal_CollectionsModalContainer});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),react=__webpack_require__("../../node_modules/react/index.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),Modal=__webpack_require__("../lib-react-components/dist/esm/Modal/Modal.js"),es=__webpack_require__("../../node_modules/react-i18next/dist/es/index.js");function CollectionsModal({active=!1,children,closeFn}){const{t}=(0,es.Bd)("components");return(0,jsx_runtime.jsx)(Modal.A,{active,closeFn,title:t("CollectionsModal.title"),children})}CollectionsModal.propTypes={active:prop_types.bool,closeFn:prop_types.func.isRequired};const CollectionsModal_CollectionsModal=CollectionsModal;CollectionsModal.__docgenInfo={description:"",methods:[],displayName:"CollectionsModal",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},closeFn:{description:"",type:{name:"func"},required:!0}}};var Grid=__webpack_require__("../../node_modules/grommet/es6/components/Grid/Grid.js"),FormField=__webpack_require__("../../node_modules/grommet/es6/components/FormField/FormField.js"),Select=__webpack_require__("../../node_modules/grommet/es6/components/Select/Select.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),Button=__webpack_require__("../../node_modules/grommet/es6/components/Button/Button.js");function SelectCollection({collections=[],disabled=!1,onSearch,onSelect,onSubmit,selected={},userID=""}){const[searchText,setSearchText]=(0,react.useState)(""),{t}=(0,es.Bd)("components");const options=searchText.length>3?collections:collections.filter(function collectionNameFilter(collection){var _collection_display_name;const displayNameLowerCase=null==collection||null===(_collection_display_name=collection.display_name)||void 0===_collection_display_name?void 0:_collection_display_name.toLowerCase();return!!displayNameLowerCase&&displayNameLowerCase.includes(searchText.toLowerCase())});return(0,jsx_runtime.jsxs)(Grid.x,{as:"form",columns:["2fr","1fr"],gap:"small",rows:["1fr"],method:"post",action:"",onSubmit,children:[(0,jsx_runtime.jsx)(FormField.z,{htmlFor:"collectionsSearch",label:t("CollectionsModal.SelectCollection.label"),children:(0,jsx_runtime.jsx)(Select.l,{dropHeight:"medium",dropProps:{trapFocus:!1},id:"collectionsSearch",labelKey:function collectionLabel(collection){var _collection_links_owner,_collection_links,_collection_links_owner1,_collection_links1;return(null==collection||null===(_collection_links=collection.links)||void 0===_collection_links||null===(_collection_links_owner=_collection_links.owner)||void 0===_collection_links_owner?void 0:_collection_links_owner.id)===userID?null==collection?void 0:collection.display_name:`${null==collection?void 0:collection.display_name} (${null==collection||null===(_collection_links1=collection.links)||void 0===_collection_links1||null===(_collection_links_owner1=_collection_links1.owner)||void 0===_collection_links_owner1?void 0:_collection_links_owner1.display_name})`},name:"display_name",onChange:onSelect,onSearch:async function onTextChange(text){const search=text.trim();await onSearch({favorite:!1,current_user_roles:"owner,collaborator,contributor",search:search.length>3?search:void 0}),setSearchText(search)},options,valueKey:"id",value:selected})}),(0,jsx_runtime.jsx)(Box.a,{align:"center",margin:{top:"medium"},pad:{top:"small"},children:(0,jsx_runtime.jsx)(Button.$,{disabled,label:t("CollectionsModal.SelectCollection.addButton"),type:"submit"})})]})}SelectCollection.propTypes={disabled:prop_types.bool,selected:(0,prop_types.shape)({})};const SelectCollection_SelectCollection=(0,mobxreact_esm.PA)(SelectCollection);SelectCollection.__docgenInfo={description:"",methods:[],displayName:"SelectCollection",props:{collections:{defaultValue:{value:"[]",computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},selected:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{}},required:!1},userID:{defaultValue:{value:"''",computed:!1},required:!1}}};var TextInput=__webpack_require__("../../node_modules/grommet/es6/components/TextInput/TextInput.js"),CheckBox=__webpack_require__("../../node_modules/grommet/es6/components/CheckBox/CheckBox.js");const defaultCollection={display_name:"",private:!1},DEFAULT_HANDLER=()=>!0;function CreateCollection({collection=defaultCollection,disabled=!1,onChange=DEFAULT_HANDLER,onSubmit=DEFAULT_HANDLER}){const{t}=(0,es.Bd)("components"),checkboxRef=(0,react.useRef)(),textInputRef=(0,react.useRef)(),{display_name,private:isPrivate}=collection;function updateCollection(){const display_name=textInputRef.current.value,isPrivate=checkboxRef.current.checked;onChange({display_name,private:isPrivate})}return(0,jsx_runtime.jsxs)(Grid.x,{as:"form",columns:["2fr","1fr"],gap:"small",rows:["1fr"],method:"post",action:"",onSubmit,children:[(0,jsx_runtime.jsx)(FormField.z,{htmlFor:"collectionName",label:t("CollectionsModal.CreateCollection.label"),children:(0,jsx_runtime.jsx)(TextInput.k,{id:"collectionName",onChange:updateCollection,ref:textInputRef,value:display_name})}),(0,jsx_runtime.jsx)(Box.a,{align:"center",margin:{top:"medium"},pad:{top:"small"},children:(0,jsx_runtime.jsx)(Button.$,{disabled,label:t("CollectionsModal.CreateCollection.createButton"),type:"submit"})}),(0,jsx_runtime.jsx)(CheckBox.o,{checked:isPrivate,label:t("CollectionsModal.CreateCollection.private"),onChange:updateCollection,ref:checkboxRef})]})}CreateCollection.propTypes={collection:(0,prop_types.shape)({display_name:prop_types.string,private:prop_types.bool}),disabled:prop_types.bool,onChange:prop_types.func,onSubmit:prop_types.func};const CreateCollection_CreateCollection=CreateCollection;CreateCollection.__docgenInfo={description:"",methods:[],displayName:"CreateCollection",props:{collection:{defaultValue:{value:"{\n  display_name: '',\n  private: false\n}",computed:!1},description:"",type:{name:"shape",value:{display_name:{name:"string",required:!1},private:{name:"bool",required:!1}}},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},onChange:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"custom",raw:"func"},required:!1},onSubmit:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"custom",raw:"func"},required:!1}}};const CollectionsModalContainer_DEFAULT_HANDLER=()=>!0,defaultNewCollection={display_name:"",private:!1},CollectionsModalContainer=({collectionsModalActive=!1,setCollectionsModalActive=CollectionsModalContainer_DEFAULT_HANDLER,subjectID=""})=>{const{addSubjects=CollectionsModalContainer_DEFAULT_HANDLER,collections=[],createCollection=CollectionsModalContainer_DEFAULT_HANDLER,searchCollections=CollectionsModalContainer_DEFAULT_HANDLER,userID=""}=function useStore(){var _store_user;const{store}=(0,react.useContext)(mobxreact_esm.Db),{id}=store.user,{addSubjects,collections,createCollection,searchCollections}=null===(_store_user=store.user)||void 0===_store_user?void 0:_store_user.collections;return{addSubjects,collections,createCollection,searchCollections,userID:id}}(),[newCollection,setNewCollection]=(0,react.useState)(defaultNewCollection),[selectedCollection,setSelectedCollection]=(0,react.useState)(void 0);function close(){setCollectionsModalActive(!1)}return(0,jsx_runtime.jsxs)(CollectionsModal_CollectionsModal,{active:collectionsModalActive,closeFn:close,children:[(0,jsx_runtime.jsx)(SelectCollection_SelectCollection,{collections,disabled:!selectedCollection,onSearch:searchCollections,onSelect:function onSelect(event){const collection=event.value;setSelectedCollection(collection)},onSubmit:function addToCollection(event){event.preventDefault(),addSubjects(selectedCollection.id,[subjectID]),close()},selected:selectedCollection,userID}),(0,jsx_runtime.jsx)(CreateCollection_CreateCollection,{disabled:!newCollection.display_name,collection:newCollection,onChange:function updateCollection(collectionDetails){const updatedCollection={...newCollection,...collectionDetails};setNewCollection(updatedCollection)},onSearch:searchCollections,onSubmit:function createNewCollection(event){event.preventDefault(),createCollection(newCollection,[subjectID]),close()}})]})},CollectionsModal_CollectionsModalContainer=(0,mobxreact_esm.PA)(CollectionsModalContainer);CollectionsModalContainer.propTypes={collectionsModalActive:prop_types.bool,setCollectionsModalActive:prop_types.func,subjectID:prop_types.string},CollectionsModalContainer.__docgenInfo={description:"",methods:[],displayName:"CollectionsModalContainer",props:{collectionsModalActive:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},setCollectionsModalActive:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"custom",raw:"func"},required:!1},subjectID:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"custom",raw:"string"},required:!1}}}}}]);