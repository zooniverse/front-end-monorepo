"use strict";(self.webpackChunk_zooniverse_fe_project=self.webpackChunk_zooniverse_fe_project||[]).push([[2853],{"../../node_modules/grommet/es6/components/Select/Select.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{l:()=>Select});var react=__webpack_require__("../../node_modules/react/index.js"),use_keyboard=__webpack_require__("../../node_modules/grommet/es6/utils/use-keyboard.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),Keyboard=__webpack_require__("../../node_modules/grommet/es6/components/Keyboard/Keyboard.js"),FormContext=__webpack_require__("../../node_modules/grommet/es6/components/Form/FormContext.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),background=__webpack_require__("../../node_modules/grommet/es6/utils/background.js"),DOM=__webpack_require__("../../node_modules/grommet/es6/utils/DOM.js"),Button=__webpack_require__("../../node_modules/grommet/es6/components/Button/Button.js"),InfiniteScroll=__webpack_require__("../../node_modules/grommet/es6/components/InfiniteScroll/InfiniteScroll.js"),Text=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),TextInput=__webpack_require__("../../node_modules/grommet/es6/components/TextInput/TextInput.js"),DropButton=__webpack_require__("../../node_modules/grommet/es6/components/DropButton/DropButton.js"),styles=__webpack_require__("../../node_modules/grommet/es6/utils/styles.js"),StyledContainer=(0,styled_components_browser_esm.default)(Box.a).withConfig({displayName:"StyledSelect__StyledContainer",componentId:"sc-znp66n-0"})(["@media screen and (-ms-high-contrast:active),(-ms-high-contrast:none){width:100%;}",";",";"],function(props){return props.dropHeight?(0,styles.b7)("max-height",props.dropHeight,props.theme):"max-height: inherit;"},function(props){return props.theme.select.container&&props.theme.select.container.extend}),OptionsContainer=styled_components_browser_esm.default.div.withConfig(styles.OY).withConfig({displayName:"StyledSelect__OptionsContainer",componentId:"sc-znp66n-1"})(["position:relative;scroll-behavior:smooth;overflow:auto;outline:none;",";"],function(props){return props.selectMultiple?props.theme.selectMultiple.listbox&&props.theme.selectMultiple.listbox.extend:props.theme.select.listbox&&props.theme.select.listbox.extend}),HiddenInput=styled_components_browser_esm.default.input.withConfig(styles.OY).withConfig({displayName:"StyledSelect__HiddenInput",componentId:"sc-znp66n-2"})(["display:none;"]),SelectOption=(0,styled_components_browser_esm.default)(Button.$).withConfig({displayName:"StyledSelect__SelectOption",componentId:"sc-znp66n-3"})([""," "," &:focus{","}display:block;width:100%;",";"],function(props){return props.selected&&props.textComponent&&background.$r},function(props){return props.active&&(0,background.du)(props.children||props.theme.select.options?"background":void 0,props.theme)},function(props){return props.active&&(0,background.du)(props.children||props.theme.select.options?"background":void 0,props.theme)},function(props){return props["aria-disabled"]&&"cursor: default"}),SelectTextInput=(0,styled_components_browser_esm.default)(TextInput.k).withConfig({displayName:"StyledSelect__SelectTextInput",componentId:"sc-znp66n-4"})(["cursor:",";"],function(props){return props.defaultCursor?"default":"pointer"}),StyledSelectDropButton=(0,styled_components_browser_esm.default)(DropButton.E).withConfig({displayName:"StyledSelect__StyledSelectDropButton",componentId:"sc-znp66n-5"})(["",";",";",";"],function(props){return!props.plainSelect&&styles.F2},function(props){var _props$theme$select;return null==(_props$theme$select=props.theme.select)||null==(_props$theme$select=_props$theme$select.control)?void 0:_props$theme$select.extend},function(props){var _props$theme$select2;return props.open&&(null==(_props$theme$select2=props.theme.select)||null==(_props$theme$select2=_props$theme$select2.control)?void 0:_props$theme$select2.open)}),colors=__webpack_require__("../../node_modules/grommet/es6/utils/colors.js"),_applyKey=function applyKey(option,key){return(0,react.isValidElement)(option)?option:null!=option?"object"==typeof key?_applyKey(option,key.key):"function"==typeof key?key(option):void 0!==key&&"object"==typeof option?option[key]:"object"==typeof option&&Object.keys(option).length>0?option[Object.keys(option)[0]]:option:void 0},getOptionLabel=function getOptionLabel(index,options,labelKey){return _applyKey(options[index],labelKey)},getOptionValue=function getOptionValue(index,options,valueKey){return _applyKey(options[index],valueKey)},getOptionIndex=function getOptionIndex(options,i,valueKey){if(options)return"object"==typeof i?options.findIndex(function(x){return _applyKey(x,valueKey)===_applyKey(i,valueKey)}):options.indexOf(i)},_formatValueForA11y=function formatValueForA11y(value,labelKey){return"string"==typeof value?value:(0,react.isValidElement)(value)?value.toString():Array.isArray(value)?value.map(function(item){return _formatValueForA11y(item,labelKey)}).join(", "):_applyKey(value,labelKey)},inertTrueValue=!!react.use||"";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var EmptySearchOption=function EmptySearchOption(_ref){var _theme$select,_theme$select2,_theme$select3,emptySearchMessage=_ref.emptySearchMessage,selectOptionsStyle=_ref.selectOptionsStyle,theme=_ref.theme;return react.createElement(Box.a,(null==theme||null==(_theme$select=theme.select)||null==(_theme$select=_theme$select.emptySearchMessage)?void 0:_theme$select.container)||selectOptionsStyle,react.createElement(Text.E,_extends({"aria-live":"polite",role:"alert"},(null==theme||null==(_theme$select2=theme.select)||null==(_theme$select2=_theme$select2.emptySearchMessage)?void 0:_theme$select2.text)||(null==(_theme$select3=theme.select)||null==(_theme$select3=_theme$select3.options)?void 0:_theme$select3.text)),emptySearchMessage))},useThemeValue=__webpack_require__("../../node_modules/grommet/es6/utils/useThemeValue.js"),_excluded=["clear","onClear","name","theme"];function SelectContainer_extends(){return SelectContainer_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},SelectContainer_extends.apply(null,arguments)}var StyledButton=(0,styled_components_browser_esm.default)(Button.$).withConfig({displayName:"SelectContainer__StyledButton",componentId:"sc-1wi0ul8-0"})(["&:focus{","}"],function(props){return(0,background.du)("background",props.theme)}),ClearButton=(0,react.forwardRef)(function(_ref,ref){var clear=_ref.clear,onClear=_ref.onClear,name=_ref.name,theme=_ref.theme,rest=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(_ref,_excluded),label=clear.label,position=clear.position,align="bottom"!==position?"start":"center",buttonLabel=label||"Clear "+(name||"selection"),passThemeFlag=(0,useThemeValue.i)().passThemeFlag;return react.createElement(StyledButton,SelectContainer_extends({a11yTitle:buttonLabel+". Or, press "+("bottom"===position?"shift tab":"down arrow")+" to move to select options",fill:"horizontal",ref,onClick:onClear,focusIndicator:!1,plain:!0},passThemeFlag,rest),function(_ref2){var _theme$select$clear,hover=_ref2.hover,boxProps=SelectContainer_extends({},theme.select.clear.container);return delete boxProps.hover,react.createElement(Box.a,SelectContainer_extends({},boxProps,hover?null==(_theme$select$clear=theme.select.clear)||null==(_theme$select$clear=_theme$select$clear.container)?void 0:_theme$select$clear.hover:{},{align}),react.createElement(Text.E,theme.select.clear.text,buttonLabel))})}),SelectContainer=(0,react.forwardRef)(function(_ref3,ref){var clear=_ref3.clear,_ref3$children=_ref3.children,children=void 0===_ref3$children?null:_ref3$children,disabled=_ref3.disabled,disabledKey=_ref3.disabledKey,dropHeight=_ref3.dropHeight,_ref3$emptySearchMess=_ref3.emptySearchMessage,emptySearchMessage=void 0===_ref3$emptySearchMess?"No matches found":_ref3$emptySearchMess,id=_ref3.id,labelKey=_ref3.labelKey,multiple=_ref3.multiple,name=_ref3.name,onChange=_ref3.onChange,onKeyDown=_ref3.onKeyDown,onMore=_ref3.onMore,onSearch=_ref3.onSearch,optionIndexesInValue=_ref3.optionIndexesInValue,options=_ref3.options,allOptions=_ref3.allOptions,searchPlaceholder=_ref3.searchPlaceholder,search=_ref3.search,setSearch=_ref3.setSearch,selected=_ref3.selected,usingKeyboard=_ref3.usingKeyboard,_ref3$value=_ref3.value,value=void 0===_ref3$value?"":_ref3$value,valueKey=_ref3.valueKey,_ref3$replace=_ref3.replace,replace=void 0===_ref3$replace||_ref3$replace,_useThemeValue2=(0,useThemeValue.i)(),theme=_useThemeValue2.theme,passThemeFlag=_useThemeValue2.passThemeFlag,shouldShowClearButton=(0,react.useCallback)(function(position){var hasValue=Boolean(multiple&&value?value.length:value),showAtPosition="bottom"===position?"bottom"===(null==clear?void 0:clear.position):"bottom"!==(null==clear?void 0:clear.position);return clear&&hasValue&&showAtPosition},[clear,multiple,value]),isDisabled=function useDisabled(disabled,disabledKey,options,valueKey){return(0,react.useCallback)(function(index){var result,option=options[index];if(disabledKey)result=_applyKey(option,disabledKey);else if(Array.isArray(disabled))if("number"==typeof disabled[0])result=-1!==disabled.indexOf(index);else{var optionVal=getOptionValue(index,options,valueKey);result=-1!==getOptionIndex(disabled,options[index],valueKey)||-1!==getOptionIndex(disabled,optionVal,valueKey)}return result},[disabled,disabledKey,options,valueKey])}(disabled,disabledKey,options,valueKey||labelKey),_useState=(0,react.useState)(!usingKeyboard||shouldShowClearButton("top")||onSearch?-1:0),activeIndex=_useState[0],setActiveIndex=_useState[1],_useState2=(0,react.useState)(usingKeyboard),keyboardNavigation=_useState2[0],setKeyboardNavigation=_useState2[1],searchRef=(0,react.useRef)(),optionsRef=(0,react.useRef)(),clearRef=(0,react.useRef)(),activeRef=(0,react.useRef)();(0,react.useEffect)(function(){var _activeRef$current;activeIndex>=0&&(null==(_activeRef$current=activeRef.current)||_activeRef$current.focus())},[activeIndex]),(0,react.useEffect)(function(){var timer=setTimeout(function(){var optionsNode=optionsRef.current,clearButton=clearRef.current;if(onSearch){var searchInput=searchRef.current;searchInput&&searchInput.focus&&!activeRef.current&&(0,DOM.Cd)(searchInput)}else clear&&clearButton&&clearButton.focus&&"bottom"!==clear.position?(0,DOM.Cd)(clearButton):usingKeyboard&&activeRef.current?(0,DOM.Cd)(activeRef.current):optionsNode&&(0,DOM.Cd)(optionsNode)},100);return function(){return clearTimeout(timer)}},[onSearch,usingKeyboard,clear]);var isSelected=(0,react.useCallback)(function(index){var result;if(selected)result=-1!==selected.indexOf(index);else{var optionVal=getOptionValue(index,options,valueKey);if(Array.isArray(value))0===value.length?result=!1:"object"!=typeof value[0]?result=-1!==value.indexOf(optionVal):valueKey&&(result=value.some(function(valueItem){return("function"==typeof valueKey?valueKey(valueItem):valueItem[valueKey]||valueItem[valueKey.key])===optionVal}));else if(valueKey&&null!==value&&"object"==typeof value){result=("function"==typeof valueKey?valueKey(value):value[valueKey])===optionVal}else result=value===optionVal}return result},[selected,value,valueKey,options]),selectOption=(0,react.useCallback)(function(index){return function(event){if(onChange){var nextValue,nextSelected;if(multiple){var nextOptionIndexesInValue=optionIndexesInValue.slice(0),allOptionsIndex=allOptions.indexOf(options[index]),valueIndex=optionIndexesInValue.indexOf(allOptionsIndex);-1===valueIndex?nextOptionIndexesInValue.push(allOptionsIndex):nextOptionIndexesInValue.splice(valueIndex,1),nextValue=nextOptionIndexesInValue.map(function(i){return valueKey&&valueKey.reduce?_applyKey(allOptions[i],valueKey):allOptions[i]}),nextSelected=nextOptionIndexesInValue}else nextValue=valueKey&&valueKey.reduce?_applyKey(options[index],valueKey):options[index],nextSelected=index;onChange(event,{option:options[index],value:nextValue,selected:nextSelected})}}},[multiple,onChange,optionIndexesInValue,options,allOptions,valueKey]),onClear=(0,react.useCallback)(function(event){onChange(event,{option:void 0,value:"",selected:""})},[onChange]),onNextOption=(0,react.useCallback)(function(event){event.preventDefault();for(var nextActiveIndex=activeIndex+1;nextActiveIndex<options.length&&isDisabled(nextActiveIndex);)nextActiveIndex+=1;nextActiveIndex!==options.length&&(setActiveIndex(nextActiveIndex),setKeyboardNavigation(!0))},[activeIndex,options,isDisabled]),onPreviousOption=(0,react.useCallback)(function(event){event.preventDefault();var nextActiveIndex=activeIndex-1;if(-1===nextActiveIndex){var searchInput=searchRef.current,clearButton=clearRef.current;clearButton&&clearButton.focus&&shouldShowClearButton("top")?(setActiveIndex(nextActiveIndex),(0,DOM.Cd)(clearButton)):searchInput&&searchInput.focus&&(setActiveIndex(nextActiveIndex),(0,DOM.Cd)(searchInput))}for(;nextActiveIndex>=0&&isDisabled(nextActiveIndex);)nextActiveIndex-=1;nextActiveIndex>=0&&(setActiveIndex(nextActiveIndex),setKeyboardNavigation(!0))},[activeIndex,isDisabled,shouldShowClearButton]),onKeyDownOption=(0,react.useCallback)(function(event){if(!onSearch){var nextActiveIndex=options.findIndex(function(e,index){var label;return"string"==typeof(label="object"==typeof e?e.label||_applyKey(e,labelKey):e)&&label.charAt(0).toLowerCase()===event.key.toLowerCase()&&!isDisabled(index)});nextActiveIndex>=0&&(event.preventDefault(),setActiveIndex(nextActiveIndex),setKeyboardNavigation(!0))}onKeyDown&&onKeyDown(event)},[isDisabled,labelKey,onKeyDown,options,onSearch]),onActiveOption=(0,react.useCallback)(function(index){return function(){keyboardNavigation||setActiveIndex(index)}},[keyboardNavigation]),onSelectOption=(0,react.useCallback)(function(event){(shouldShowClearButton("bottom")||shouldShowClearButton("top"))&&(0,DOM.Wi)(clearRef.current)?onChange(event,{option:void 0,value:"",selected:""}):activeIndex>=0&&activeIndex<options.length&&(event.preventDefault(),selectOption(activeIndex)(event))},[activeIndex,selectOption,options,onChange,shouldShowClearButton]),customSearchInput=theme.select.searchInput,SelectTextInput=customSearchInput||TextInput.k,selectOptionsStyle=theme.select.options?SelectContainer_extends({},theme.select.options.box,theme.select.options.container):{};return react.createElement(Keyboard.s,{onEnter:onSelectOption,onSpace:onSelectOption,onUp:onPreviousOption,onDown:onNextOption,onKeyDown:onKeyDownOption},react.createElement(StyledContainer,SelectContainer_extends({ref,id:id?id+"__select-drop":void 0,dropHeight},passThemeFlag),onSearch&&react.createElement(Box.a,{pad:customSearchInput?void 0:"xsmall",flex:!1},react.createElement(SelectTextInput,{focusIndicator:!customSearchInput,size:"small",ref:searchRef,type:"search",value:search||"",placeholder:searchPlaceholder,onChange:function onChange(event){var nextSearch=event.target.value;setSearch(nextSearch),setActiveIndex(-1),onSearch(nextSearch)}})),shouldShowClearButton("top")&&react.createElement(ClearButton,{ref:clearRef,clear,name,onClear,onFocus:function onFocus(){return setActiveIndex(-1)},onMouseOver:function onMouseOver(){return setActiveIndex(-1)},theme}),options.length>0?react.createElement(OptionsContainer,{role:"listbox",tabIndex:"-1",ref:optionsRef,"aria-multiselectable":multiple,onMouseMove:function onMouseMove(){return setKeyboardNavigation(!1)}},react.createElement(InfiniteScroll.u,{items:options,step:theme.select.step,onMore,replace,show:-1!==activeIndex?activeIndex:void 0},function(option,index,optionRef){var child,optionDisabled=isDisabled(index),optionSelected=isSelected(index),optionActive=activeIndex===index,textComponent=!1;return children?("string"==typeof(child=children(option,index,options,{active:optionActive,disabled:optionDisabled,selected:optionSelected}))||child.props&&child.props.children&&"string"==typeof child.props.children)&&(textComponent=!0):theme.select.options&&(child=react.createElement(Box.a,selectOptionsStyle,react.createElement(Text.E,theme.select.options.text,getOptionLabel(index,options,labelKey))),textComponent=!0),react.createElement(SelectOption,SelectContainer_extends({key:index,ref:function ref(node){optionRef&&(optionRef.current=node),optionActive&&(activeRef.current=node)},tabIndex:optionSelected?"0":"-1",role:"option","aria-setsize":options.length,"aria-posinset":index+1,"aria-selected":optionSelected,focusIndicator:!1,"aria-disabled":optionDisabled||void 0,plain:!!child||void 0,align:"start",kind:child?void 0:"option",label:child?void 0:getOptionLabel(index,options,labelKey||valueKey),disabled:optionDisabled||void 0,active:optionActive,selected:optionSelected,onFocus:function onFocus(){return setActiveIndex(index)},onMouseOver:optionDisabled?void 0:onActiveOption(index),onMouseOut:optionDisabled?void 0:onActiveOption(-1),onClick:optionDisabled?void 0:selectOption(index),textComponent},passThemeFlag),child)})):react.createElement(EmptySearchOption,{emptySearchMessage,selectOptionsStyle,theme}),shouldShowClearButton("bottom")&&react.createElement(ClearButton,{ref:clearRef,clear,name,onClear,onFocus:function onFocus(){return setActiveIndex(-1)},onMouseOver:function onMouseOver(){return setActiveIndex(-1)},theme})))}),DefaultSelectTextInput_excluded=["disabled","id"];function DefaultSelectTextInput_extends(){return DefaultSelectTextInput_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},DefaultSelectTextInput_extends.apply(null,arguments)}var DefaultSelectTextInput=(0,react.forwardRef)(function(_ref,ref){var disabled=_ref.disabled,id=_ref.id,rest=function DefaultSelectTextInput_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(_ref,DefaultSelectTextInput_excluded);return react.createElement(SelectTextInput,DefaultSelectTextInput_extends({defaultCursor:!0===disabled||void 0,focusIndicator:!1,id:id?id+"__input":void 0,ref},rest,{tabIndex:"-1",type:"text",plain:!0,readOnly:!0}))}),MessageContext=__webpack_require__("../../node_modules/grommet/es6/contexts/MessageContext/MessageContext.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types);function propTypes_extends(){return propTypes_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},propTypes_extends.apply(null,arguments)}propTypes_extends({},__webpack_require__("../../node_modules/grommet/es6/utils/general-prop-types.js").w3,{children:prop_types_default().func,disabled:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().arrayOf(prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().object]))]),disabledKey:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),dropAlign:prop_types_default().shape({top:prop_types_default().oneOf(["top","bottom"]),bottom:prop_types_default().oneOf(["top","bottom"]),right:prop_types_default().oneOf(["left","right"]),left:prop_types_default().oneOf(["left","right"])}),dropHeight:prop_types_default().oneOfType([prop_types_default().oneOf(["xsmall","small","medium","large","xlarge"]),prop_types_default().string]),dropTarget:prop_types_default().object,dropProps:prop_types_default().object,emptySearchMessage:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().node]),focusIndicator:prop_types_default().bool,icon:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().func,prop_types_default().node,prop_types_default().elementType]),labelKey:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),messages:prop_types_default().shape({multiple:prop_types_default().string}),name:prop_types_default().string,onChange:prop_types_default().func,onClose:prop_types_default().func,onOpen:prop_types_default().func,onSearch:prop_types_default().func,onMore:prop_types_default().func,options:prop_types_default().arrayOf(prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number,prop_types_default().bool,prop_types_default().element,prop_types_default().object])).isRequired,open:prop_types_default().bool,placeholder:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().element,prop_types_default().node]),plain:prop_types_default().bool,replace:prop_types_default().bool,searchPlaceholder:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().element,prop_types_default().node]),size:prop_types_default().oneOfType([prop_types_default().oneOf(["small","medium","large","xlarge"]),prop_types_default().string]),valueLabel:prop_types_default().oneOfType([prop_types_default().node,prop_types_default().func]),valueKey:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func,prop_types_default().shape({key:prop_types_default().string,reduce:prop_types_default().bool})])});var SelectPropTypes={},Select_excluded=["a11yTitle","aria-label","alignSelf","children","clear","closeOnChange","defaultValue","disabled","disabledKey","dropAlign","dropHeight","dropProps","dropTarget","emptySearchMessage","focusIndicator","gridArea","id","icon","labelKey","margin","messages","multiple","name","onBlur","onChange","onClick","onClose","onFocus","onKeyDown","onMore","onOpen","onSearch","open","options","placeholder","plain","replace","searchPlaceholder","selected","size","value","valueKey","valueLabel"];function Select_extends(){return Select_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Select_extends.apply(null,arguments)}var defaultDropAlign={top:"bottom",left:"left"},Select=(0,react.forwardRef)(function(_ref,ref){var a11yTitle=_ref.a11yTitle,ariaLabel=_ref["aria-label"],alignSelf=_ref.alignSelf,children=_ref.children,_ref$clear=_ref.clear,clear=void 0!==_ref$clear&&_ref$clear,_ref$closeOnChange=_ref.closeOnChange,closeOnChange=void 0===_ref$closeOnChange||_ref$closeOnChange,defaultValue=_ref.defaultValue,disabled=_ref.disabled,disabledKey=_ref.disabledKey,_ref$dropAlign=_ref.dropAlign,dropAlign=void 0===_ref$dropAlign?defaultDropAlign:_ref$dropAlign,dropHeight=_ref.dropHeight,dropProps=_ref.dropProps,dropTarget=_ref.dropTarget,emptySearchMessage=_ref.emptySearchMessage,focusIndicator=_ref.focusIndicator,gridArea=_ref.gridArea,id=_ref.id,icon=_ref.icon,labelKeyProp=_ref.labelKey,margin=_ref.margin,messages=_ref.messages,multiple=_ref.multiple,name=_ref.name,onBlur=_ref.onBlur,onChange=_ref.onChange,onClick=_ref.onClick,onClose=_ref.onClose,onFocus=_ref.onFocus,onKeyDown=_ref.onKeyDown,onMore=_ref.onMore,onOpen=_ref.onOpen,onSearch=_ref.onSearch,propOpen=_ref.open,optionsProp=_ref.options,placeholder=_ref.placeholder,plain=_ref.plain,replace=_ref.replace,searchPlaceholder=_ref.searchPlaceholder,selected=_ref.selected,size=_ref.size,valueProp=_ref.value,valueKeyProp=_ref.valueKey,valueLabel=_ref.valueLabel,rest=function Select_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(_ref,Select_excluded),theme=(0,useThemeValue.i)().theme,inputRef=(0,react.useRef)(),formContext=(0,react.useContext)(FormContext.c),format=(0,react.useContext)(MessageContext.N).format,valueKey=valueKeyProp||labelKeyProp,labelKey=labelKeyProp||valueKeyProp,usingKeyboard=(0,use_keyboard.d)(),_formContext$useFormI=formContext.useFormInput({name,value:valueProp,initialValue:defaultValue||""}),value=_formContext$useFormI[0],setValue=_formContext$useFormI[1],normalizedValue=(0,react.useMemo)(function(){return function getNormalizedValue(value,valueKey){return Array.isArray(value)?value.map(function(v){return valueKey&&valueKey.reduce?v:_applyKey(v,valueKey)}):valueKey&&valueKey.reduce?value:_applyKey(value,valueKey)}(value,valueKey)},[value,valueKey]),_useState=(0,react.useState)(),search=_useState[0],setSearch=_useState[1],_useState2=(0,react.useState)(optionsProp),allOptions=_useState2[0],setAllOptions=_useState2[1];(0,react.useEffect)(function(){search||setAllOptions(optionsProp)},[optionsProp,search]);var optionIndexesInValue=(0,react.useMemo)(function(){var result=[];if(void 0!==selected)if(Array.isArray(selected)){var validSelections=selected.filter(function(i){return i in allOptions});result.push.apply(result,validSelections)}else selected in allOptions&&result.push(selected);else if(Array.isArray(normalizedValue))normalizedValue.forEach(function(v){var index=allOptions.map(function(option){return _applyKey(option,valueKey)}).indexOf(v);-1!==index&&result.push(index)});else{var index=allOptions.map(function(option){return _applyKey(option,valueKey)}).indexOf(normalizedValue);-1!==index&&result.push(index)}return result},[allOptions,selected,valueKey,normalizedValue]),_useState3=(0,react.useState)(propOpen),open=_useState3[0],setOpen=_useState3[1];(0,react.useEffect)(function(){return setOpen(propOpen)},[propOpen]);var onRequestOpen=(0,react.useCallback)(function(){open||(setOpen(!0),onOpen&&onOpen())},[onOpen,open]),onRequestClose=(0,react.useCallback)(function(){setOpen(!1),onClose&&onClose(),setSearch()},[onClose]),triggerChangeEvent=(0,react.useCallback)(function(nextValue){return function changeEvent(inputRef,nextValue){Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set.call(inputRef.current,nextValue);var event=new Event("input",{bubbles:!0});inputRef.current.dispatchEvent(event)}(inputRef,nextValue)},[]),onSelectChange=(0,react.useCallback)(function(event,_ref2){var adjustedEvent,option=_ref2.option,nextValue=_ref2.value,nextSelected=_ref2.selected;(closeOnChange&&onRequestClose(),("object"!=typeof nextValue||multiple)&&nextValue!==event.target.value&&inputRef.current&&triggerChangeEvent(nextValue),setValue(nextValue),onChange)&&(event.persist(),event instanceof Event?(adjustedEvent=new event.constructor(event.type,event),Object.defineProperties(adjustedEvent,{target:{value:inputRef.current},value:{value:nextValue},option:{value:option},selected:{value:nextSelected}})):((adjustedEvent=event).target=inputRef.current,adjustedEvent.value=nextValue,adjustedEvent.option=option,adjustedEvent.selected=nextSelected),onChange(adjustedEvent))},[closeOnChange,multiple,onChange,onRequestClose,setValue,triggerChangeEvent]),SelectIcon=function getSelectIcon(icon,theme,open){var SelectIcon;switch(icon){case!1:break;case!0:case void 0:SelectIcon=open&&theme.select.icons.up?theme.select.icons.up:theme.select.icons.down;break;default:SelectIcon=icon}return SelectIcon}(icon,theme,open),selectValue=(0,react.useMemo)(function(){if(valueLabel instanceof Function){if(value||0===value||!1===value)return valueLabel(value)}else{if(valueLabel)return valueLabel;if(react.isValidElement(value))return value}},[value,valueLabel]),displayLabelKey=(0,react.useMemo)(function(){return function getDisplayLabelKey(labelKey,allOptions,optionIndexesInValue,selectValue){var optionLabelKey=_applyKey(allOptions[optionIndexesInValue[0]],labelKey);if(!selectValue&&1===optionIndexesInValue.length&&"object"==typeof optionLabelKey)return optionLabelKey}(labelKey,allOptions,optionIndexesInValue,selectValue)},[labelKey,allOptions,optionIndexesInValue,selectValue]),inputValue=(0,react.useMemo)(function(){if(!selectValue)return 0===optionIndexesInValue.length?"":1===optionIndexesInValue.length?_applyKey(allOptions[optionIndexesInValue[0]],labelKey):format({id:"select.multiple",messages})},[labelKey,messages,format,optionIndexesInValue,allOptions,selectValue]),iconColor=function getIconColor(theme){return(0,colors.$2)(theme.select.icons.color||"control",theme)}(theme);return react.createElement(Keyboard.s,{onDown:onRequestOpen,onUp:onRequestOpen},react.createElement(StyledSelectDropButton,{ref,a11yTitle:""+(ariaLabel||a11yTitle||placeholder||"Open Drop")+(value?format({id:"select.selected",messages,values:{currentSelectedValue:_formatValueForA11y(value,labelKey)}}):""),"aria-expanded":Boolean(open),"aria-haspopup":"listbox",id,disabled:!0===disabled||void 0,dropAlign,dropTarget,open,alignSelf,focusIndicator:!plain||focusIndicator,onFocus,onBlur,gridArea,margin,onOpen:onRequestOpen,onClose:onRequestClose,onClick,dropContent:react.createElement(SelectContainer,{clear,disabled,disabledKey,dropHeight,emptySearchMessage,id,labelKey,multiple,name,onChange:onSelectChange,onKeyDown,onMore,onSearch,options:optionsProp,allOptions,optionIndexesInValue,replace,searchPlaceholder,search,setSearch,selected,usingKeyboard,value,valueKey},children),plainSelect:plain,plain:!0,dropProps,theme},react.createElement(Box.a,{align:"center",direction:"row",justify:"between",background:theme.select.background},react.createElement(Box.a,{direction:"row",flex:!0,basis:"auto"},selectValue||displayLabelKey?react.createElement(react.Fragment,null,selectValue||displayLabelKey,react.createElement(HiddenInput,{type:"text",name,id:id?id+"__input":void 0,inert:inertTrueValue,value:inputValue,ref:inputRef,readOnly:!0})):react.createElement(DefaultSelectTextInput,Select_extends({a11yTitle:(ariaLabel||a11yTitle)&&(ariaLabel||a11yTitle)+(value&&"string"==typeof value?", "+value:""),disabled,id,inert:inertTrueValue,name,ref:inputRef,placeholder,value:inputValue,size,theme},rest))),SelectIcon&&react.createElement(Box.a,{margin:theme.select.icons.margin,flex:!1,style:{minWidth:"auto"}},(0,react.isValidElement)(SelectIcon)?SelectIcon:react.createElement(SelectIcon,{color:iconColor,size})))))});Select.displayName="Select",Select.propTypes=SelectPropTypes}}]);