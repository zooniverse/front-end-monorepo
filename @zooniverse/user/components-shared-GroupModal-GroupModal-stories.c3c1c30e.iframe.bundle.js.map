{"version":3,"file":"components-shared-GroupModal-GroupModal-stories.c3c1c30e.iframe.bundle.js","mappings":";;;;AAaA;;ACCA","sources":["webpack://@zooniverse/user/./src/components/GroupStats/components/MembersList/components/MemberListItem.jsx","webpack://@zooniverse/user/./src/components/shared/GroupForm/GroupForm.jsx"],"sourcesContent":["import { SpacedText } from '@zooniverse/react-components'\nimport { Box, Grid, Menu } from 'grommet'\nimport { More, UserAdmin } from 'grommet-icons'\nimport { bool, func, shape, string } from 'prop-types'\nimport styled from 'styled-components'\nimport { useTranslation } from '@translations/i18n'\n\nconst StyledMenu = styled(Menu)`\n  div {\n    padding: 0;\n  }\n`\n\nconst DEFAULT_HANDLER = () => true\n\nconst ROLES = {\n  ADMIN: 'group_admin',\n  MEMBER: 'group_member'\n}\n\nfunction MemberListItem({\n  disabled = false,\n  handleDelete = DEFAULT_HANDLER,\n  handleUpdate = DEFAULT_HANDLER,\n  membershipId,\n  role,\n  user\n}) {\n  const { t } = useTranslation()\n  const createItem = (label, roles) => ({\n    disabled,\n    label,\n    onClick: () => handleUpdate({\n      membershipId,\n      data: { roles }\n    })\n  })\n\n  const items = role === ROLES.ADMIN\n    ? [createItem(t('GroupStats.MemberListItem.removeAdmin'), [ROLES.MEMBER])]\n    : [createItem(t('GroupStats.MemberListItem.giveAdmin'), [ROLES.ADMIN])]\n\n  items.push({\n    disabled,\n    label: t('GroupStats.MemberListItem.remove'),\n    onClick: () => handleDelete({ membershipId })\n  })\n\n  return (\n    <Box\n      align='center'\n      as='li'\n      direction='row'\n      fill='horizontal'\n      height={{ min: '32px' }}\n      justify='between'\n      margin='none'\n      pad='none'\n    >\n      <Grid\n        align='center'\n        columns={['1.5em', 'small', 'auto']}\n        gap='small'\n        justify='start'\n        justifyContent='start'\n      >\n        {role === 'group_admin' ? <UserAdmin size='small' /> : <span>{' '}</span>}\n        <SpacedText\n          color={{ dark: 'neutral-6', light: 'neutral-7' }}\n          uppercase={false}\n        >\n          {user.display_name}\n        </SpacedText>\n        <SpacedText\n          color='light-5'\n          uppercase={false}\n        >\n          @{user.login}\n        </SpacedText>\n      </Grid>\n      <StyledMenu\n        a11yTitle={t('GroupStats.MemberListItem.a11y', { name: user.display_name })}\n        icon={<More />}\n        items={items}\n        margin='xsmall'\n      />\n    </Box>\n  )\n}\n\nMemberListItem.propTypes = {\n  disabled: bool,\n  handleDelete: func,\n  handleUpdate: func,\n  membershipId: string.isRequired,\n  role: string.isRequired,\n  user: shape({\n    display_name: string.isRequired,\n    login: string.isRequired\n  }).isRequired\n}\n\nexport default MemberListItem\n","import { Box, Button, Form, FormField, RadioButtonGroup, Select, TextInput, ThemeContext } from 'grommet'\nimport { func, node, shape, string } from 'prop-types'\nimport { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport { useTranslation } from '@translations/i18n'\n\nimport FieldLabel from './components/FieldLabel'\nimport RadioInputLabel from './components/RadioInputLabel'\nimport formTheme from './theme.js'\n\nconst StyledButton = styled(Button)`\n  border-radius: 4px;\n`\n\nconst DEFAULT_HANDLER = () => true\n\nconst DEFAULT_VALUE = {\n  display_name: '',\n  visibility: 'Private',\n  stats_visibility: 'private_agg_only'\n}\n\nfunction GroupForm({\n  children,\n  defaultValue = DEFAULT_VALUE,\n  handleDelete = DEFAULT_HANDLER,\n  handleSubmit = DEFAULT_HANDLER\n}) {\n  const { t } = useTranslation()\n\n  const PRIVATE_STATS_VISIBILITY = [\n    {\n      label: t('GroupForm.privateAggOnly'),\n      value: 'private_agg_only',\n    },\n    {\n      label: t('GroupForm.privateShowAggAndInd'),\n      value: 'private_show_agg_and_ind',\n    }\n  ]\n\n  const PUBLIC_STATS_VISIBILITY = [\n    {\n      label: t('GroupForm.publicAggOnly'),\n      value: 'public_agg_only',\n    },\n    {\n      label: t('GroupForm.publicAggShowInd'),\n      value: 'public_agg_show_ind_if_member',\n    },\n    {\n      label: t('GroupForm.publicShowAll'),\n      value: 'public_show_all',\n    }\n  ]\n\n  const [value, setValue] = useState(defaultValue)\n  const statsVisibilityOptions = value.visibility === 'Private' ? PRIVATE_STATS_VISIBILITY : PUBLIC_STATS_VISIBILITY\n  const selectedVisibilityOption = statsVisibilityOptions.find((option) => option.value === value.stats_visibility)\n\n  useEffect(() => {\n    setValue(defaultValue)\n  }, [defaultValue])\n\n  return (\n    <Form\n      onChange={(nextValue, { touched }) => {\n        const selectedVisibilityOption = statsVisibilityOptions.find((option) => option.label === nextValue.stats_visibility)\n        let stats_visibility = selectedVisibilityOption ? selectedVisibilityOption.value : value.stats_visibility\n        if (nextValue.visibility !== value.visibility) {\n          stats_visibility = nextValue.visibility === 'Private' ? 'private_agg_only' : 'public_agg_only'\n        }\n        setValue({ ...nextValue, stats_visibility })\n      }}\n      onSubmit={handleSubmit}\n      value={value}\n    >\n      <ThemeContext.Extend value={{\n        formField: {\n          ...formTheme.formField,\n          border: {\n            color: 'light-5',\n            side: 'all'\n          }\n        }\n      }}>\n        <FormField\n          label={<FieldLabel>{t('GroupForm.name')}</FieldLabel>}\n          help={defaultValue?.id ? null : t('GroupForm.nameHelp')}\n          htmlFor='display_name'\n          name='display_name'\n          required\n          validate={[\n            (name) => {\n              if (name && name.length < 4) return t('GroupForm.greaterThanChar')\n              if (name && name.length > 60) return t('GroupForm.lessThanChar')\n              return undefined\n            }\n          ]}\n          validateOn='blur'\n        >\n          <TextInput\n            id='display_name'\n            name='display_name'\n          />\n        </FormField>\n      </ThemeContext.Extend>\n      <ThemeContext.Extend value={formTheme}>\n        <FormField\n          label={<FieldLabel>{t('GroupForm.pubVis')}</FieldLabel>}\n          htmlFor='visibility'\n          name='visibility'\n        >\n          <RadioButtonGroup\n            name='visibility'\n            options={[\n              {\n                label: <>\n                  <RadioInputLabel color={{ dark: 'neutral-6', light: 'neutral-7' }} size='1rem'>{t('GroupForm.private')}</RadioInputLabel>\n                  <span style={{ whiteSpace: 'pre' }}>{' - '}</span>\n                  <RadioInputLabel>{t('GroupForm.onlyMembers')}</RadioInputLabel>\n                </>,\n                value: 'Private'\n              },\n              {\n                label: <>\n                  <RadioInputLabel color={{ dark: 'neutral-6', light: 'neutral-7' }} size='1rem'>{t('GroupForm.public')}</RadioInputLabel>\n                  <span style={{ whiteSpace: 'pre' }}>{' - '}</span>\n                  <RadioInputLabel>{t('GroupForm.anyone')}</RadioInputLabel>\n                </>,\n                value: 'Public'\n              }\n            ]}\n          />\n        </FormField>\n      </ThemeContext.Extend>\n      <ThemeContext.Extend value={{\n        formField: {\n          ...formTheme.formField,\n          border: {\n            color: 'light-5',\n            side: 'all'\n          }\n        }\n      }}>\n        <FormField\n          label={<FieldLabel>{t('GroupForm.showInd')}</FieldLabel>}\n          help={t('GroupForm.showIndHelp')}\n          htmlFor='stats_visibility'\n          info={defaultValue.id ? null : t('GroupForm.showIndInfo')}\n          name='stats_visibility'\n        >\n          <Select\n            id='stats_visibility'\n            aria-label={t('GroupForm.visibility')}\n            name='stats_visibility'\n            options={statsVisibilityOptions}\n            value={selectedVisibilityOption.label}\n            valueKey={{ key: 'label', reduce: true }}\n          />\n        </FormField>\n      </ThemeContext.Extend>\n        {children}\n      <Box\n        direction='row'\n        justify={defaultValue?.id ? 'between' : 'end'}\n      >\n        {defaultValue?.id ? (\n          <button\n            onClick={(event) => {\n              event.preventDefault()\n              if (window.confirm(t('GroupForm.deactivateHelp'))) {\n                handleDelete()\n              }\n            }}\n          >\n            {t('GroupForm.deactivate')}\n          </button>\n        ) : null}\n        <StyledButton\n          color={{ light: 'neutral-1', dark: 'accent-1' }}\n          label={defaultValue?.id ? t('GroupForm.saveChanges') : t('GroupForm.createNew')}\n          primary\n          type='submit'\n        />\n      </Box>\n    </Form>\n  )\n}\n\nGroupForm.propTypes = {\n  children: node,\n  handleDelete: func,\n  handleSubmit: func,\n  defaultValue: shape({\n    display_name: string,\n    stats_visibility: string\n  })\n}\n\nexport default GroupForm\n"],"names":[],"ignoreList":[],"sourceRoot":""}