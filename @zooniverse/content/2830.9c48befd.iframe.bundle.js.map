{"version":3,"file":"2830.9c48befd.iframe.bundle.js","mappings":";;;AAaA","sources":["webpack://@zooniverse/content/./src/screens/Publications/components/Project/Project.jsx"],"sourcesContent":["import { Box, Heading } from 'grommet'\nimport { arrayOf, func, number, shape, string } from 'prop-types'\nimport { useEffect, useRef } from 'react'\nimport { Media, ZooniverseLogo } from '@zooniverse/react-components'\nimport styled from 'styled-components'\n\nimport Publication from '../Publication/Publication'\n\nconst StyledBox = styled(Box)`\n  border-radius: 5px;\n  overflow: hidden;\n`\n\nconst Placeholder = ({ title }) => {\n  return (\n    <Box\n      align='center'\n      justify='center'\n      background='brand'\n      height='100%'\n      width='100%'\n    >\n      <ZooniverseLogo size='50%' id={title} />\n    </Box>\n  )\n}\n\nconst DEFAULT_HANDLER = () => true\nconst DEFAULT_PUBLICATIONS = []\n\nfunction slugify(string) {\n  return string\n    // convert letters to lowercase\n    .toLowerCase()\n    // replace any spaces with Z\n    .replace(/\\s/g, 'Z')\n    // remove all punctuation and whitespace\n    .replace(/\\W/g, '')\n    // replace any Zs with a single dash\n    .replace(/Z+/g, '-')\n}\n\nconst intersectionOptions = {\n  rootMargin: '0px 0px -70% 0px', // observe visibility in the top 30% of the viewport\n}\n\nfunction Project({\n  avatarSrc = null,\n  id = null,\n  title = '',\n  publications = DEFAULT_PUBLICATIONS,\n  sectionIndex = 0,\n  setActiveSection = DEFAULT_HANDLER\n}) {\n  const slug = slugify(title)\n  const sectionRef = useRef()\n\n  useEffect(() => {\n    const intersectionObserver = new window.IntersectionObserver(entries => {\n      if (entries[0].intersectionRatio > 0) {\n        setActiveSection(sectionIndex)\n      }\n    }, intersectionOptions)\n\n    intersectionObserver.observe(sectionRef.current)\n\n    return () => {\n      intersectionObserver.disconnect()\n    }\n  }, [sectionRef.current])\n\n  return (\n    <Box\n      as='section'\n      key={id}\n      ref={sectionRef}\n      aria-labelledby={slug}\n    >\n      <Box\n        direction='row'\n        align='center'\n        alignContent='center'\n        gap='xsmall'\n        margin={{ bottom: 'xsmall' }}\n      >\n        <StyledBox height='50px' width='50px'>\n          {!avatarSrc && <Placeholder title={title} />}\n          {avatarSrc && (\n            <Media\n              width={50}\n              height={50}\n              src={avatarSrc}\n              placeholder={<Placeholder title={title} />}\n            />\n          )}\n        </StyledBox>\n        <Heading\n          id={slug}\n          tabIndex={-1}\n          color={{ light: 'black', dark: 'white' }}\n          level='3'\n          size='small'\n        >\n          {title} ({publications.length})\n        </Heading>\n      </Box>\n      {publications.map((publication, i) => (\n        <Publication\n          avatarSrc={avatarSrc}\n          key={`${publication.url}${i}`}\n          {...publication}\n        />\n      ))}\n    </Box>\n  )\n}\n\nProject.propTypes = {\n  avatarSrc: string,\n  projectId: string,\n  publications: arrayOf(\n    shape({\n      authors: string,\n      title: string,\n      url: string,\n      year: string\n    })\n  ),\n  sectionIndex: number,\n  setActiveSection: func,\n  title: string,\n}\n\nexport default Project\n"],"names":[],"ignoreList":[],"sourceRoot":""}