/*! For license information please see 2545.745fc439.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_zooniverse_classifier=self.webpackChunk_zooniverse_classifier||[]).push([[2545],{"../lib-async-states/src/async-states.js"(module){const asyncStates={};Object.defineProperty(asyncStates,"initialized",{value:"initialized",enumerable:!0}),Object.defineProperty(asyncStates,"loading",{value:"loading",enumerable:!0}),Object.defineProperty(asyncStates,"putting",{value:"putting",enumerable:!0}),Object.defineProperty(asyncStates,"posting",{value:"posting",enumerable:!0}),Object.defineProperty(asyncStates,"success",{value:"success",enumerable:!0}),Object.defineProperty(asyncStates,"error",{value:"error",enumerable:!0}),Object.defineProperty(asyncStates,"values",{value:Object.values(asyncStates)}),module.exports=asyncStates},"../lib-panoptes-js/src/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{j2:()=>src_auth,bB:()=>panoptes,Hv:()=>talkAPI});const isBrowser=new Function("try {return this===window;}catch(e){ return false;}");new Function("try {return this===global;}catch(e){return false;}");function buildResponse(httpMethod,resourceType,resources,linked,params){const response={links:{},meta:{}};return linked&&(response.linked=linked),"put"===httpMethod&&params?(response[resourceType]=[Object.assign({},resources[0],params)],response):(response[resourceType]=resources,response)}function raiseError(errorMessage,errorClass){const error={error:new Error(errorMessage),typeError:new TypeError(errorMessage)};return console&&console.error(error[errorClass]),Promise.reject(error[errorClass])}function isParamTypeInvalid(param,type){return!!param&&typeof param!==type}var process=__webpack_require__("../../node_modules/process/browser.js");const envFromBrowser=function locationMatch(regex){let match;return isBrowser()&&(match=location.search.match(regex)),match&&match[1]?match[1]:void 0}(/\W?env=(\w+)/),envFromShell=process.env.PANOPTES_ENV||"production",env=envFromBrowser||envFromShell||"staging";if(!env.match(/^(production|staging|development|test)$/))throw new Error(`Error: Invalid Environment - ${envFromShell}`);const baseConfig={test:{host:"https://panoptes-staging.zooniverse.org/api",oauth:"https://panoptes-staging.zooniverse.org",talkHost:"https://talk-staging.zooniverse.org"},development:{host:"https://panoptes-staging.zooniverse.org/api",oauth:"https://panoptes-staging.zooniverse.org",talkHost:"https://talk-staging.zooniverse.org"},staging:{host:"https://panoptes-staging.zooniverse.org/api",oauth:"https://panoptes-staging.zooniverse.org",talkHost:"https://talk-staging.zooniverse.org"},production:{host:"https://www.zooniverse.org/api",oauth:"https://panoptes.zooniverse.org",talkHost:"https://talk.zooniverse.org"}},config=baseConfig[env];var key_import=__webpack_require__("../../node_modules/jose/dist/browser/key/import.js"),verify=__webpack_require__("../../node_modules/jose/dist/browser/jwt/verify.js");async function auth_verify(token){let data=null,error=null;try{const pemKey="production"===env?"-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAvbmZ42QexoMJ1J9z47Y2\n7q5qvtE1mblpOnN7g4ItumcnoCv8xfdbhnzkHj/YBtqVoHhAVNwxSJKyQ4tZBehg\nyYMRzLzBeWO8vG8V/NqM/tmUXca3rvPqt8I7zMoesSggawwz3/Gsa6KFC0OLjDh+\nvE1HlqNX6usKiGmt6fv3KVU9cjtfREIieXgr36nkJDtIVJ2/hX1LY/v0+AEjZaFj\nIzXSihNkjPnq2ymdm0YtV0Mmy1sK4qBY8c/zCWQ9lisILu+/Ix2YwVlDXeV9CErE\n31b2jkPUVfLbCyeGPEIbYJw2pSiFWkuDR2VZaq+qeUbAwDfeu1OwueMZMt54vSYF\nAKOxqMJtkrf8hxLSBZepk9sTS20T7gaEUyBhyeycarQqY34+VwG6UqLSy2H/Mq7r\n5J8x7fnZPAtkFizcu/YDsELmD7Rw8SQ389NzApLi1jx8eSTZT+nqetU4FPs4CGCd\nA/XMj2kAz/IA7LbV4hhbx1tTwTo88Xzk9knTknFv1/sE/j+KeUTeA9dE7EniIgOg\nV01zobEXAP5Eyf3+OwYv+Qvq3cV2BvRZfEBhzj1RezVEh187hfCtCaSVf3YrEeL2\nMM74OPotMaVyaJFxj/GxhrahOgSv4TbMYk93d+vcIa0clO7wXrJJXoWwi3XpQvk7\nSwgqmRqSTqDuxJqlJAuVhmMCAwEAAQ==\n-----END PUBLIC KEY-----":"-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEArqLiWfs+Nm3BBMu9bcma\nJaFhfSpKoHwsFjzRzkdFO0uKXPkS5nJq3UD/ZORr31XKYmwlbhGBzvpBUSoTmsjj\nAXXP9cOlX/opoojuII2JXoUPjZH+YDl4y4M7YzXLyVKYW0FYR2pBXyhtEL9Lx0Ny\nNw2DW6p7Z9RwoU46WkapjMWor2wAlpnUM4ngDM/7ysEg8oi9KExrXlI4MCH1sVqj\nU++8zkIXarqyDnyVk94ZoGA8EEqjeK3s3HonGG/DZyoj7OMcRa81fm94Sage5PWd\nsJfgUw8bcj3/h/boRIJSMwRv1IJVQxz2o44es6dN+12q3hpXBhCfVZWz3MgoJFpt\nt3e+KHB3UDBEIo55aPgbUAeuWV1IrBqZIQWLZcce4pzgS+A+0JgeetwbzubjHfZu\n8FQ/d+29M8N+R+TOS2WzVXCKzEZtw1BZ8V595X1Rf9FcklnA6CH32LybQD4/4ALz\nJGx2WaCa2246pgJzT7fIo/L/bgRuEsBfwMR+wcOVr7yroFrndEyw1eGv2RuFsLNH\nJwOjF+MTg/wtvaI8AXSTCSeKfoljUndNsiPTO8gJmiAq4yWFiMP1fKm/uczN6PKy\nrYdQDSMt3a8UXZbw+9DocHDD0VvDHg6zuaa75tZrb7WvGrO7kbhUrJYwNCAbD2kN\nCa6VZnNmmy57yB/+jhBSNkECAwEAAQ==\n-----END PUBLIC KEY-----",publicKey=await(0,key_import.jU)(pemKey,"RS512"),{payload}=await(0,verify.V)(token.replace("Bearer ",""),publicKey);data=payload.data}catch(e){error=e}return{data,error}}const auth={verify:auth_verify,decodeJWT:async function decodeJWT(token){let user=null;const{data,error}=await auth_verify(token);return data&&(user={id:data.id.toString(),login:data.login,display_name:data.dname,admin:data.admin}),{user,error}}},src_auth=auth;var client=__webpack_require__("../../node_modules/superagent/lib/client.js"),client_default=__webpack_require__.n(client);function handleMissingParameter(message){return Promise.reject(new Error(message))}function checkForAdminFlag(){if("undefined"!=typeof localStorage&&null!==localStorage)return!!localStorage.getItem("adminFlag")||void 0}function determineHost(query,host){return host||(query&&query.env?baseConfig[query.env].host:config.host)}function parseHeaders(headers={}){let httpHeaders={};return Object.entries(headers).forEach(([key,value])=>{let header=key;"authorization"===key&&(header="Authorization"),"etag"===key&&(header="If-Match"),httpHeaders[header]=value}),httpHeaders}function getQueryParams(query){const defaultParams={admin:checkForAdminFlag(),http_cache:!0};if(query&&Object.keys(query).length>0){query&&query.env&&delete query.env;return Object.assign({},query,defaultParams)}return defaultParams}const requests={get:function panoptes_get(endpoint,query={},headers={},host){if(!endpoint)return handleMissingParameter("Request needs a defined resource endpoint");if("object"!=typeof query)return Promise.reject(new TypeError("Query must be an object"));const apiHost=determineHost(query,host),request=client_default().get(`${apiHost}${endpoint}`).set("Content-Type","application/json").set("Accept","application/vnd.api+json; version=1");headers&&request.set(parseHeaders(headers));const queryParams=getQueryParams(query);return request.query(queryParams).then(response=>response)},put:function put(endpoint,data,headers={},query={},host){if(!endpoint)return handleMissingParameter("Request needs a defined resource endpoint");if(!data)return handleMissingParameter("Request needs a defined data for update");if("object"!=typeof query)return Promise.reject(new TypeError("Query must be an object"));const apiHost=determineHost(query,host),request=client_default().put(`${apiHost}${endpoint}`).set("Content-Type","application/json").set("Accept","application/vnd.api+json; version=1");headers&&request.set(parseHeaders(headers));const queryParams=getQueryParams(query);return request.query(queryParams).send(data).then(response=>response)},post:function post(endpoint,data,headers={},query={},host){if(!endpoint)return handleMissingParameter("Request needs a defined resource endpoint");if("object"!=typeof query)return Promise.reject(new TypeError("Query must be an object"));const apiHost=determineHost(query,host),request=client_default().post(`${apiHost}${endpoint}`).set("Content-Type","application/json").set("Accept","application/vnd.api+json; version=1");headers&&request.set(parseHeaders(headers));const queryParams=getQueryParams(query);return request.query(queryParams).send(data).then(response=>response)},del:function del(endpoint,query={},headers={},host){if(!endpoint)return handleMissingParameter("Request needs a defined resource endpoint");if("object"!=typeof query)return Promise.reject(new TypeError("Query must be an object"));const apiHost=determineHost(query,host),request=client_default().delete(`${apiHost}${endpoint}`).set("Content-Type","application/json").set("Accept","application/vnd.api+json; version=1");headers&&request.set(parseHeaders(headers));const queryParams=getQueryParams(query);return request.query(queryParams).then(response=>response)}},panoptes=requests;function talkAPI_determineHost(query,host){return host||(query?.env?baseConfig[query.env].talkHost:config.talkHost)}const talkAPI_requests={get:function talkAPI_get(endpoint,query={},headers={},host){const talkHost=talkAPI_determineHost(query,host);return panoptes.get(endpoint,query,headers,talkHost)},put:function talkAPI_put(endpoint,data,headers={},query={},host){const talkHost=talkAPI_determineHost(query,host);return panoptes.put(endpoint,data,headers,query,talkHost)},post:function talkAPI_post(endpoint,data,headers={},query={},host){const talkHost=talkAPI_determineHost(query,host);return panoptes.post(endpoint,data,headers,query,talkHost)},del:function talkAPI_del(endpoint,query={},headers={},host){const talkHost=talkAPI_determineHost(query,host);return panoptes.del(endpoint,query,headers,talkHost)}},talkAPI=talkAPI_requests;const collection={created_at:"2015-03-17T13:45:40.297Z",description:"",display_name:"test collection",external_id:null,favorite:!1,href:"/collections/1",id:"1",links:{projects:["1"],subjects:["1"]},private:!0,updated_at:"2015-03-17T13:45:40.297Z"},resources={collection,collections:[collection,Object.assign({},collection,{id:"2"})]},medium=(buildResponse("get","collections",[resources.collection],{}),buildResponse("get","collections",resources.collections,{}),{content_type:"image/jpeg",created_at:"2016-12-07T23:11:47.452Z",external_link:!1,links:{},metadata:null,updated_at:"2016-12-07T23:11:47.452Z"}),mediaResourceTypes={attached_images:"attached_images",avatar:"avatar",background:"background"},resourcesThatCanHaveMedia={field_guide:"field_guide",organization:"organization",project:"project",tutorial:"tutorial",user:"user"};const resources_media={mocks:{buildMockedMediumResource:function buildMockedMediumResource(resourceType,linkResourceType){const resource=mediaResourceTypes[resourceType],linkedResource=resourcesThatCanHaveMedia[linkResourceType],randomID=function getRandomID(min,max){return(Math.floor(Math.random()*(max-min+1))+min).toString()}(0,100),mediaType=`${linkedResource}_${resource}`;return Object.assign({},medium,{href:`/${linkedResource}s/${randomID}/${resource}`,id:randomID,media_type:mediaType,src:`https://panoptes-uploads.zooniverse.org/production/${mediaType}/random-string-example.jpeg`})}}};function getProjectSlugFromURL(urlArg){let parsed;if(urlArg.startsWith("http"))parsed=new URL(urlArg);else{const path=urlArg.startsWith("/")?urlArg:`/${urlArg}`;parsed=new URL(`https://www.zooniverse.org${path}`)}const[projectPath,owner,project]=parsed.pathname.split("/").filter(Boolean);if("projects"===projectPath&&owner&&project)return`${owner}/${project}`;throw new Error(`Couldn't match a slug from ${urlArg}`)}const resources_users={mocks:{resources:{user:{avatar_src:"",created_at:"2015-03-11T13:44:51.000Z",credited_name:"zooniverse",display_name:"zooniverse",href:"/users/1",id:"1",links:{},login:"zooniverse",private_profile:!0,type:"users",updated_at:"2018-06-11T19:16:48.316Z",valid_email:!0}}}},{buildMockedMediumResource:mocks_buildMockedMediumResource}=resources_media.mocks,projectPages={team:{content:"",created_at:"2016-12-08T20:34:38.300Z",href:"/projects/2/pages/1",id:"1",language:"en",links:{project:"1"},title:"Team",type:"project_pages",updated_at:"2018-05-17T19:09:11.209Z",url_key:"team"},results:{content:"",created_at:"2016-12-08T20:34:47.085Z",href:"/projects/2/pages/2",id:"2",language:"en",links:{project:"2"},title:"Results",type:"project_pages",updated_at:"2018-05-17T19:16:57.618Z",url_key:"results"}},projects_mocks_resources={projectAvatar:mocks_buildMockedMediumResource("avatar","project"),projectBackground:mocks_buildMockedMediumResource("background","project"),projectOne:{activity:0,available_languages:["en"],beta_approved:!1,beta_requested:!1,classifications_count:0,classifiers_count:0,completeness:0,configuration:{},created_at:"2018-05-10T16:53:33.328Z",description:"A short description of the project",display_name:"Untitled project",experimental_tools:[],featured:!1,href:"/projects/1",id:"1",introduction:"A more in-depth introduction to your science...",launch_approved:!1,launch_date:null,launch_requested:!1,links:{},live:!1,migrated:!1,mobile_friendly:!1,primary_language:"en",private:!0,redirect:"",researcher_quote:"",retired_subjects_count:0,slug:"user/untitled-project",state:"development",subjects_count:0,tags:[],title:"Untitled project",updated_at:"2018-05-10T16:53:33.328Z",urls:[],workflow_description:""},projectTwo:{activity:1e5,available_languages:["en"],beta_approved:!0,beta_requested:!0,classifications_count:1e4,classifiers_count:100,completeness:.5,configuration:{},created_at:"2018-05-11T16:53:33.328Z",description:"A short description of the project",display_name:"Untitled project 2",experimental_tools:[],featured:!1,href:"/projects/2",id:"2",introduction:"A more in-depth introduction to your science...",launch_approved:!0,launch_date:"2018-05-11T16:53:33.328Z",launch_requested:!0,links:{},live:!0,migrated:!1,mobile_friendly:!1,primary_language:"en",private:!1,redirect:"",researcher_quote:"",retired_subjects_count:10,slug:"user/untitled-project-2",state:"development",subjects_count:1e6,tags:[],title:"Untitled project 2",updated_at:"2018-05-10T16:53:33.328Z",urls:[],workflow_description:""},projectPages,projectRoles:{owner:{href:"/project_roles/1",id:"1",links:{project:"2",owner:{}},roles:["owner"]},multipleRoles:{href:"/project_roles/2",id:"2",links:{project:"2",owner:{}},roles:["expert","scientist"]}}},createdProject=buildResponse("post","projects",[projects_mocks_resources.projectOne],{}),projects=buildResponse("get","projects",[projects_mocks_resources.projectOne,projects_mocks_resources.projectTwo],{}),project=buildResponse("get","projects",[projects_mocks_resources.projectTwo],{}),updatedProject=buildResponse("put","projects",[projects_mocks_resources.projectTwo],{},{researcher_quote:"Try my project!"});buildResponse("get","projects",[]),buildResponse("get","project_roles",[projects_mocks_resources.projectRoles.owner]),buildResponse("get","project_roles",[projects_mocks_resources.projectRoles.owner,projects_mocks_resources.projectRoles.multipleRoles]),buildResponse("get","project_pages",[projects_mocks_resources.projectPages.team,projects_mocks_resources,projectPages.results]),buildResponse("get","projects",[projects_mocks_resources.projectTwo],{avatars:[projects_mocks_resources.projectAvatar],backgrounds:[projects_mocks_resources.projectBackground],owners:resources_users.mocks.resources.user,project_pages:[projects_mocks_resources.projectPages]});function buildQueuedSubjectResource(){const randomId=function helpers_getRandomID(min,max){return(Math.floor(Math.random()*(max-min+1))+min).toString()}(1,100);return{already_seen:!1,created_at:"2018-01-23T15:22:55.810Z",favorite:!1,finished_workflow:!1,href:`/subjects/${randomId}`,id:`${randomId}`,locations:[{"image/jpeg":"https://static.zooniverse.org/fem-assets/subject-placeholder.jpg"}],metadata:{},retired:!1,selection_state:"normal",updated_at:"2018-01-23T15:22:55.810Z",user_has_finished_workflow:!1,zooniverse_id:null}}const subjectQueue=function buildSubjectQueue(){const subjectQueue=[];for(var i=0;i<10;i++){const subject=buildQueuedSubjectResource();subjectQueue.push(subject)}return subjectQueue}(),subjects_mocks_resources={subject:{created_at:"2015-03-17T13:45:40.297Z",external_id:null,href:"/subjects/1",id:"1",links:{project:"1"},locations:[{"image/png":"https://static.zooniverse.org/fem-assets/subject-placeholder.jpg"}],metadata:{},updated_at:"2015-03-17T13:45:40.297Z",zooniverse_id:null},subjectQueue};buildResponse("get","subjects",[subjects_mocks_resources.subject],{}),buildResponse("get","subjects",subjectQueue,{});function tutorials_rest_get(params){const queryParams=params&&params.query?params.query:{},tutorialId=params&&params.id?params.id:"",workflowId=params&&params.workflowId?params.workflowId:"",authorization=params&&params.authorization?params.authorization:"";return isParamTypeInvalid(tutorialId,"string")?raiseError("Tutorials: Get request id must be a string.","typeError"):isParamTypeInvalid(workflowId,"string")?raiseError("Tutorials: Get request workflow id must be a string.","typeError"):tutorialId?panoptes.get(`/tutorials/${tutorialId}`,queryParams,{authorization}):workflowId?(queryParams.workflow_id=workflowId,panoptes.get("/tutorials",queryParams,{authorization})):raiseError("Tutorials: Get request must include a workflow id or a tutorial id.","error")}const{buildMockedMediumResource:tutorials_mocks_buildMockedMediumResource}=resources_media.mocks,tutorials_mocks_resources={tutorialOne:{created_at:"2016-08-02T17:59:44.132Z",display_name:"Survey Task Tutorial",href:"/tutorials/1",id:"1",kind:"tutorial",language:"en",links:{workflow_id:"10"},steps:[{content:"Welcome to Animal Snapshots!",media:"1"}],updated_at:"2017-03-27T19:00:56.369Z"},tutorialTwo:{created_at:"2016-08-02T17:59:44.132Z",display_name:"Drawing Task Tutorial",href:"/tutorials/2",id:"2",kind:"tutorial",language:"en",links:{workflow_id:"10"},steps:[{content:"Welcome to Draw a Square!",media:"3"}],updated_at:"2017-03-27T19:00:56.369Z"},tutorialWithNullKind:{created_at:"2016-08-02T17:59:44.132Z",display_name:"Question Task Tutorial",href:"/tutorials/3",id:"3",kind:null,language:"en",links:{workflow_id:"10"},steps:[{content:"Welcome to my survey!",media:"8"}],updated_at:"2017-03-27T19:00:56.369Z"},minicourse:{created_at:"2016-06-01T20:08:07.898Z",display_name:"",href:"/tutorials/52",id:"52",kind:"mini-course",language:"en",links:{workflow_id:"10"},steps:[{content:"Here's a fun fact",media:"50"}],updated_at:"2017-03-27T18:34:24.488Z"},attachedImageOne:tutorials_mocks_buildMockedMediumResource("attached_images","tutorial"),attachedImageTwo:tutorials_mocks_buildMockedMediumResource("attached_image","tutorial")},tutorialResponse=buildResponse("get","tutorials",[tutorials_mocks_resources.tutorialOne],{}),tutorials=buildResponse("get","tutorials",[tutorials_mocks_resources.tutorialOne,tutorials_mocks_resources.tutorialTwo],{}),minicourseResponse=buildResponse("get","tutorials",[tutorials_mocks_resources.minicourse],{}),attachedImageResponse=buildResponse("get","media",[tutorials_mocks_resources.attachedImageOne]),tutorialWithImagesResponse=buildResponse("get","tutorials",[tutorials_mocks_resources.tutorialOne],{media:[tutorials_mocks_resources.attachedImageOne]}),tutorialsWithImagesResponse=buildResponse("get","tutorials",[tutorials_mocks_resources.tutorialOne,tutorials_mocks_resources.tutorialTwo],{media:[tutorials_mocks_resources.attachedImageOne,tutorials_mocks_resources.attachedImageTwo]});buildResponse("get","tutorials",[tutorials_mocks_resources.tutorialWithNullKind,tutorials_mocks_resources.tutorialOne,tutorials_mocks_resources.tutorialTwo,tutorials_mocks_resources.minicourse],{}),buildResponse("get","tutorials",[])},"../lib-react-components/dist/esm/Tooltip/Tooltip.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Tooltip_Tooltip});var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),tippy_react_headless_esm=__webpack_require__("../../node_modules/@tippyjs/react/headless/dist/tippy-react-headless.esm.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),SpacedText=__webpack_require__("../lib-react-components/dist/esm/SpacedText/SpacedText.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),SVG=styled_components_browser_esm.default.svg.withConfig({displayName:"Triangle__SVG",componentId:"sc-d5wcbh-0"})(["display:block;"," z-index:1;"],props=>(0,styled_components_browser_esm.css)(["fill:",";height:","px;transform:rotate(",");width:","px;"],props.fill,props.height,props.rotation,props.height)),defaultPad={horizontal:"small"};function Triangle(_ref){var fill,{color="",justify="center",pad=defaultPad,pointDirection="up",theme,width=20}=_ref,{colors}=theme.global;fill=color||(theme.dark?colors["neutral-6"]:colors["dark-2"]);return(0,jsx_runtime.jsx)(Box.a,{"aria-hidden":"true",direction:"row",justify,pad,children:(0,jsx_runtime.jsx)(SVG,{fill,rotation:{up:"0deg",down:"180deg",left:"-90deg",right:"90deg"}[pointDirection],viewBox:"0 0 10 10",width,children:(0,jsx_runtime.jsx)("polygon",{points:"5,0 10,10 0,10"})})})}Triangle.propTypes={color:(0,prop_types.oneOfType)([prop_types.object,prop_types.string]),justify:(0,prop_types.oneOf)(["start","center","end"]),pad:(0,prop_types.oneOfType)([prop_types.object,prop_types.string]),pointDirection:(0,prop_types.oneOf)(["down","left","right","up"]),theme:(0,prop_types.shape)({global:(0,prop_types.shape)({colors:(0,prop_types.shape)({"dark-2":prop_types.string,"neutral-6":prop_types.string})}),dark:prop_types.bool}),width:prop_types.number};const Triangle_Triangle=(0,styled_components_browser_esm.withTheme)(Triangle);var _excluded=["animation","arrow","className","label","theme"];function Label(_ref){var _theme$global,{animation="fadeIn",arrow=!0,className="",label,theme}=_ref,rest=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),family=(null==theme||null===(_theme$global=theme.global)||void 0===_theme$global||null===(_theme$global=_theme$global.font)||void 0===_theme$global?void 0:_theme$global.family)||"",placement=rest["data-placement"]||"top";return(0,jsx_runtime.jsxs)(Box.a,{animation,children:[arrow&&"bottom"===placement&&(0,jsx_runtime.jsx)(Triangle_Triangle,{color:"black",pointDirection:"up",width:10,height:10}),(0,jsx_runtime.jsx)(Box.a,{background:{color:"black",dark:!0},className,elevation:"medium",pad:{horizontal:"medium",vertical:"xsmall"},responsive:!1,children:(0,jsx_runtime.jsx)(_StyledSpacedText,{weight:"bold",$_css:family,children:label})}),arrow&&"top"===placement&&(0,jsx_runtime.jsx)(Triangle_Triangle,{color:"black",pointDirection:"down",width:10,height:10})]})}Label.propTypes={arrow:prop_types.bool,animation:(0,prop_types.oneOfType)([prop_types.string,prop_types.array,prop_types.object]),className:prop_types.string,"data-placement":(0,prop_types.oneOf)(["bottom","top"]),label:(0,prop_types.oneOfType)([prop_types.string,prop_types.node]).isRequired,theme:(0,prop_types.shape)({global:(0,prop_types.shape)({font:(0,prop_types.shape)({family:prop_types.string})})})};const Label_Label=(0,styled_components_browser_esm.withTheme)(Label);var _StyledSpacedText=(0,styled_components_browser_esm.default)(SpacedText.A).withConfig({displayName:"Label___StyledSpacedText",componentId:"sc-1szazzi-0"})(["font-family:",";"],p=>p.$_css),Tooltip_excluded=["arrow","animation","children","label","placement","trigger"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Tooltip(props){var{arrow=!0,animation={type:"fadeIn",duration:500},children,label,placement="top",trigger="mouseenter focus"}=props,rest=function Tooltip_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function Tooltip_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(props,Tooltip_excluded);return(0,jsx_runtime.jsx)(tippy_react_headless_esm.Ay,_objectSpread(_objectSpread({placement,render:attrs=>(0,jsx_runtime.jsx)(Label_Label,_objectSpread({arrow,animation,label},attrs)),trigger},rest),{},{children}))}Tooltip.propTypes={arrow:prop_types.bool,animation:(0,prop_types.oneOfType)([prop_types.array,prop_types.object,prop_types.string]),children:prop_types.node.isRequired,label:(0,prop_types.oneOfType)([prop_types.string,prop_types.node]).isRequired,placement:prop_types.string,trigger:prop_types.string};const Tooltip_Tooltip=Tooltip},"./src/components/Classifier/components/MetaTools/components/Metadata/components/MetadataModal/MetadataModal.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>MetadataModal});var _zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),_zooniverse_react_components_Modal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../lib-react-components/dist/esm/Modal/Modal.js"),_zooniverse_react_components_SpacedText__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../lib-react-components/dist/esm/SpacedText/SpacedText.js"),grommet__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/grommet/es6/components/DataTable/DataTable.js"),grommet__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),grommet__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/grommet/es6/components/Anchor/Anchor.js"),grommet__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),prop_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_7__),styled_components__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_filterByLabel__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/components/Classifier/components/MetaTools/components/Metadata/components/MetadataModal/filterByLabel.js"),_translations_i18n__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/translations/i18n.jsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledDataTable=(0,styled_components__WEBPACK_IMPORTED_MODULE_8__.default)(grommet__WEBPACK_IMPORTED_MODULE_3__.b).withConfig({displayName:"MetadataModal__StyledDataTable",componentId:"sc-1kv58t8-0"})(["height:auto;th > div{padding:0 20px;}td >  div{padding:0 20px;}"]),DatumWrapper=(0,styled_components__WEBPACK_IMPORTED_MODULE_8__.default)(grommet__WEBPACK_IMPORTED_MODULE_4__.E).withConfig({displayName:"MetadataModal__DatumWrapper",componentId:"sc-1kv58t8-1"})(["overflow-wrap:break-word;word-break:break-word;& > p{margin:0;}"]);function formatValue(value){var stringValue=null==value?void 0:value.toString();return null==stringValue||stringValue.trim(),null!=stringValue&&stringValue.startsWith("http")?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(grommet__WEBPACK_IMPORTED_MODULE_5__.M,{target:"_blank",rel:"nofollow noopener noreferrer",href:value,children:value}):stringValue?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__.Ay,{inline:!0,children:stringValue}):null===value?"null":""}function MetadataModal(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,_ref$closeFn=_ref.closeFn,closeFn=void 0===_ref$closeFn?function(){return!0}:_ref$closeFn,_ref$filters=_ref.filters,filters=void 0===_ref$filters?_filterByLabel__WEBPACK_IMPORTED_MODULE_9__.u:_ref$filters,metadata=_ref.metadata,_ref$prefixes=_ref.prefixes,prefixes=void 0===_ref$prefixes?_filterByLabel__WEBPACK_IMPORTED_MODULE_9__.u:_ref$prefixes,t=(0,_translations_i18n__WEBPACK_IMPORTED_MODULE_10__.Bd)("components").t,columns=[{header:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_zooniverse_react_components_SpacedText__WEBPACK_IMPORTED_MODULE_2__.A,{children:t("MetaTools.MetadataModal.table.label")}),primary:!0,property:"label"},{header:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_zooniverse_react_components_SpacedText__WEBPACK_IMPORTED_MODULE_2__.A,{children:t("MetaTools.MetadataModal.table.value")}),property:"value",render:function render(datum){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(DatumWrapper,{children:datum.value})}}],data=Object.keys(metadata).filter(function(label){return(0,_filterByLabel__WEBPACK_IMPORTED_MODULE_9__.A)(label,filters)}).map(function(label){var value=formatValue(metadata[label]);return{label:label.replace(RegExp("^(".concat(prefixes.join("|"),")")),""),value}});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_zooniverse_react_components_Modal__WEBPACK_IMPORTED_MODULE_1__.A,{active,closeFn,title:t("MetaTools.MetadataModal.title"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(grommet__WEBPACK_IMPORTED_MODULE_6__.a,{height:"medium",overflow:"auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(StyledDataTable,{pad:"15px",columns,data,sortable:!0})})})}MetadataModal.propTypes={active:prop_types__WEBPACK_IMPORTED_MODULE_7___default().bool,closeFn:prop_types__WEBPACK_IMPORTED_MODULE_7___default().func,filters:prop_types__WEBPACK_IMPORTED_MODULE_7___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_7___default().string),metadata:prop_types__WEBPACK_IMPORTED_MODULE_7___default().object.isRequired,prefixes:prop_types__WEBPACK_IMPORTED_MODULE_7___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_7___default().string)},formatValue.__docgenInfo={description:"",methods:[],displayName:"formatValue"},MetadataModal.__docgenInfo={description:"",methods:[],displayName:"MetadataModal",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},closeFn:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},filters:{defaultValue:{value:"['#', '!']",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},prefixes:{defaultValue:{value:"['#', '!']",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},metadata:{description:"",type:{name:"object"},required:!0}}}},"./src/components/Classifier/components/MetaTools/components/Metadata/components/MetadataModal/filterByLabel.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";function filterByLabel(label){var filters=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(label){var firstCharacter=label.trim().charAt(0);return filters.includes(firstCharacter)||"//"===label.slice(0,2)?"":label}return""}__webpack_require__.d(__webpack_exports__,{A:()=>filterByLabel,u:()=>filters});var filters=["#","!"]},"./src/components/Classifier/components/MetaTools/components/Metadata/components/MetadataModal/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Ko:()=>_filterByLabel__WEBPACK_IMPORTED_MODULE_0__.A,du:()=>_MetadataModal__WEBPACK_IMPORTED_MODULE_1__.A,uW:()=>_filterByLabel__WEBPACK_IMPORTED_MODULE_0__.u});var _filterByLabel__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/Classifier/components/MetaTools/components/Metadata/components/MetadataModal/filterByLabel.js"),_MetadataModal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/Classifier/components/MetaTools/components/Metadata/components/MetadataModal/MetadataModal.jsx")},"./src/helpers/createLocationCounts/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>createLocationCounts_createLocationCounts});var validateMimeType=__webpack_require__("./src/helpers/validateMimeType/index.js");const createLocationCounts_createLocationCounts=function createLocationCounts(_ref){var locations=_ref.locations,mimeTypes=locations.map(function(location){return Object.keys(location)[0]});try{var images=mimeTypes.filter(function(mimeType){return mimeType.startsWith("image")&&(0,validateMimeType.A)(mimeType)}).length,json=mimeTypes.filter(function(mimeType){return mimeType.startsWith("application")&&(0,validateMimeType.A)(mimeType)}).length,text=mimeTypes.filter(function(mimeType){return mimeType.startsWith("text")&&(0,validateMimeType.A)(mimeType)}).length;return{images,json,videos:mimeTypes.filter(function(mimeType){return mimeType.startsWith("video")&&(0,validateMimeType.A)(mimeType)}).length,text,total:locations.length}}catch(error){return console.log(error),{}}}},"./src/helpers/formatTimeStamp/formatTimeStamp.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function formatTimeStamp(played,duration){var timeStamp=duration?played*duration:played;if("number"!=typeof timeStamp||isNaN(timeStamp))return"NaN";if(timeStamp<1)return"0:00";var date=new Date(1e3*timeStamp),mm=date.getUTCMinutes(),ss=function padSeconds(string){return("0"+string).slice(-2)}(date.getUTCSeconds());return"".concat(mm,":").concat(ss)}},"./src/helpers/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{ss:()=>createLocationCounts.A,yj:()=>subjectViewers.A,VW:()=>subjectsSeenThisSession_subjectsSeenThisSession,lb:()=>withFeatureFlag,Lg:()=>withStores});var createLocationCounts=__webpack_require__("./src/helpers/createLocationCounts/index.js"),subjectsSeenThisSession=(__webpack_require__("./src/helpers/shownMarks.js"),{add:function add(workflowID){var subjectIDs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],storage=window?window.sessionStorage:null,seenThisSession=[];if(storage&&storage.getItem("subjectsSeenThisSession")){var alreadySeen=storage.getItem("subjectsSeenThisSession");seenThisSession=JSON.parse(alreadySeen)}subjectIDs.length>0&&workflowID&&storage&&(subjectIDs.forEach(function(subjectID){var stringID="".concat(workflowID,"/").concat(subjectID);seenThisSession.includes(stringID)||seenThisSession.push(stringID)}),storage.setItem("subjectsSeenThisSession",JSON.stringify(seenThisSession)))},check:function check(workflowID,subjectID){var storage=window?window.sessionStorage:null,alreadySeen=storage?storage.getItem("subjectsSeenThisSession"):"";return(alreadySeen?JSON.parse(alreadySeen):[]).includes("".concat(workflowID,"/").concat(subjectID))}});const subjectsSeenThisSession_subjectsSeenThisSession=subjectsSeenThisSession;var subjectViewers=__webpack_require__("./src/helpers/subjectViewers/index.js"),react=(__webpack_require__("./src/helpers/validateMimeType/index.js"),__webpack_require__("../../node_modules/react/index.js")),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),hooks=__webpack_require__("./src/hooks/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function storeMapper(classifierStore){return{project:null==classifierStore?void 0:classifierStore.projects.active}}function withFeatureFlag(Component,featureFlag){function WithFeatureFlag(props,ref){var project=(0,hooks.gy)(storeMapper).project;return null!=project&&project.experimental_tools.includes(featureFlag)?(0,jsx_runtime.jsx)(Component,function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({ref},props)):null}return(0,mobxreact_esm.PA)((0,react.forwardRef)(WithFeatureFlag))}function withStores_typeof(o){return withStores_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},withStores_typeof(o)}var _excluded=["store"];function withStores_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function withStores_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?withStores_ownKeys(Object(t),!0).forEach(function(r){withStores_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):withStores_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function withStores_defineProperty(e,r,t){return(r=function withStores_toPropertyKey(t){var i=function withStores_toPrimitive(t,r){if("object"!=withStores_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=withStores_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==withStores_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function withStores(Component){var storeMapper=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(store){return store};function WithStores(_ref,ref){var store=_ref.store,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),storeProps=store?storeMapper(store):(0,hooks.gy)(storeMapper);return(0,jsx_runtime.jsx)(Component,withStores_objectSpread(withStores_objectSpread({ref},storeProps),props))}return(0,mobxreact_esm.PA)((0,react.forwardRef)(WithStores))}},"./src/helpers/shownMarks.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={ALL:"ALL",USER:"USER",NONE:"NONE"}},"./src/helpers/subjectViewers/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>subjectViewers_subjectViewers});var subjectViewers={};Object.defineProperty(subjectViewers,"dataImage",{value:"dataImage",enumerable:!0}),Object.defineProperty(subjectViewers,"flipbook",{value:"flipbook",enumerable:!0}),Object.defineProperty(subjectViewers,"geoMap",{value:"geoMap",enumerable:!0}),Object.defineProperty(subjectViewers,"jsonData",{value:"jsonData",enumerable:!0}),Object.defineProperty(subjectViewers,"imageAndText",{value:"imageAndText",enumerable:!0}),Object.defineProperty(subjectViewers,"lightCurve",{value:"lightCurve",enumerable:!0}),Object.defineProperty(subjectViewers,"multiFrame",{value:"multiFrame",enumerable:!0}),Object.defineProperty(subjectViewers,"scatterPlot",{value:"scatterPlot",enumerable:!0}),Object.defineProperty(subjectViewers,"singleImage",{value:"singleImage",enumerable:!0}),Object.defineProperty(subjectViewers,"singleText",{value:"singleText",enumerable:!0}),Object.defineProperty(subjectViewers,"singleVideo",{value:"singleVideo",enumerable:!0}),Object.defineProperty(subjectViewers,"subjectGroup",{value:"subjectGroup",enumerable:!0}),Object.defineProperty(subjectViewers,"variableStar",{value:"variableStar",enumerable:!0}),Object.defineProperty(subjectViewers,"volumetric",{value:"volumetric",enumerable:!0}),Object.defineProperty(subjectViewers,"values",{value:Object.values(subjectViewers)});const subjectViewers_subjectViewers=subjectViewers},"./src/helpers/validateMimeType/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>validateMimeType});var mimeTypesRegexes={application:/^json/,audio:/^[mp3|m4a|mpeg]+$/,image:/^[jpeg|png|gif]+$/,text:/^plain/,video:/^[mp4|mpeg|x\-m4v]+$/};function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function validateMimeType(mimeType){var _mimeType$split2=_slicedToArray(mimeType.split("/"),2),type=_mimeType$split2[0],format=_mimeType$split2[1],isMimeTypeValid=mimeTypesRegexes[type].test(format);return isMimeTypeValid||console.error("".concat(mimeType," is not valid for use in the classifier.")),isMimeTypeValid}},"./src/hooks/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{xS:()=>useCaesarReductions,F:()=>useClientRect,KG:()=>useKeyZoom.A,Fw:()=>useMachineLearntReductions,UK:()=>usePanoptesAuth_usePanoptesAuth,io:()=>usePanoptesTranslations,F5:()=>usePanoptesUser,gy:()=>useStores,Ze:()=>useSubjectImage,ej:()=>useSubjectJSON,XW:()=>useSubjectText,ef:()=>useTranscriptionReductions});var esm_exports=__webpack_require__("./node_modules/@sentry/core/build/esm/exports.js"),react=__webpack_require__("../../node_modules/react/index.js");function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function fetchReductions(_x,_x2,_x3,_x4){return _fetchReductions.apply(this,arguments)}function _fetchReductions(){return(_fetchReductions=_asyncToGenerator(_regenerator().m(function _callee2(caesarClient,reducerKey,subjectID,workflowID){var _response$workflow,query,response,_t;return _regenerator().w(function(_context2){for(;;)switch(_context2.p=_context2.n){case 0:if(!reducerKey){_context2.n=4;break}return _context2.p=1,query="{\n        workflow(id: ".concat(workflowID,") {\n          subject_reductions(subjectId: ").concat(subjectID,', reducerKey:"').concat(reducerKey,'")\n          {\n            data\n          }\n        }\n      }'),_context2.n=2,caesarClient.request(query.replace(/\s+/g," "));case 2:return response=_context2.v,_context2.a(2,null==response||null===(_response$workflow=response.workflow)||void 0===_response$workflow?void 0:_response$workflow.subject_reductions);case 3:return _context2.p=3,_t=_context2.v,(0,esm_exports.Cp)(_t),console.error(_t),_context2.a(2,[]);case 4:return _context2.a(2,[])}},_callee2,null,[[1,3]])}))).apply(this,arguments)}function useCaesarReductions(reducerKey){var _useState2=_slicedToArray((0,react.useState)(!1),2),loaded=_useState2[0],setLoaded=_useState2[1],_useStores=useStores(),caesar=_useStores.client.caesar,subject=_useStores.subjects.active,workflow=_useStores.workflows.active;return(0,react.useEffect)(function onSubjectChange(){function _updateReductions(){return _updateReductions=_asyncToGenerator(_regenerator().m(function _callee(caesarClient,reducerKey,subject,workflowID){var reductions;return _regenerator().w(function(_context){for(;;)switch(_context.n){case 0:return _context.n=1,fetchReductions(caesarClient,reducerKey,subject.id,workflowID);case 1:reductions=_context.v,ignore||(subject.setCaesarReductions({reducer:reducerKey,subjectId:subject.id,workflowId:workflowID,reductions}),setLoaded(!0));case 2:return _context.a(2)}},_callee)})),_updateReductions.apply(this,arguments)}var ignore=!1;return null!=subject&&subject.id&&reducerKey&&(setLoaded(!1),function updateReductions(_x5,_x6,_x7,_x8){return _updateReductions.apply(this,arguments)}(caesar,reducerKey,subject,workflow.id)),function(){ignore=!0}},[caesar,reducerKey,subject,workflow.id]),{loaded,caesarReductions:subject.caesarReductions}}function useClientRect_slicedToArray(r,e){return function useClientRect_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function useClientRect_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function useClientRect_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return useClientRect_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?useClientRect_arrayLikeToArray(r,a):void 0}}(r,e)||function useClientRect_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useClientRect_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function useClientRect(){var _useState2=useClientRect_slicedToArray((0,react.useState)({}),2),rect=_useState2[0],setRect=_useState2[1];return[rect,(0,react.useCallback)(function(node){null!==node&&setRect(node.getBoundingClientRect())},[])]}__webpack_require__("./src/store/index.js"),window.sessionStorage;var useKeyZoom=__webpack_require__("./src/hooks/useKeyZoom.js"),utils=__webpack_require__("./src/store/utils/index.js");function usePanoptesAuth_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return usePanoptesAuth_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(usePanoptesAuth_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,usePanoptesAuth_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,usePanoptesAuth_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),usePanoptesAuth_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",usePanoptesAuth_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),usePanoptesAuth_regeneratorDefine2(u),usePanoptesAuth_regeneratorDefine2(u,o,"Generator"),usePanoptesAuth_regeneratorDefine2(u,n,function(){return this}),usePanoptesAuth_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(usePanoptesAuth_regenerator=function _regenerator(){return{w:i,m:f}})()}function usePanoptesAuth_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}usePanoptesAuth_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){usePanoptesAuth_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},usePanoptesAuth_regeneratorDefine2(e,r,n,t)}function usePanoptesAuth_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function usePanoptesAuth_slicedToArray(r,e){return function usePanoptesAuth_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function usePanoptesAuth_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function usePanoptesAuth_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return usePanoptesAuth_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?usePanoptesAuth_arrayLikeToArray(r,a):void 0}}(r,e)||function usePanoptesAuth_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function usePanoptesAuth_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function usePanoptesAuth_usePanoptesAuth(_ref){var authClient=_ref.authClient,_useState2=usePanoptesAuth_slicedToArray((0,react.useState)(),2),authorization=_useState2[0],setAuthorization=_useState2[1];function _checkAuth(){return _checkAuth=function usePanoptesAuth_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){usePanoptesAuth_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){usePanoptesAuth_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(usePanoptesAuth_regenerator().m(function _callee(){var token;return usePanoptesAuth_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:return _context.n=1,(0,utils.Rb)(authClient);case 1:(token=_context.v)!==authorization&&setAuthorization(token);case 2:return _context.a(2)}},_callee)})),_checkAuth.apply(this,arguments)}return function checkAuth(){return _checkAuth.apply(this,arguments)}(),authorization}var index=__webpack_require__("../../node_modules/swr/dist/index/index.mjs"),src=__webpack_require__("../lib-panoptes-js/src/index.js"),mergeWith=__webpack_require__("../../node_modules/lodash/mergeWith.js"),mergeWith_default=__webpack_require__.n(mergeWith);function usePanoptesTranslations_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return usePanoptesTranslations_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(usePanoptesTranslations_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,usePanoptesTranslations_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,usePanoptesTranslations_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),usePanoptesTranslations_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",usePanoptesTranslations_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),usePanoptesTranslations_regeneratorDefine2(u),usePanoptesTranslations_regeneratorDefine2(u,o,"Generator"),usePanoptesTranslations_regeneratorDefine2(u,n,function(){return this}),usePanoptesTranslations_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(usePanoptesTranslations_regenerator=function _regenerator(){return{w:i,m:f}})()}function usePanoptesTranslations_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}usePanoptesTranslations_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){usePanoptesTranslations_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},usePanoptesTranslations_regeneratorDefine2(e,r,n,t)}function usePanoptesTranslations_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}var SWRoptions={revalidateIfStale:!0,revalidateOnMount:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshInterval:0};function fetchTranslations(_x){return _fetchTranslations.apply(this,arguments)}function _fetchTranslations(){return _fetchTranslations=function usePanoptesTranslations_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){usePanoptesTranslations_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){usePanoptesTranslations_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(usePanoptesTranslations_regenerator().m(function _callee(_ref){var translated_id,translated_type,language,_ref$fallback,fallback,lowerCaseLang,languages,response,translation,original,customizer,mergedStrings;return usePanoptesTranslations_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:return translated_id=_ref.translated_id,translated_type=_ref.translated_type,language=_ref.language,_ref$fallback=_ref.fallback,fallback=void 0===_ref$fallback?"en":_ref$fallback,lowerCaseLang=null==language?void 0:language.toLowerCase(),languages=language===fallback?fallback:"".concat(lowerCaseLang,",").concat(fallback),_context.n=1,src.bB.get("/translations",{language:languages,translated_id,translated_type});case 1:if(response=_context.v,translation=response.body.translations.find(function(t){return t.language===lowerCaseLang}),original=response.body.translations.find(function(t){return t.language===fallback}),translation&&Object.keys(translation.strings).length){_context.n=2;break}return _context.a(2,original);case 2:return customizer=function customizer(objValue,srcValue){return""===objValue?srcValue:objValue},mergedStrings=mergeWith_default()(translation.strings,original.strings,customizer),_context.a(2,Object.assign(translation,{strings:mergedStrings}))}},_callee)})),_fetchTranslations.apply(this,arguments)}function usePanoptesTranslations(_ref2){var translated_id=_ref2.translated_id,translated_type=_ref2.translated_type,language=_ref2.language,key=translated_id?{translated_id,translated_type,language}:null;return(0,index.Ay)(key,fetchTranslations,SWRoptions).data}function usePanoptesUser_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return usePanoptesUser_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(usePanoptesUser_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,usePanoptesUser_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,usePanoptesUser_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),usePanoptesUser_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",usePanoptesUser_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),usePanoptesUser_regeneratorDefine2(u),usePanoptesUser_regeneratorDefine2(u,o,"Generator"),usePanoptesUser_regeneratorDefine2(u,n,function(){return this}),usePanoptesUser_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(usePanoptesUser_regenerator=function _regenerator(){return{w:i,m:f}})()}function usePanoptesUser_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}usePanoptesUser_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){usePanoptesUser_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},usePanoptesUser_regeneratorDefine2(e,r,n,t)}function usePanoptesUser_slicedToArray(r,e){return function usePanoptesUser_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function usePanoptesUser_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function usePanoptesUser_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return usePanoptesUser_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?usePanoptesUser_arrayLikeToArray(r,a):void 0}}(r,e)||function usePanoptesUser_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function usePanoptesUser_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function usePanoptesUser_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function usePanoptesUser_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){usePanoptesUser_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){usePanoptesUser_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function fetchPanoptesUser(_x){return _fetchPanoptesUser.apply(this,arguments)}function _fetchPanoptesUser(){return(_fetchPanoptesUser=usePanoptesUser_asyncToGenerator(usePanoptesUser_regenerator().m(function _callee2(authClient){var authorization,_yield$auth$decodeJWT,user,error,_t2;return usePanoptesUser_regenerator().w(function(_context2){for(;;)switch(_context2.p=_context2.n){case 0:return _context2.p=0,_context2.n=1,(0,utils.Rb)(authClient);case 1:if(!(authorization=_context2.v)){_context2.n=4;break}return _context2.n=2,src.j2.decodeJWT(authorization);case 2:if(_yield$auth$decodeJWT=_context2.v,user=_yield$auth$decodeJWT.user,error=_yield$auth$decodeJWT.error,!user){_context2.n=3;break}return _context2.a(2,user);case 3:if(!error){_context2.n=4;break}throw error;case 4:return _context2.n=5,authClient.checkCurrent();case 5:return _context2.a(2,_context2.v);case 6:return _context2.p=6,_t2=_context2.v,console.log(_t2),_context2.a(2,null)}},_callee2,null,[[0,6]])}))).apply(this,arguments)}function usePanoptesUser(authClient){var _useState2=usePanoptesUser_slicedToArray((0,react.useState)(null),2),error=_useState2[0],setError=_useState2[1],_useState4=usePanoptesUser_slicedToArray((0,react.useState)(null),2),user=_useState4[0],setUser=_useState4[1],_useState6=usePanoptesUser_slicedToArray((0,react.useState)(!0),2),loading=_useState6[0],setLoading=_useState6[1];return(0,react.useEffect)(function(){function checkUserSession(){return _checkUserSession.apply(this,arguments)}function _checkUserSession(){return(_checkUserSession=usePanoptesUser_asyncToGenerator(usePanoptesUser_regenerator().m(function _callee(){var panoptesUser,_t;return usePanoptesUser_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:return setLoading(!0),_context.p=1,_context.n=2,fetchPanoptesUser(authClient);case 2:panoptesUser=_context.v,setUser(panoptesUser),_context.n=4;break;case 3:_context.p=3,_t=_context.v,setError(_t);case 4:setLoading(!1);case 5:return _context.a(2)}},_callee,null,[[1,3]])}))).apply(this,arguments)}return checkUserSession(),authClient.listen("change",checkUserSession),function(){authClient.stopListening("change",checkUserSession)}},[authClient]),{data:user,error,isLoading:loading}}var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js");function useStores(){var storeMapper=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(store){return store};return storeMapper((0,react.useContext)(mobxreact_esm.Db).classifierStore)}var useProgressiveImage=__webpack_require__("../lib-react-components/dist/esm/hooks/useProgressiveImage.js");function useSubjectImage(_ref){var _ref$frame=_ref.frame,frame=void 0===_ref$frame?0:_ref$frame,src=_ref.src,onReady=_ref.onReady,onError=_ref.onError,subjectImage=(0,react.useRef)(),_useProgressiveImage=(0,useProgressiveImage.A)({placeholderSrc:"",src,onLoad:function onLoad(event){var _event$target=event.target,naturalHeight=_event$target.naturalHeight,naturalWidth=_event$target.naturalWidth,src=_event$target.src;if(""!==src){var svgImage=subjectImage.current,_ref2=svgImage?svgImage.getBoundingClientRect():{},clientWidth=_ref2.width,clientHeight=_ref2.height;onReady({target:{clientHeight,clientWidth,naturalHeight,naturalWidth}},frame)}},onError});return{img:_useProgressiveImage.img,error:_useProgressiveImage.error,loading:_useProgressiveImage.loading,subjectImage}}var mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),CSSBox=mobx_state_tree_module.gK.model("CSSBox",{bottom:mobx_state_tree_module.gK.number,left:mobx_state_tree_module.gK.number,right:mobx_state_tree_module.gK.number,top:mobx_state_tree_module.gK.number}),ChartOptions=mobx_state_tree_module.gK.model("ChartOptions",{xAxisLabel:mobx_state_tree_module.gK.string,xAxisLabelOffset:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),yAxisLabel:mobx_state_tree_module.gK.string,yAxisLabelOffset:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),margin:mobx_state_tree_module.gK.maybe(CSSBox),padding:mobx_state_tree_module.gK.maybe(CSSBox)}),BarValues=mobx_state_tree_module.gK.model("BarValues",{color:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),label:mobx_state_tree_module.gK.string,value:mobx_state_tree_module.gK.number}),BarData=mobx_state_tree_module.gK.refinement("BarData",mobx_state_tree_module.gK.array(BarValues),function(value){return value.length>0});const BarChart=mobx_state_tree_module.gK.model("BarChart",{data:BarData,chartOptions:mobx_state_tree_module.gK.maybe(ChartOptions)});var chartCoordinates=mobx_state_tree_module.gK.refinement("requiredArray",mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.number),function(value){return value.length>0});const TESSLightCurve=mobx_state_tree_module.gK.model("TESSLightCurve",{x:chartCoordinates,y:chartCoordinates});var DataSeriesPlot_CSSBox=mobx_state_tree_module.gK.model("CSSBox",{bottom:mobx_state_tree_module.gK.number,left:mobx_state_tree_module.gK.number,right:mobx_state_tree_module.gK.number,top:mobx_state_tree_module.gK.number}),InvertAxes=mobx_state_tree_module.gK.model("InvertAxes",{x:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),y:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1)}),ZoomConfiguration=mobx_state_tree_module.gK.model("ZoomConfiguration",{direction:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration(["both","x","y"]),"both"),minZoom:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,1),maxZoom:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,10),zoomInValue:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,1.2),zoomOutValue:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,.8)}),DataSeriesPlot_ChartOptions=mobx_state_tree_module.gK.model("ChartOptions",{color:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),xAxisLabel:mobx_state_tree_module.gK.string,xAxisLabelOffset:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),yAxisLabel:mobx_state_tree_module.gK.string,yAxisLabelOffset:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),invertAxes:mobx_state_tree_module.gK.maybe(InvertAxes),margin:mobx_state_tree_module.gK.maybe(DataSeriesPlot_CSSBox),padding:mobx_state_tree_module.gK.maybe(DataSeriesPlot_CSSBox),zoomConfiguration:mobx_state_tree_module.gK.maybe(ZoomConfiguration)}),DataPoint=mobx_state_tree_module.gK.model("DataPoint",{x:mobx_state_tree_module.gK.number,y:mobx_state_tree_module.gK.number,x_error:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y_error:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number)}),SeriesOptions=mobx_state_tree_module.gK.model("SeriesOptions",{glyph:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.enumeration(["circle","cross","diamond","square","star","triangle","wye"])),label:mobx_state_tree_module.gK.string,color:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),period:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number)}),DataSeries=mobx_state_tree_module.gK.model("DataSeries",{seriesData:mobx_state_tree_module.gK.array(DataPoint),seriesOptions:mobx_state_tree_module.gK.maybe(SeriesOptions)}),ChartData=mobx_state_tree_module.gK.refinement("ChartData",mobx_state_tree_module.gK.array(DataSeries),function(value){return value.length>0});const DataSeriesPlot=mobx_state_tree_module.gK.model("DataSeriesPlot",{data:mobx_state_tree_module.gK.union(ChartData,TESSLightCurve),chartOptions:mobx_state_tree_module.gK.maybe(DataSeriesPlot_ChartOptions)});var Geometry=mobx_state_tree_module.gK.model("GeoJSONGeometry",{type:mobx_state_tree_module.gK.enumeration("Type",["Point","LineString","LinearRing","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection","Circle"]),coordinates:mobx_state_tree_module.gK.frozen()}),Feature=mobx_state_tree_module.gK.model("GeoJSONFeature",{type:mobx_state_tree_module.gK.literal("Feature"),geometry:Geometry,properties:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen())});const GeoJSON=mobx_state_tree_module.gK.model("GeoJSON",{type:mobx_state_tree_module.gK.literal("FeatureCollection"),features:mobx_state_tree_module.gK.array(Feature)}),VariableStarPlots=mobx_state_tree_module.gK.model("VariableStarPlots",{data:mobx_state_tree_module.gK.model("VariableStarPlots",{scatterPlot:DataSeriesPlot,barCharts:mobx_state_tree_module.gK.map(BarChart)})}),JSONData=mobx_state_tree_module.gK.union(BarChart,DataSeriesPlot,GeoJSON,TESSLightCurve,VariableStarPlots);function useSubjectJSON_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return useSubjectJSON_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(useSubjectJSON_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,useSubjectJSON_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,useSubjectJSON_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),useSubjectJSON_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",useSubjectJSON_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),useSubjectJSON_regeneratorDefine2(u),useSubjectJSON_regeneratorDefine2(u,o,"Generator"),useSubjectJSON_regeneratorDefine2(u,n,function(){return this}),useSubjectJSON_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(useSubjectJSON_regenerator=function _regenerator(){return{w:i,m:f}})()}function useSubjectJSON_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}useSubjectJSON_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){useSubjectJSON_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},useSubjectJSON_regeneratorDefine2(e,r,n,t)}function useSubjectJSON_slicedToArray(r,e){return function useSubjectJSON_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function useSubjectJSON_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function useSubjectJSON_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return useSubjectJSON_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?useSubjectJSON_arrayLikeToArray(r,a):void 0}}(r,e)||function useSubjectJSON_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useSubjectJSON_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function useSubjectJSON_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function useSubjectJSON_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){useSubjectJSON_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){useSubjectJSON_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function getSubjectUrl(subject){var url=(subject.locations.find(function(l){return"application"===l.type||"text"===l.type})||{}).url;if(url)return url;throw new Error("No JSON url found for this subject")}function requestData(_x){return _requestData.apply(this,arguments)}function _requestData(){return(_requestData=useSubjectJSON_asyncToGenerator(useSubjectJSON_regenerator().m(function _callee2(subject){var url,response,error,responseData;return useSubjectJSON_regenerator().w(function(_context2){for(;;)switch(_context2.n){case 0:return url=getSubjectUrl(subject),_context2.n=1,fetch(url);case 1:if((response=_context2.v).ok){_context2.n=2;break}throw(error=new Error(response.statusText)).status=response.status,error;case 2:return _context2.n=3,response.json();case 3:return responseData=_context2.v,_context2.a(2,responseData)}},_callee2)}))).apply(this,arguments)}var DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function useSubjectJSON(_ref){var _ref$onError=_ref.onError,onError=void 0===_ref$onError?DEFAULT_HANDLER:_ref$onError,_ref$onReady=_ref.onReady,onReady=void 0===_ref$onReady?DEFAULT_HANDLER:_ref$onReady,subject=_ref.subject,viewer=(0,react.useRef)(),_useState2=useSubjectJSON_slicedToArray((0,react.useState)(null),2),error=_useState2[0],setError=_useState2[1],_useState4=useSubjectJSON_slicedToArray((0,react.useState)(null),2),data=_useState4[0],setData=_useState4[1];return(0,react.useEffect)(function onSubjectChange(){function onLoad(){var _viewer$current,container=null===(_viewer$current=viewer.current)||void 0===_viewer$current?void 0:_viewer$current.container,_ref2=container?container.getBoundingClientRect():{},clientWidth=_ref2.width,clientHeight=_ref2.height;onReady({clientWidth,clientHeight,naturalWidth:0,naturalHeight:0})}function _handleSubject(){return(_handleSubject=useSubjectJSON_asyncToGenerator(useSubjectJSON_regenerator().m(function _callee(){var rawData,jsonData,_t;return useSubjectJSON_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:return _context.p=0,_context.n=1,requestData(subject);case 1:if(rawData=_context.v){try{jsonData=JSONData.create(rawData)}catch(typeError){console.warn("JSON data does not match known types, using raw data:",typeError.message),jsonData=rawData}setData(jsonData),onLoad()}_context.n=3;break;case 2:_context.p=2,_t=_context.v,setError(_t),onError(_t),console.error(_t);case 3:return _context.a(2)}},_callee,null,[[0,2]])}))).apply(this,arguments)}subject&&function handleSubject(){return _handleSubject.apply(this,arguments)}()},[subject]),{loading:!data&&!error,data:data?(0,mobx_state_tree_module.gk)(data)?(0,mobx_state_tree_module.dV)(data):data:null,error,type:data&&(0,mobx_state_tree_module.gk)(data)?(0,mobx_state_tree_module.Pw)(data):null,viewer}}function useSubjectText_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return useSubjectText_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(useSubjectText_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,useSubjectText_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,useSubjectText_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),useSubjectText_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",useSubjectText_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),useSubjectText_regeneratorDefine2(u),useSubjectText_regeneratorDefine2(u,o,"Generator"),useSubjectText_regeneratorDefine2(u,n,function(){return this}),useSubjectText_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(useSubjectText_regenerator=function _regenerator(){return{w:i,m:f}})()}function useSubjectText_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}useSubjectText_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){useSubjectText_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},useSubjectText_regeneratorDefine2(e,r,n,t)}function useSubjectText_slicedToArray(r,e){return function useSubjectText_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function useSubjectText_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function useSubjectText_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return useSubjectText_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?useSubjectText_arrayLikeToArray(r,a):void 0}}(r,e)||function useSubjectText_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useSubjectText_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function useSubjectText_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function useSubjectText_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){useSubjectText_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){useSubjectText_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function useSubjectText_getSubjectUrl(subject){var url=(subject.locations.find(function(l){return"text"===l.type})||{}).url;if(url)return url;throw new Error("No text url found for this subject")}function useSubjectText_requestData(_x){return hooks_useSubjectText_requestData.apply(this,arguments)}function hooks_useSubjectText_requestData(){return(hooks_useSubjectText_requestData=useSubjectText_asyncToGenerator(useSubjectText_regenerator().m(function _callee2(subject){var url,response,error,body;return useSubjectText_regenerator().w(function(_context2){for(;;)switch(_context2.n){case 0:return url=useSubjectText_getSubjectUrl(subject),_context2.n=1,fetch(url);case 1:if((response=_context2.v).ok){_context2.n=2;break}throw(error=new Error(response.statusText)).status=response.status,error;case 2:return _context2.n=3,response.text();case 3:return body=_context2.v,_context2.a(2,body)}},_callee2)}))).apply(this,arguments)}var useSubjectText_DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function useSubjectText(_ref){var _ref$frame=_ref.frame,frame=void 0===_ref$frame?0:_ref$frame,subject=_ref.subject,_ref$onReady=_ref.onReady,onReady=void 0===_ref$onReady?useSubjectText_DEFAULT_HANDLER:_ref$onReady,_ref$onError=_ref.onError,onError=void 0===_ref$onError?useSubjectText_DEFAULT_HANDLER:_ref$onError,_useState2=useSubjectText_slicedToArray((0,react.useState)(""),2),data=_useState2[0],setData=_useState2[1],_useState4=useSubjectText_slicedToArray((0,react.useState)(null),2),error=_useState4[0],setError=_useState4[1];return(0,react.useEffect)(function onSubjectChange(){function onLoad(rawData){setData(rawData),onReady(null,frame)}function _handleSubject(){return(_handleSubject=useSubjectText_asyncToGenerator(useSubjectText_regenerator().m(function _callee(){var rawData,_t;return useSubjectText_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:return _context.p=0,_context.n=1,useSubjectText_requestData(subject);case 1:(rawData=_context.v)&&onLoad(rawData),_context.n=3;break;case 2:_context.p=2,_t=_context.v,setError(_t),onError(_t);case 3:return _context.a(2)}},_callee,null,[[0,2]])}))).apply(this,arguments)}subject&&function handleSubject(){return _handleSubject.apply(this,arguments)}()},[subject,onReady,onError]),{data,error,loading:!data&&!error}}var currentScopes=__webpack_require__("./node_modules/@sentry/core/build/esm/currentScopes.js"),shownMarks=__webpack_require__("./src/helpers/shownMarks.js");function useTranscriptionReductions_slicedToArray(r,e){return function useTranscriptionReductions_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function useTranscriptionReductions_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function useTranscriptionReductions_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return useTranscriptionReductions_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?useTranscriptionReductions_arrayLikeToArray(r,a):void 0}}(r,e)||function useTranscriptionReductions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useTranscriptionReductions_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function useTranscriptionReductions_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return useTranscriptionReductions_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(useTranscriptionReductions_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,useTranscriptionReductions_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,useTranscriptionReductions_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),useTranscriptionReductions_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",useTranscriptionReductions_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),useTranscriptionReductions_regeneratorDefine2(u),useTranscriptionReductions_regeneratorDefine2(u,o,"Generator"),useTranscriptionReductions_regeneratorDefine2(u,n,function(){return this}),useTranscriptionReductions_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(useTranscriptionReductions_regenerator=function _regenerator(){return{w:i,m:f}})()}function useTranscriptionReductions_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}useTranscriptionReductions_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){useTranscriptionReductions_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},useTranscriptionReductions_regeneratorDefine2(e,r,n,t)}function useTranscriptionReductions_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function useTranscriptionReductions_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){useTranscriptionReductions_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){useTranscriptionReductions_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function checkUser(){return _checkUser.apply(this,arguments)}function _checkUser(){return _checkUser=useTranscriptionReductions_asyncToGenerator(useTranscriptionReductions_regenerator().m(function _callee2(){var userIDs,authorization,token,_yield$auth$verify,data,_args2=arguments;return useTranscriptionReductions_regenerator().w(function(_context2){for(;;)switch(_context2.n){case 0:if(userIDs=_args2.length>0&&void 0!==_args2[0]?_args2[0]:[],!(authorization=_args2.length>1?_args2[1]:void 0)){_context2.n=2;break}return token=authorization.replace("Bearer ",""),_context2.n=1,src.j2.verify(token);case 1:return _yield$auth$verify=_context2.v,data=_yield$auth$verify.data,_context2.a(2,data&&userIDs.includes(data.id));case 2:return _context2.a(2,!1)}},_callee2)})),_checkUser.apply(this,arguments)}function logDuplicateSubject(subjectSnapshot){var subjectError=new Error("Duplicate transcription subject: ".concat(subjectSnapshot.id));currentScopes.v4(function(scope){scope.setTag("subjectError","duplicate"),scope.setExtra("subject",JSON.stringify(subjectSnapshot)),esm_exports.Cp(subjectError)})}function useTranscriptionReductions(){var _subject$stepHistory,_useStores=useStores(),authClient=_useStores.authClient,subject=_useStores.subjects.active,frame=_useStores.subjectViewer.frame,workflow=_useStores.workflows.active,_useStores$workflowSt=_useStores.workflowSteps,step=_useStores$workflowSt.active,findTasksByType=_useStores$workflowSt.findTasksByType,_useCaesarReductions=useCaesarReductions(workflow.caesarReducer),loaded=_useCaesarReductions.loaded,caesarReductions=_useCaesarReductions.caesarReductions;(0,react.useEffect)(function checkTranscriptionUsers(){function _checkSubject(){return(_checkSubject=useTranscriptionReductions_asyncToGenerator(useTranscriptionReductions_regenerator().m(function _callee(){var authorization,alreadySeen;return useTranscriptionReductions_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:return _context.n=1,(0,utils.Rb)(authClient);case 1:return authorization=_context.v,_context.n=2,checkUser(null==caesarReductions?void 0:caesarReductions.userIDs,authorization);case 2:alreadySeen=_context.v,!ignore&&alreadySeen&&(logDuplicateSubject((0,mobx_state_tree_module.dV)(subject)),subject.markAsSeen());case 3:return _context.a(2)}},_callee)}))).apply(this,arguments)}var ignore=!1;return subject&&loaded&&function checkSubject(){return _checkSubject.apply(this,arguments)}(),function(){ignore=!0}},[loaded,caesarReductions,subject]);var lines=[],activeStepAnnotations=null==subject||null===(_subject$stepHistory=subject.stepHistory)||void 0===_subject$stepHistory?void 0:_subject$stepHistory.latest.annotations,task=useTranscriptionReductions_slicedToArray(findTasksByType("transcription"),1)[0],marks=null==task?void 0:task.marks,annotation=activeStepAnnotations.find(function(annotation){return annotation.task===(null==task?void 0:task.taskKey)}),invalidMark=!(null!=step&&step.isValid);loaded&&"TranscriptionReductions"===(0,mobx_state_tree_module.Pw)(caesarReductions).name&&(lines=caesarReductions.consensusLines(frame));var visible=(null==workflow?void 0:workflow.usesTranscriptionTask)&&loaded&&(null==task?void 0:task.shownMarks)===shownMarks.A.ALL&&lines.length>0;return{active:step.tasks.find(function(t){return(null==task?void 0:task.taskKey)===t.taskKey}),annotation,frame,invalidMark,lines,marks,task,visible,workflow}}var _excluded=["stepKey","taskIndex","taskKey","taskType","toolType"];function useMachineLearntReductions_slicedToArray(r,e){return function useMachineLearntReductions_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function useMachineLearntReductions_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function useMachineLearntReductions_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return useMachineLearntReductions_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?useMachineLearntReductions_arrayLikeToArray(r,a):void 0}}(r,e)||function useMachineLearntReductions_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useMachineLearntReductions_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function useMachineLearntReductions(){var _useStores=useStores(),workflow=_useStores.workflows.active,_useStores$workflowSt=_useStores.workflowSteps,step=_useStores$workflowSt.active,findTasksByType=_useStores$workflowSt.findTasksByType,activeSubject=_useStores.subjects.active,_useCaesarReductions=useCaesarReductions(workflow.caesarReducer),loaded=_useCaesarReductions.loaded,caesarReductions=_useCaesarReductions.caesarReductions,stepIndex=parseInt(step.stepKey.replace("S",""),10);if(loaded&&"MachineLearntReductions"===(0,mobx_state_tree_module.Pw)(caesarReductions).name&&!0!==activeSubject.caesarReductionsLoadedForStep[stepIndex]){var caesarMarks=caesarReductions.findCurrentTaskMarks({stepKey:step.stepKey});caesarMarks&&caesarMarks.forEach(function(caesarMark){caesarMark.stepKey,caesarMark.taskIndex,caesarMark.taskKey,caesarMark.taskType,caesarMark.toolType;var _step$tasks$0$tools$n,newMark=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(caesarMark,_excluded);newMark.id=newMark.markId,delete newMark.markId,null==step||null===(_step$tasks$0$tools$n=step.tasks[0].tools[newMark.toolIndex])||void 0===_step$tasks$0$tools$n||_step$tasks$0$tools$n.createMark(newMark)}),activeSubject.setCaesarReductionsLoadedForStep(stepIndex)}return{task:useMachineLearntReductions_slicedToArray(findTasksByType("drawing"),1)[0]}}},"./src/hooks/useKeyZoom.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>useKeyZoom,o:()=>defaultKeyMappings});var ___WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/hooks/index.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var ALLOWED_TAGS=["svg","button","g","rect","image"];function storeMapper(classifierStore){var _classifierStore$subj=classifierStore.subjectViewer;return{panLeft:_classifierStore$subj.panLeft,panRight:_classifierStore$subj.panRight,panUp:_classifierStore$subj.panUp,panDown:_classifierStore$subj.panDown,zoomIn:_classifierStore$subj.zoomIn,zoomOut:_classifierStore$subj.zoomOut}}function defaultKeyMappings(_ref){var panLeft=_ref.panLeft,panRight=_ref.panRight,panUp=_ref.panUp,panDown=_ref.panDown,rotate=_ref.rotate,zoomIn=_ref.zoomIn,zoomOut=_ref.zoomOut,_ref$customKeyMapping=_ref.customKeyMappings,customKeyMappings=void 0===_ref$customKeyMapping?{}:_ref$customKeyMapping,rotation=Math.abs(rotate)%360,keyMappings=function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({"+":zoomIn,"=":zoomIn,"-":zoomOut,_:zoomOut},customKeyMappings);return 0===rotation&&(keyMappings.ArrowRight=panRight,keyMappings.ArrowLeft=panLeft,keyMappings.ArrowUp=panUp,keyMappings.ArrowDown=panDown),90===rotation&&(keyMappings.ArrowRight=panDown,keyMappings.ArrowLeft=panUp,keyMappings.ArrowUp=panRight,keyMappings.ArrowDown=panLeft),180===rotation&&(keyMappings.ArrowRight=panLeft,keyMappings.ArrowLeft=panRight,keyMappings.ArrowUp=panDown,keyMappings.ArrowDown=panUp),270===rotation&&(keyMappings.ArrowRight=panUp,keyMappings.ArrowLeft=panDown,keyMappings.ArrowUp=panLeft,keyMappings.ArrowDown=panRight),{onKeyZoom:function onKeyZoom(event){var _event$target,htmlTag=null===(_event$target=event.target)||void 0===_event$target?void 0:_event$target.tagName.toLowerCase(),handler=keyMappings[event.key];return!ALLOWED_TAGS.includes(htmlTag)||!handler||(event.preventDefault(),handler(),!1)}}}function useKeyZoom(){var _ref2=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref2$rotate=_ref2.rotate,rotate=void 0===_ref2$rotate?0:_ref2$rotate,_ref2$customKeyMappin=_ref2.customKeyMappings,customKeyMappings=void 0===_ref2$customKeyMappin?{}:_ref2$customKeyMappin,_useStores=(0,___WEBPACK_IMPORTED_MODULE_0__.gy)(storeMapper);return defaultKeyMappings({panLeft:_useStores.panLeft,panRight:_useStores.panRight,panUp:_useStores.panUp,panDown:_useStores.panDown,rotate,zoomIn:_useStores.zoomIn,zoomOut:_useStores.zoomOut,customKeyMappings})}},"./src/plugins/drawingTools/components/Circle/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Circle_Circle});var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),DragHandle=__webpack_require__("./src/plugins/drawingTools/components/DragHandle/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1},GUIDE_DASH=[4,4];function Circle(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,mark=_ref.mark,_ref$onFinish=_ref.onFinish,onFinish=void 0===_ref$onFinish?DEFAULT_HANDLER:_ref$onFinish,x_center=mark.x_center,y_center=mark.y_center,r=mark.r,handleX=r;return(0,jsx_runtime.jsxs)("g",{onPointerUp:active?onFinish:void 0,children:[(0,jsx_runtime.jsx)("circle",{r,"data-testid":"circle-element",vectorEffect:"non-scaling-stroke"}),active&&(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)("line",{x1:0,y1:0,x2:handleX,y2:0,strokeWidth:1,strokeDasharray:GUIDE_DASH,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)(DragHandle.A,{x:handleX,y:0,dragMove:function onHandleDrag(e){var r=mark.getDistance(x_center,y_center,e.x,e.y);mark.setCoordinates({x:x_center,y:y_center,r})},"data-testid":"circle-dragHandle"})]})]})}Circle.propTypes={active:prop_types_default().bool,mark:prop_types_default().shape({r:prop_types_default().number,x_center:prop_types_default().number,y_center:prop_types_default().number}).isRequired,onFinish:prop_types_default().func};const Circle_Circle=(0,mobxreact_esm.PA)(Circle);Circle.__docgenInfo={description:"",methods:[],displayName:"Circle",props:{active:{defaultValue:{value:"false",computed:!1},description:"Modal active state.",type:{name:"bool"},required:!1},onFinish:{defaultValue:{value:"() => false",computed:!1},description:"Callback to reset the drawing canvas when creation of the rectangle is finished.",type:{name:"func"},required:!1},mark:{description:"Circle Attributes:",type:{name:"shape",value:{r:{name:"number",required:!1},x_center:{name:"number",required:!1},y_center:{name:"number",required:!1}}},required:!0}}}},"./src/plugins/drawingTools/components/DragHandle/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>DragHandle_DragHandle});var react=__webpack_require__("../../node_modules/react/index.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),draggable=__webpack_require__("./src/plugins/drawingTools/components/draggable/index.js"),Mark=__webpack_require__("./src/plugins/drawingTools/components/Mark/Mark.jsx"),useScale=__webpack_require__("./src/plugins/drawingTools/hooks/useScale.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var _excluded=["fill","radius","x","y","dragging","invisibleWhenDragging","onPointerDown","onPointerMove","onPointerUp"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var StyledCircle=(0,styled_components_browser_esm.default)("circle").withConfig({displayName:"DragHandle__StyledCircle",componentId:"sc-1loe7uv-0"})(["stroke-width:2;&:hover{cursor:move;}"]),RADIUS=screen.width>900?3*Mark.AM:5*Mark.AM,DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1};function DragHandleWithRef(_ref,ref){var _ref$fill=_ref.fill,fill=void 0===_ref$fill?"currentColor":_ref$fill,_ref$radius=_ref.radius,radius=void 0===_ref$radius?RADIUS:_ref$radius,x=_ref.x,y=_ref.y,_ref$dragging=_ref.dragging,dragging=void 0!==_ref$dragging&&_ref$dragging,_ref$invisibleWhenDra=_ref.invisibleWhenDragging,invisibleWhenDragging=void 0!==_ref$invisibleWhenDra&&_ref$invisibleWhenDra,_ref$onPointerDown=_ref.onPointerDown,onPointerDown=void 0===_ref$onPointerDown?DEFAULT_HANDLER:_ref$onPointerDown,_ref$onPointerMove=_ref.onPointerMove,onPointerMove=void 0===_ref$onPointerMove?DEFAULT_HANDLER:_ref$onPointerMove,_ref$onPointerUp=_ref.onPointerUp,onPointerUp=void 0===_ref$onPointerUp?DEFAULT_HANDLER:_ref$onPointerUp,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),scale=(0,useScale.A)(),transform="translate(".concat(x,", ").concat(y,") scale(").concat(1/scale,")"),styleProps={fill:dragging&&invisibleWhenDragging?"transparent":fill,stroke:dragging&&invisibleWhenDragging?"transparent":"currentColor",strokeWidth:1};return(0,jsx_runtime.jsxs)("g",_objectSpread(_objectSpread({ref,transform,onPointerDown,onPointerMove,onPointerUp},props),{},{children:[(0,jsx_runtime.jsx)(StyledCircle,_objectSpread(_objectSpread({r:radius},styleProps),{},{vectorEffect:"non-scaling-stroke"})),(0,jsx_runtime.jsx)(StyledCircle,{r:2*radius,fill:"transparent",stroke:"transparent",vectorEffect:"non-scaling-stroke"})]}))}var DragHandle=(0,react.forwardRef)(DragHandleWithRef);DragHandle.propTypes={fill:prop_types_default().string,invisibleWhenDragging:prop_types_default().bool,onPointerDown:prop_types_default().func,onPointerMove:prop_types_default().func,onPointerUp:prop_types_default().func,radius:prop_types_default().number,x:prop_types_default().number.isRequired,y:prop_types_default().number.isRequired};const DragHandle_DragHandle=(0,draggable.A)(DragHandle);DragHandle.__docgenInfo={description:"",methods:[],displayName:"DragHandle",props:{fill:{defaultValue:{value:"'currentColor'",computed:!1},description:"",type:{name:"string"},required:!1},radius:{defaultValue:{value:"screen.width > 900 ? 3 * STROKE_WIDTH : 5 * STROKE_WIDTH",computed:!1},description:"",type:{name:"number"},required:!1},dragging:{defaultValue:{value:"false",computed:!1},required:!1},invisibleWhenDragging:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},onPointerDown:{defaultValue:{value:"() => false",computed:!1},description:"",type:{name:"func"},required:!1},onPointerMove:{defaultValue:{value:"() => false",computed:!1},description:"",type:{name:"func"},required:!1},onPointerUp:{defaultValue:{value:"() => false",computed:!1},description:"",type:{name:"func"},required:!1},x:{description:"",type:{name:"number"},required:!0},y:{description:"",type:{name:"number"},required:!0}}}},"./src/plugins/drawingTools/components/Ellipse/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Ellipse_Ellipse});var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),DragHandle=__webpack_require__("./src/plugins/drawingTools/components/DragHandle/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),GUIDE_DASH=[4,4],DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1};function Ellipse(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,mark=_ref.mark,_ref$onFinish=_ref.onFinish,onFinish=void 0===_ref$onFinish?DEFAULT_HANDLER:_ref$onFinish,x_center=mark.x_center,y_center=mark.y_center,rx=mark.rx,ry=mark.ry;return(0,jsx_runtime.jsxs)("g",{onPointerUp:active?onFinish:void 0,children:[(0,jsx_runtime.jsx)("ellipse",{rx,ry,vectorEffect:"non-scaling-stroke"}),active&&(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)("line",{x1:"0",y1:"0",x2:rx,y2:"0",strokeWidth:1,strokeDasharray:GUIDE_DASH,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("line",{x1:"0",y1:"0",x2:"0",y2:-1*ry,strokeWidth:1,strokeDasharray:GUIDE_DASH,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)(DragHandle.A,{dragMove:function onXHandleDrag(e){var r=mark.getDistance(x_center,y_center,e.x,e.y),angle=mark.getAngle(x_center,y_center,e.x,e.y);mark.setCoordinates({x:x_center,y:y_center,rx:r,ry,angle})},x:rx,y:0}),(0,jsx_runtime.jsx)(DragHandle.A,{dragMove:function onYHandleDrag(e){var r=mark.getDistance(x_center,y_center,e.x,e.y),angle=mark.getAngle(x_center,y_center,e.x,e.y)+90;mark.setCoordinates({x:x_center,y:y_center,rx,ry:r,angle})},dragEnd:mark.finish,x:0,y:-1*ry})]})]})}Ellipse.propTypes={active:prop_types_default().bool,mark:prop_types_default().object.isRequired,onFinish:prop_types_default().func};const Ellipse_Ellipse=(0,mobxreact_esm.PA)(Ellipse);Ellipse.__docgenInfo={description:"",methods:[],displayName:"Ellipse",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},onFinish:{defaultValue:{value:"() => false",computed:!1},description:"",type:{name:"func"},required:!1},mark:{description:"",type:{name:"object"},required:!0}}}},"./src/plugins/drawingTools/components/Line/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Line_Line});var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),DragHandle=__webpack_require__("./src/plugins/drawingTools/components/DragHandle/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function Line(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,mark=_ref.mark,onFinish=_ref.onFinish,x1=mark.x1,y1=mark.y1,x2=mark.x2,y2=mark.y2;function onHandleDrag(coords){mark.setCoordinates(coords)}return(0,jsx_runtime.jsxs)("g",{onPointerUp:active?onFinish:void 0,children:[(0,jsx_runtime.jsx)("line",{x1,y1,x2,y2,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("line",{x1,y1,x2,y2,strokeWidth:6,strokeOpacity:"0",vectorEffect:"non-scaling-stroke"}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x1,y:y1,dragMove:function dragMove(e,d){return onHandleDrag({x1:x1+d.x,y1:y1+d.y,x2,y2})}}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x2,y:y2,dragMove:function dragMove(e,d){return onHandleDrag({x1,y1,x2:x2+d.x,y2:y2+d.y})}})]})}Line.propTypes={active:prop_types_default().bool,mark:prop_types_default().object.isRequired};const Line_Line=(0,mobxreact_esm.PA)(Line);Line.__docgenInfo={description:"",methods:[],displayName:"Line",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},mark:{description:"",type:{name:"object"},required:!0}}}},"./src/plugins/drawingTools/components/Mark/Mark.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{AM:()=>STROKE_WIDTH,Ay:()=>__WEBPACK_DEFAULT_EXPORT__});var mobx_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_draggable__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/plugins/drawingTools/components/draggable/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var STROKE_WIDTH=2,StyledGroup=styled_components__WEBPACK_IMPORTED_MODULE_3__.default.g.withConfig({displayName:"Mark__StyledGroup",componentId:"sc-196x620-0"})(["stroke-width:","px;&.active{stroke-width:","px;}&:focus{outline:none;}&:focus-visible{",'}&[aria-disabled="false"]:hover{',"}"],STROKE_WIDTH,4,function(props){return(0,styled_components__WEBPACK_IMPORTED_MODULE_3__.css)(["outline:solid medium ",";"],props.focusColor)},function(props){return props.dragging?(0,styled_components__WEBPACK_IMPORTED_MODULE_3__.css)(["cursor:grabbing;"]):(0,styled_components__WEBPACK_IMPORTED_MODULE_3__.css)(["cursor:grab;"])});function focusMark(markNode){if(!(markNode===document.activeElement)){var x=scrollX,y=scrollY;null==markNode||markNode.focus(),window.scrollTo(x,y)}}function defaultHandler(){return!0}var Mark=(0,react__WEBPACK_IMPORTED_MODULE_2__.forwardRef)(function Mark(_ref,ref){var children=_ref.children,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$dragging=_ref.dragging,dragging=void 0!==_ref$dragging&&_ref$dragging,_ref$isActive=_ref.isActive,isActive=void 0!==_ref$isActive&&_ref$isActive,label=_ref.label,mark=_ref.mark,_ref$onDelete=_ref.onDelete,onDelete=void 0===_ref$onDelete?defaultHandler:_ref$onDelete,_ref$onFinish=_ref.onFinish,onFinish=void 0===_ref$onFinish?defaultHandler:_ref$onFinish,_ref$onSelect=_ref.onSelect,onSelect=void 0===_ref$onSelect?defaultHandler:_ref$onSelect,_ref$pointerEvents=_ref.pointerEvents,pointerEvents=void 0===_ref$pointerEvents?"painted":_ref$pointerEvents,theme=(0,styled_components__WEBPACK_IMPORTED_MODULE_3__.useTheme)(),markRoot=null!=ref?ref:(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(),tool=mark.tool,mainStyle={color:tool&&tool.color?tool.color:"green",fill:"transparent",stroke:tool&&tool.color?tool.color:"green"},focusColor=null==theme?void 0:theme.global.colors[null==theme?void 0:theme.global.colors.focus],usesSubTasks=mark.isValid&&mark.tasks.length>0;function openSubTaskPopup(){if(!mark.subTaskVisibility){var _markRoot$current,markBounds=null===(_markRoot$current=markRoot.current)||void 0===_markRoot$current?void 0:_markRoot$current.getBoundingClientRect();mark.setSubTaskVisibility(!0,markBounds)}}(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(function onSelectMark(){isActive&&mark.finished&&focusMark(markRoot.current)},[isActive,mark.finished]),(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(function onFinishMarkWithSubTasks(){usesSubTasks&&mark.finished&&openSubTaskPopup()},[usesSubTasks,mark.finished]),(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(function onCloseSubTasks(){isActive&&mark.finished&&!mark.subTaskVisibility&&focusMark(markRoot.current)},[isActive,mark.finished,mark.subTaskVisibility]);var transform="";if(transform=mark.x&&mark.y?"".concat(transform," translate(").concat(mark.x,", ").concat(mark.y,")"):transform,mark.angle){var rotateTransform=mark.x_rotate&&mark.y_rotate?"rotate(".concat(mark.angle,", ").concat(mark.x_rotate,", ").concat(mark.y_rotate,")"):"rotate(".concat(mark.angle,")");transform="".concat(transform," ").concat(rotateTransform)}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(StyledGroup,_objectSpread(_objectSpread({},mainStyle),{},{id:"mark-".concat(mark.id),"data-testid":"mark-mark","aria-disabled":disabled?"true":"false","aria-label":label,className:"drawingMark ".concat(isActive?"active":""),dragging,focusable:!0,focusColor,onFocus:function onFocus(){var _markRoot$current2,_markRoot$current2$sc;onSelect(mark),null===(_markRoot$current2=markRoot.current)||void 0===_markRoot$current2||null===(_markRoot$current2$sc=_markRoot$current2.scrollIntoView)||void 0===_markRoot$current2$sc||_markRoot$current2$sc.call(_markRoot$current2)},onKeyDown:function onKeyDown(event){switch(event.key){case"Backspace":return event.preventDefault(),event.stopPropagation(),onDelete(mark),!1;case" ":case"Enter":return event.preventDefault(),event.stopPropagation(),openSubTaskPopup(),onFinish(event),!1;default:return!0}},onPointerUp:function onPointerUp(){usesSubTasks&&openSubTaskPopup()},pointerEvents,ref:markRoot,role:"button",tabIndex:disabled?-1:0,transform,children}))});Mark.propTypes={dragging:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,children:prop_types__WEBPACK_IMPORTED_MODULE_1___default().node.isRequired,isActive:prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool,label:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string.isRequired,onDelete:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,onDeselect:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,onSelect:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,tool:prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({color:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string})};const __WEBPACK_DEFAULT_EXPORT__=(0,_draggable__WEBPACK_IMPORTED_MODULE_4__.A)((0,mobx_react__WEBPACK_IMPORTED_MODULE_0__.PA)(Mark));Mark.__docgenInfo={description:"",methods:[],displayName:"Mark",props:{disabled:{defaultValue:{value:"false",computed:!1},required:!1},dragging:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},isActive:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},onDelete:{defaultValue:{value:"function defaultHandler() {\n  return true\n}",computed:!1},description:"",type:{name:"func"},required:!1},onFinish:{defaultValue:{value:"function defaultHandler() {\n  return true\n}",computed:!1},required:!1},onSelect:{defaultValue:{value:"function defaultHandler() {\n  return true\n}",computed:!1},description:"",type:{name:"func"},required:!1},pointerEvents:{defaultValue:{value:"'painted'",computed:!1},required:!1},children:{description:"",type:{name:"node"},required:!0},label:{description:"",type:{name:"string"},required:!0},onDeselect:{description:"",type:{name:"func"},required:!1},tool:{description:"",type:{name:"shape",value:{color:{name:"string",required:!1}}},required:!1}}}},"./src/plugins/drawingTools/components/Point/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Point_Point});var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),useScale=__webpack_require__("./src/plugins/drawingTools/hooks/useScale.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),RADIUS={large:10,small:2},SELECTED_RADIUS={large:20,small:10},DEFAULT_MARK={tool:{size:"large"}};function Point(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,_ref$mark=_ref.mark,mark=void 0===_ref$mark?{DEFAULT_MARK}:_ref$mark,onFinish=_ref.onFinish,scale=(0,useScale.A)(),size=mark.tool.size,selectedRadius=SELECTED_RADIUS[size],radius=RADIUS[size];return(0,jsx_runtime.jsxs)("g",{transform:"scale(".concat(1/scale,")"),onPointerUp:active?onFinish:void 0,children:[(0,jsx_runtime.jsx)("line",{x1:"0",y1:-.2*selectedRadius,x2:"0",y2:-1*selectedRadius,strokeWidth:1,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("line",{x1:-.2*selectedRadius,y1:"0",x2:-1*selectedRadius,y2:"0",strokeWidth:1,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("line",{x1:"0",y1:.2*selectedRadius,x2:"0",y2:selectedRadius,strokeWidth:1,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("line",{x1:.2*selectedRadius,y1:"0",x2:selectedRadius,y2:"0",strokeWidth:1,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("circle",{r:active?selectedRadius:radius,vectorEffect:"non-scaling-stroke"})]})}Point.propTypes={active:prop_types_default().bool,mark:prop_types_default().object};const Point_Point=(0,mobxreact_esm.PA)(Point);Point.__docgenInfo={description:"",methods:[],displayName:"Point",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},mark:{defaultValue:{value:"{DEFAULT_MARK}",computed:!1},description:"",type:{name:"object"},required:!1}}}},"./src/plugins/drawingTools/components/Polygon/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Polygon_Polygon});var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),UndoButton=__webpack_require__("./src/plugins/drawingTools/components/UndoButton/index.js"),DragHandle=__webpack_require__("./src/plugins/drawingTools/components/DragHandle/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),GuideLine=styled_components_browser_esm.default.line.withConfig({displayName:"Polygon__GuideLine",componentId:"sc-1tth94i-0"})(["pointer-events:none;"]);function Polygon(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,mark=_ref.mark,onFinish=_ref.onFinish,path=mark.path,points=mark.points,initialPoint=mark.initialPoint,lastPoint=mark.lastPoint,finished=mark.finished,guideLineX=mark.guideLineX,guideLineY=mark.guideLineY;function handleClosePolygon(event){mark.finish(),onFinish(event)}var fill=finished?"transparent":"none",strokeDasharray=finished?void 0:"2 2";return(0,jsx_runtime.jsxs)("g",{children:[active&&!finished&&points.length>1&&(0,jsx_runtime.jsx)(UndoButton.A,{x:initialPoint.x,y:initialPoint.y,undoDrawing:function onUndoDrawing(){mark.shortenPath()}}),"/* Visible lines */",(0,jsx_runtime.jsx)("polyline",{points:path,fill:"none",vectorEffect:"non-scaling-stroke"}),"/* So users can easily select the polygon */",(0,jsx_runtime.jsx)("polyline",{points:path,strokeWidth:6,strokeOpacity:"0",fill,vectorEffect:"non-scaling-stroke"}),"/* To visibly show a closed polygon */",(0,jsx_runtime.jsx)("line",{x1:lastPoint.x,y1:lastPoint.y,x2:initialPoint.x,y2:initialPoint.y,strokeDasharray,vectorEffect:"non-scaling-stroke"}),active&&points.map(function(point,i){return(0,jsx_runtime.jsx)(DragHandle.A,{r:3,x:point.x,y:point.y,fill:"currentColor",dragMove:point.moveTo,onPointerUp:handleClosePolygon},"".concat(mark.id,"-").concat(i))}),!finished&&active&&"number"==typeof guideLineX&&"number"==typeof guideLineY&&(0,jsx_runtime.jsx)(GuideLine,{x1:lastPoint.x,y1:lastPoint.y,x2:guideLineX,y2:guideLineY,strokeWidth:1,strokeDasharray:"2 2",vectorEffect:"non-scaling-stroke"})]})}Polygon.propTypes={active:prop_types_default().bool,mark:prop_types_default().shape({path:prop_types_default().string,initialPoint:prop_types_default().shape({x:prop_types_default().number,y:prop_types_default().number}),lastPoint:prop_types_default().shape({x:prop_types_default().number,y:prop_types_default().number}),finished:prop_types_default().bool}).isRequired};const Polygon_Polygon=(0,mobxreact_esm.PA)(Polygon);Polygon.__docgenInfo={description:"",methods:[],displayName:"Polygon",props:{active:{defaultValue:{value:"false",computed:!1},description:"Modal active state.",type:{name:"bool"},required:!1},mark:{description:"Polygon data: { path, initialPoint, lastPoint, finished }",type:{name:"shape",value:{path:{name:"string",required:!1},initialPoint:{name:"shape",value:{x:{name:"number",required:!1},y:{name:"number",required:!1}},required:!1},lastPoint:{name:"shape",value:{x:{name:"number",required:!1},y:{name:"number",required:!1}},required:!1},finished:{name:"bool",required:!1}}},required:!0}}}},"./src/plugins/drawingTools/components/Rectangle/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Rectangle_Rectangle});var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),DragHandle=__webpack_require__("./src/plugins/drawingTools/components/DragHandle/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function Rectangle(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,mark=_ref.mark,onFinish=_ref.onFinish,x_center=mark.x_center,y_center=mark.y_center,width=mark.width,height=mark.height;function onHandleDrag(coords){mark.setCoordinates(coords)}var x_left=x_center-width/2,x_right=x_center+width/2,y_top=y_center-height/2,y_bottom=y_center+height/2,_onFinish=onFinish||function(){return!0};return(0,jsx_runtime.jsxs)("g",{onPointerUp:active?_onFinish:void 0,children:[(0,jsx_runtime.jsx)("rect",{x:x_left,y:y_top,width,height,"data-testid":"rectangle-element",vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("rect",{x:x_left,y:y_top,width,height,strokeWidth:6,strokeOpacity:"0",vectorEffect:"non-scaling-stroke"}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_left,y:y_top,"data-testid":"rect-dragHandle1",dragMove:function dragMove(e,d){return onHandleDrag({x_left:x_left+d.x,x_right,y_top:y_top+d.y,y_bottom})}}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_right,y:y_bottom,"data-testid":"rect-dragHandle2",dragMove:function dragMove(e,d){return onHandleDrag({x_left,x_right:x_right+d.x,y_top,y_bottom:y_bottom+d.y})}}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_left,y:y_bottom,"data-testid":"rect-dragHandle3",dragMove:function dragMove(e,d){return onHandleDrag({x_left:x_left+d.x,x_right,y_top,y_bottom:y_bottom+d.y})}}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_right,y:y_top,"data-testid":"rect-dragHandle4",dragMove:function dragMove(e,d){return onHandleDrag({x_left,x_right:x_right+d.x,y_top:y_top+d.y,y_bottom})}})]})}Rectangle.propTypes={active:prop_types_default().bool};const Rectangle_Rectangle=(0,mobxreact_esm.PA)(Rectangle);Rectangle.__docgenInfo={description:"",methods:[],displayName:"Rectangle",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1}}}},"./src/plugins/drawingTools/components/UndoButton/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>UndoButton_UndoButton});var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),Tooltip=__webpack_require__("../lib-react-components/dist/esm/Tooltip/Tooltip.js"),useScale=__webpack_require__("./src/plugins/drawingTools/hooks/useScale.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledGroup=(0,styled_components_browser_esm.default)("g").withConfig({displayName:"UndoButton__StyledGroup",componentId:"sc-1axx3jx-0"})(["&:hover{cursor:pointer;}"]);function UndoButton(_ref){var x=_ref.x,y=_ref.y,undoDrawing=_ref.undoDrawing,scale=(0,useScale.A)(),undoTransform="translate(".concat(x+15,", ").concat(y-35,") scale(").concat(1/scale,")"),cx=x+20,cy=y-30;function onPointerDown(event){return event.preventDefault(),event.stopPropagation(),undoDrawing(),!1}return(0,jsx_runtime.jsx)(StyledGroup,{x:cx,y:cy,role:"button",onKeyDown:function onKeyDown(event){switch(event.key){case"Enter":case" ":return onPointerDown(event);default:return!0}},onPointerDown,"aria-label":"Undo",focusable:"true",stroke:"black",strokeWidth:1.5,children:(0,jsx_runtime.jsx)(Tooltip.A,{label:"Undo",children:(0,jsx_runtime.jsx)("path",{d:"M24 12c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 6.628 5.372 12 12 12s12-5.372 12-12zM6 12l6-6v4.5h6v3h-6v4.5l-6-6z",transform:undoTransform,fill:"black",stroke:"white",strokeWidth:.5})})})}UndoButton.propTypes={x:prop_types.number,y:prop_types.number,undoDrawing:prop_types.func};const UndoButton_UndoButton=UndoButton;UndoButton.__docgenInfo={description:"",methods:[],displayName:"UndoButton",props:{x:{description:"x position of the vertex closets to the origin",type:{name:"custom",raw:"number"},required:!1},y:{description:"y position of the vertex closets to the origin",type:{name:"custom",raw:"number"},required:!1},undoDrawing:{description:"Callback to shorten path array",type:{name:"custom",raw:"func"},required:!1}}}},"./src/plugins/drawingTools/components/draggable/draggable.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,U:()=>convertEvent});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_shared_SVGContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/plugins/drawingTools/shared/SVGContext.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var _excluded=["children","coords","dragStart","dragMove","dragEnd","onPointerDown","onPointerMove","onPointerUp"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function getEventOffset(event,canvas){var svgPoint=function createPoint(event){var clientX=event.clientX,clientY=event.clientY;return window.DOMPointReadOnly?new DOMPointReadOnly(clientX,clientY):{x:clientX,y:clientY}}(event),ctm=null==canvas?void 0:canvas.getScreenCTM();return ctm&&svgPoint.matrixTransform?svgPoint.matrixTransform(ctm.inverse()):svgPoint}function convertEvent(event,canvas){var svgEventOffset=getEventOffset(event,canvas);return{type:event.type,x:svgEventOffset.x,y:svgEventOffset.y}}var DEFAULT_COORDS={x:0,y:0},DEFAULT_HANDLER=function DEFAULT_HANDLER(event){return!0};const __WEBPACK_DEFAULT_EXPORT__=function draggable(WrappedComponent){function DraggableWithRef(_ref,ref){var children=_ref.children,_ref$coords=_ref.coords,initialCoords=void 0===_ref$coords?DEFAULT_COORDS:_ref$coords,_ref$dragStart=_ref.dragStart,dragStart=void 0===_ref$dragStart?DEFAULT_HANDLER:_ref$dragStart,_ref$dragMove=_ref.dragMove,dragMove=void 0===_ref$dragMove?DEFAULT_HANDLER:_ref$dragMove,_ref$dragEnd=_ref.dragEnd,dragEnd=void 0===_ref$dragEnd?DEFAULT_HANDLER:_ref$dragEnd,onPointerDown=_ref.onPointerDown,onPointerMove=_ref.onPointerMove,onPointerUp=_ref.onPointerUp,rest=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),canvas=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_shared_SVGContext__WEBPACK_IMPORTED_MODULE_1__.A).canvas,wrappedComponent=ref||(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),dragging=_useState2[0],setDragging=_useState2[1],coords=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(initialCoords),pointerId=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(-1);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("g",{onPointerDown:function onDragStart(event){var _wrappedComponent$cur;event.stopPropagation(),event.preventDefault();var _convertEvent=convertEvent(event,canvas),x=_convertEvent.x,y=_convertEvent.y;coords.current={x,y},setDragging(!0),pointerId.current=event.pointerId,dragStart({x,y,pointerId:event.pointerId}),null==onPointerDown||onPointerDown(event),null===(_wrappedComponent$cur=wrappedComponent.current)||void 0===_wrappedComponent$cur||_wrappedComponent$cur.setPointerCapture(event.pointerId)},onPointerMove:function onDragMove(event){if(dragging&&event.pointerId===pointerId.current){var _convertEvent2=convertEvent(event,canvas),x=_convertEvent2.x,y=_convertEvent2.y,currentTarget=event.currentTarget,difference={x:x-coords.current.x,y:y-coords.current.y};dragMove({currentTarget,x,y,pointerId:event.pointerId},difference),coords.current={x,y}}null==onPointerMove||onPointerMove(event)},onPointerUp:function onDragEnd(event){var _convertEvent3=convertEvent(event,canvas),x=_convertEvent3.x,y=_convertEvent3.y,currentTarget=event.currentTarget;event.pointerId===pointerId.current&&dragEnd({currentTarget,x,y,pointerId:event.pointerId}),coords.current={x:null,y:null},setDragging(!1),pointerId.current=-1,null==onPointerUp||onPointerUp(event)},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(WrappedComponent,_objectSpread(_objectSpread({ref:wrappedComponent},rest),{},{dragging,children}))})}var Draggable=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(DraggableWithRef),name=WrappedComponent.displayName||WrappedComponent.name||WrappedComponent.render&&WrappedComponent.render.name||WrappedComponent.toString();return Draggable.displayName="draggable(".concat(name,")"),Draggable.wrappedComponent=WrappedComponent,Draggable}},"./src/plugins/drawingTools/components/draggable/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>_draggable__WEBPACK_IMPORTED_MODULE_0__.A});var _draggable__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/plugins/drawingTools/components/draggable/draggable.jsx")},"./src/plugins/drawingTools/components/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{jl:()=>Circle.A,et:()=>DeleteButton_DeleteButton,tk:()=>DragHandle.A,Pp:()=>Ellipse.A,_6:()=>FreehandLine.A,N1:()=>Line.A,CU:()=>Mark.Ay,bR:()=>Point.A,tS:()=>Polygon.A,M_:()=>Rectangle.A,ZT:()=>RotateRectangle_RotateRectangle,Xj:()=>TranscriptionLine.A,kZ:()=>draggable.A});var Circle=__webpack_require__("./src/plugins/drawingTools/components/Circle/index.js"),draggable=__webpack_require__("./src/plugins/drawingTools/components/draggable/index.js"),DragHandle=__webpack_require__("./src/plugins/drawingTools/components/DragHandle/index.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),useScale=__webpack_require__("./src/plugins/drawingTools/hooks/useScale.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledGroup=(0,styled_components_browser_esm.default)("g").withConfig({displayName:"DeleteButton__StyledGroup",componentId:"sc-1e3q3b4-0"})(["&:focus{","}&:hover{cursor:pointer;}"],function(props){return(0,styled_components_browser_esm.css)(["outline:solid 4px ",";"],props.focusColor)}),DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1},DEFAULT_THEME={global:{colors:{}}};function DeleteButton(_ref){var _window,label=_ref.label,mark=_ref.mark,_ref$onDelete=_ref.onDelete,onDelete=void 0===_ref$onDelete?DEFAULT_HANDLER:_ref$onDelete,_ref$onDeselect=_ref.onDeselect,onDeselect=void 0===_ref$onDeselect?DEFAULT_HANDLER:_ref$onDeselect,_ref$rotate=_ref.rotate,rotate=void 0===_ref$rotate?0:_ref$rotate,_ref$theme=_ref.theme,theme=void 0===_ref$theme?DEFAULT_THEME:_ref$theme,scale=(0,useScale.A)(),focusColor=theme.global.colors[theme.global.colors.focus],RADIUS=(null===(_window=window)||void 0===_window?void 0:_window.innerWidth)<900?5:8,CROSS_PATH="\n    M ".concat(-1*RADIUS*.7," 0\n    L ").concat(.7*RADIUS," 0\n    M 0 ").concat(-1*RADIUS*.7,"\n    L 0 ").concat(.7*RADIUS,"\n  "),_mark$deleteButtonPos=mark.deleteButtonPosition(scale),x=_mark$deleteButtonPos.x,y=_mark$deleteButtonPos.y,transform="\n    translate(".concat(x,", ").concat(y,")\n    rotate(").concat(rotate,")\n    scale(").concat(1/scale,")\n  ");function onPointerDown(event){return event.preventDefault(),event.stopPropagation(),onDelete(),!1}return(0,jsx_runtime.jsxs)(StyledGroup,{"aria-label":label,focusable:!0,focusColor,onBlur:onDeselect,onKeyDown:function onKeyDown(event){switch(event.key){case"Enter":case" ":return onPointerDown(event);default:return!0}},onPointerDown,role:"button",stroke:"white",strokeWidth:1.5,tabIndex:"-1",transform,children:[(0,jsx_runtime.jsx)("circle",{fill:"black",r:RADIUS}),(0,jsx_runtime.jsx)("path",{d:CROSS_PATH,transform:"rotate(45)"})]})}DeleteButton.propTypes={label:prop_types_default().string.isRequired,mark:prop_types_default().object.isRequired,onDelete:prop_types_default().func,onDeselect:prop_types_default().func,rotate:prop_types_default().number,theme:prop_types_default().object};const DeleteButton_DeleteButton=(0,styled_components_browser_esm.withTheme)((0,mobxreact_esm.PA)(DeleteButton));DeleteButton.__docgenInfo={description:"",methods:[],displayName:"DeleteButton",props:{onDelete:{defaultValue:{value:"() => false",computed:!1},description:"",type:{name:"func"},required:!1},onDeselect:{defaultValue:{value:"() => false",computed:!1},description:"",type:{name:"func"},required:!1},rotate:{defaultValue:{value:"0",computed:!1},description:"",type:{name:"number"},required:!1},theme:{defaultValue:{value:"{\n  global: {\n    colors: {}\n  }\n}",computed:!1},description:"",type:{name:"object"},required:!1},label:{description:"",type:{name:"string"},required:!0},mark:{description:"",type:{name:"object"},required:!0}}};var Ellipse=__webpack_require__("./src/plugins/drawingTools/components/Ellipse/index.js"),Line=__webpack_require__("./src/plugins/drawingTools/components/Line/index.js"),Mark=__webpack_require__("./src/plugins/drawingTools/components/Mark/Mark.jsx"),Point=__webpack_require__("./src/plugins/drawingTools/components/Point/index.js"),Polygon=__webpack_require__("./src/plugins/drawingTools/components/Polygon/index.js"),Rectangle=__webpack_require__("./src/plugins/drawingTools/components/Rectangle/index.js"),react=__webpack_require__("../../node_modules/react/index.js"),i18n=__webpack_require__("./src/translations/i18n.jsx"),RotateHandle=(0,react.forwardRef)(function RotateHandle(_ref,ref){var _ref$fill=_ref.fill,fill=void 0===_ref$fill?"currentColor":_ref$fill,x=_ref.x,y=_ref.y,scale=(0,useScale.A)(),t=(0,i18n.Bd)("components").t,transform="translate(".concat(x,", ").concat(y,") scale(").concat(1/scale,")");return(0,jsx_runtime.jsx)("g",{ref,transform,children:(0,jsx_runtime.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0",y:"-12",height:"24px",width:"24px",viewBox:"0 0 24 24",fill,strokeWidth:"0.5",role:"img","aria-label":t("DrawingTools.RotateHandle"),children:[(0,jsx_runtime.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"transparent",stroke:"transparent"}),(0,jsx_runtime.jsx)("path",{d:"M15.55 5.55L11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10l4.55-4.45zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47h2.02zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03zm3.89-2.42l1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48z"})]})})});RotateHandle.propTypes={fill:prop_types.string,x:prop_types.number.isRequired,y:prop_types.number.isRequired};const RotateHandle_RotateHandle=(0,draggable.A)(RotateHandle);RotateHandle.__docgenInfo={description:"",methods:[],displayName:"RotateHandle",props:{fill:{defaultValue:{value:"'currentColor'",computed:!1},description:"The RotateHandle color",type:{name:"custom",raw:"string"},required:!1},x:{description:"x position of the vertex closets to the origin before rotation",type:{name:"number"},required:!0},y:{description:"y position of the vertex closets to the origin before rotation",type:{name:"number"},required:!0}}};var GUIDE_DASH=[4,4];function RotateRectangle(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,mark=_ref.mark,_ref$onFinish=_ref.onFinish,onFinish=void 0===_ref$onFinish?function(){return!0}:_ref$onFinish,height=(mark.angle,mark.height),width=mark.width,x_center=mark.x_center,y_center=mark.y_center,x_left=x_center-width/2,x_right=x_center+width/2,y_top=y_center-height/2,y_bottom=y_center+height/2,xRotationHandle=x_center+width/2+32;function onHandleDrag(coords){mark.resizeByCorner(coords)}return(0,jsx_runtime.jsxs)("g",{onPointerUp:active?onFinish:void 0,children:[(0,jsx_runtime.jsx)("rect",{x:x_left,y:y_top,width,height,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("rect",{x:x_left,y:y_top,width,height,strokeWidth:6,strokeOpacity:"0",vectorEffect:"non-scaling-stroke"}),active&&(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)("line",{x1:x_center,y1:y_center,x2:xRotationHandle,y2:y_center,strokeWidth:1,strokeDasharray:GUIDE_DASH,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)(RotateHandle_RotateHandle,{dragMove:function onRotateDrag(e){var angle=mark.getAngle(x_center,y_center,e.x,e.y);mark.setCoordinates({x_left,x_right,y_top,y_bottom,angle})},x:xRotationHandle,y:y_center})]}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_left,y:y_top,dragMove:function dragMove(e,d){return onHandleDrag({dx:d.x,dy:d.y,corner:"top left"})}}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_right,y:y_top,dragMove:function dragMove(e,d){return onHandleDrag({dx:d.x,dy:d.y,corner:"top right"})}}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_right,y:y_bottom,dragMove:function dragMove(e,d){return onHandleDrag({dx:d.x,dy:d.y,corner:"bottom right"})}}),active&&(0,jsx_runtime.jsx)(DragHandle.A,{x:x_left,y:y_bottom,dragMove:function dragMove(e,d){return onHandleDrag({dx:d.x,dy:d.y,corner:"bottom left"})}})]})}RotateRectangle.propTypes={active:prop_types_default().bool,mark:prop_types_default().shape({angle:prop_types_default().number,height:prop_types_default().number,width:prop_types_default().number,x_center:prop_types_default().number,y_center:prop_types_default().number}).isRequired,onFinish:prop_types_default().func};const RotateRectangle_RotateRectangle=(0,mobxreact_esm.PA)(RotateRectangle);RotateRectangle.__docgenInfo={description:"",methods:[],displayName:"RotateRectangle",props:{active:{defaultValue:{value:"false",computed:!1},description:"Modal active state.",type:{name:"bool"},required:!1},onFinish:{defaultValue:{value:"() => true",computed:!1},description:"Callback to reset the drawing canvas when creation of the rectangle is finished.",type:{name:"func"},required:!1},mark:{description:"RotateRectangle data: { angle, height, width, x_center, y_center }",type:{name:"shape",value:{angle:{name:"number",required:!1},height:{name:"number",required:!1},width:{name:"number",required:!1},x_center:{name:"number",required:!1},y_center:{name:"number",required:!1}}},required:!0}}};__webpack_require__("./src/plugins/drawingTools/components/UndoButton/index.js");var FreehandLine=__webpack_require__("./src/plugins/drawingTools/experimental/components/FreehandLine/index.js"),TranscriptionLine=__webpack_require__("./src/plugins/drawingTools/experimental/components/TranscriptionLine/index.js")},"./src/plugins/drawingTools/experimental/components/FreehandLine/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>FreehandLine_FreehandLine});var react=__webpack_require__("../../node_modules/react/index.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),DragHandle=__webpack_require__("./src/plugins/drawingTools/components/DragHandle/index.js"),i18n=__webpack_require__("./src/translations/i18n.jsx"),useScale=__webpack_require__("./src/plugins/drawingTools/hooks/useScale.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _toArray(r){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var StyledGroup=styled_components_browser_esm.default.g.withConfig({displayName:"FreehandLine__StyledGroup",componentId:"sc-1qk822w-0"})(["stroke-width:2px;stroke-linecap:round;stroke-linejoin:round;&:hover{cursor:pointer;}&.editing{cursor:crosshair;g.extend{&:hover{cursor:crosshair !important;}circle:hover{cursor:grab !important;}}}"]);function createPoint(event){var clientX=event.clientX,clientY=event.clientY;if(window.DOMPointReadOnly){var _event$target,svgPoint=new DOMPointReadOnly(clientX,clientY),_ref=svgPoint.matrixTransform?svgPoint.matrixTransform(null===(_event$target=event.target)||void 0===_event$target?void 0:_event$target.getScreenCTM().inverse()):svgPoint;return{x:_ref.x,y:_ref.y}}return{x:clientX,y:clientY}}function cancelEvent(event){return event.preventDefault(),event.stopPropagation(),!1}function pointsToPath(points){if(0===points.length)return"";var _points=_toArray(points),firstPoint=_points[0],restPoints=_arrayLikeToArray(_points).slice(1),path=["M ".concat(firstPoint.x,",").concat(firstPoint.y)];return restPoints.forEach(function(point){path.push("L ".concat(point.x,",").concat(point.y))}),path.join(" ")}var DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function FreehandLine(_ref2){var _ref2$active=_ref2.active,active=void 0!==_ref2$active&&_ref2$active,mark=_ref2.mark,_ref2$onFinish=_ref2.onFinish,onFinish=void 0===_ref2$onFinish?DEFAULT_HANDLER:_ref2$onFinish,scale=(0,useScale.A)();function onDoubleClick(event){return active&&mark.splicePathDragPoint(createPoint(event)),cancelEvent(event)}function onPointerDown(event){if(active)return mark.splicePathClosePoint(createPoint(event)),cancelEvent(event)}!1===active&&mark.inactive(),mark.setScale(scale);var t=(0,i18n.Bd)("plugins").t;return(0,jsx_runtime.jsxs)(StyledGroup,{"data-testid":"mark-focusable",className:active?"editing":void 0,onPointerUp:active?onFinish:void 0,children:[mark.visiblePathsRender.map(function(pts,i){return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)("path",{d:pointsToPath(pts),fill:"none",strokeOpacity:1,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("title",{children:active?mark.spliceDragPointIndex&&mark.spliceClosePointIndex?t("FreehandLine.spliceDrag"):mark.spliceDragPointIndex&&!mark.spliceClosePointIndex?t("FreehandLine.closePoint"):mark.pathIsClosed&&!mark.spliceDragPointIndex?t("FreehandLine.splicePoint"):t("FreehandLine.active"):t("FreehandLine.inactive")}),(0,jsx_runtime.jsx)("path",{d:pointsToPath(pts),onDoubleClick,onPointerDown,fill:"none",strokeWidth:10,strokeOpacity:0,vectorEffect:"non-scaling-stroke"})]},i)}),(0,jsx_runtime.jsx)("path",{d:pointsToPath(mark.splicePathRender),strokeDasharray:"2 2",opacity:".4",vectorEffect:"non-scaling-stroke"}),active&&mark.closePoint&&(0,jsx_runtime.jsx)("circle",{fill:"currentColor",r:4/scale,cx:mark.closePoint.x,cy:mark.closePoint.y,vectorEffect:"non-scaling-stroke"}),active&&mark.dragPoint&&(0,jsx_runtime.jsx)(DragHandle.A,{"data-testid":"freehandline-drag-handle",x:mark.dragPoint.x,y:mark.dragPoint.y,fill:"none",invisibleWhenDragging:!0,dragStart:mark.appendPathStart,dragMove:mark.appendPath,dragEnd:mark.appendPathEnd,className:"extend"})]})}FreehandLine.propTypes={active:prop_types_default().bool,mark:prop_types_default().shape({path:prop_types_default().string,initialPoint:prop_types_default().shape({x:prop_types_default().number,y:prop_types_default().number}),lastPoint:prop_types_default().shape({x:prop_types_default().number,y:prop_types_default().number}),finished:prop_types_default().bool,isCloseToStart:prop_types_default().bool}).isRequired,onFinish:prop_types_default().func};const FreehandLine_FreehandLine=(0,mobxreact_esm.PA)(FreehandLine);FreehandLine.__docgenInfo={description:"",methods:[],displayName:"FreehandLine",props:{active:{defaultValue:{value:"false",computed:!1},description:"Modal active state.",type:{name:"bool"},required:!1},onFinish:{defaultValue:{value:"() => true",computed:!1},description:"Callback to reset the drawing canvas when creation of the line is finished.",type:{name:"func"},required:!1},mark:{description:"FreehandLine data: { path, initialPoint, lastPoint, finished, isCloseToStart }",type:{name:"shape",value:{path:{name:"string",required:!1},initialPoint:{name:"shape",value:{x:{name:"number",required:!1},y:{name:"number",required:!1}},required:!1},lastPoint:{name:"shape",value:{x:{name:"number",required:!1},y:{name:"number",required:!1}},required:!1},finished:{name:"bool",required:!1},isCloseToStart:{name:"bool",required:!1}}},required:!0}}}},"./src/plugins/drawingTools/experimental/components/TranscriptionLine/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>TranscriptionLine_TranscriptionLine});var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("../../node_modules/react/index.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),Tooltip=__webpack_require__("../lib-react-components/dist/esm/Tooltip/Tooltip.js"),i18n=__webpack_require__("./src/translations/i18n.jsx"),Blank=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Blank.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function TooltipIcon(_ref){var fill=_ref.fill;return(0,jsx_runtime.jsx)(Blank.h,{color:fill,children:(0,jsx_runtime.jsx)("circle",{cx:"12",cy:"12",r:"6"})})}TooltipIcon.propTypes={fill:prop_types.string},TooltipIcon.__docgenInfo={description:"",methods:[],displayName:"TooltipIcon",props:{fill:{description:"",type:{name:"custom",raw:"string"},required:!1}}};var components=__webpack_require__("./src/plugins/drawingTools/components/index.js"),useScale=__webpack_require__("./src/plugins/drawingTools/hooks/useScale.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var _excluded=["fill","r","transform"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Circle=function Circle(_ref){var fill=_ref.fill,r=_ref.r,transform=_ref.transform,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded);return(0,jsx_runtime.jsx)("g",{transform,children:(0,jsx_runtime.jsx)("circle",_objectSpread({fill,r,stroke:"currentColor",vectorEffect:"non-scaling-stroke"},props))})},TranscriptionLineMark=(0,react.forwardRef)(function(_ref2,ref){var _window,active=_ref2.active,color=_ref2.color,handleFinishClick=_ref2.handleFinishClick,handlePointerDown=_ref2.handlePointerDown,mark=_ref2.mark,onHandleDrag=_ref2.onHandleDrag,HANDLE_RADIUS=(null===(_window=window)||void 0===_window?void 0:_window.innerWidth)<900?3:5,scale=(0,useScale.A)(),finished=mark.finished,x1=mark.x1,x2=mark.x2,y1=mark.y1,y2=mark.y2,offsetX=0,offsetY=0;if(mark.length){var deltaY=y2-y1;offsetX=(x2-x1)*(HANDLE_RADIUS/mark.length)/scale,offsetY=deltaY*(HANDLE_RADIUS/mark.length)/scale}return(0,jsx_runtime.jsxs)("g",{color,fill:color,ref,stroke:color,children:[(0,jsx_runtime.jsx)("line",{x1:x1+offsetX,y1:y1+offsetY,x2,y2,strokeWidth:2,vectorEffect:"non-scaling-stroke"}),(0,jsx_runtime.jsx)("line",{x1,y1,x2,y2,strokeWidth:12,strokeOpacity:"0",vectorEffect:"non-scaling-stroke"}),active?(0,jsx_runtime.jsx)(components.tk,{fill:"transparent",radius:HANDLE_RADIUS,x:x1,y:y1,dragMove:function onDragStartPoint(e,d){onHandleDrag({x1:x1+d.x,y1:y1+d.y,x2,y2})}}):(0,jsx_runtime.jsx)(Circle,{fill:"transparent",r:HANDLE_RADIUS,transform:"translate(".concat(x1,", ").concat(y1,") scale(").concat(1/scale,")")}),active?(0,jsx_runtime.jsx)(components.tk,{radius:HANDLE_RADIUS,x:x2,y:y2,dragMove:function onDragEndPoint(e,d){onHandleDrag({x1,y1,x2:x2+d.x,y2:y2+d.y})}}):(0,jsx_runtime.jsx)(Circle,{fill:"currentColor",r:HANDLE_RADIUS,transform:"translate(".concat(x2,", ").concat(y2,") scale(").concat(1/scale,")")}),active&&!finished&&(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)(Circle,{className:"startPoint",r:HANDLE_RADIUS,transform:"translate(".concat(x1,", ").concat(y1,") scale(").concat(1/scale,")"),onPointerDown:handlePointerDown,onPointerUp:handleFinishClick}),(0,jsx_runtime.jsx)(Circle,{className:"endPoint",r:HANDLE_RADIUS,transform:"translate(".concat(x2,", ").concat(y2,") scale(").concat(1/scale,")"),onPointerDown:handlePointerDown,onPointerUp:handleFinishClick})]})]})});TranscriptionLineMark.propTypes={active:prop_types_default().bool,color:prop_types_default().string,handleFinishClick:prop_types_default().func,handlePointerDown:prop_types_default().func,mark:prop_types_default().object.isRequired,onHandleDrag:prop_types_default().func,scale:prop_types_default().number};const TranscriptionLineMark_TranscriptionLineMark=(0,mobxreact_esm.PA)(TranscriptionLineMark);function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}TranscriptionLineMark.__docgenInfo={description:"",methods:[],displayName:"TranscriptionLineMark",props:{active:{description:"",type:{name:"bool"},required:!1},color:{description:"",type:{name:"string"},required:!1},handleFinishClick:{description:"",type:{name:"func"},required:!1},handlePointerDown:{description:"",type:{name:"func"},required:!1},mark:{description:"",type:{name:"object"},required:!0},onHandleDrag:{description:"",type:{name:"func"},required:!1},scale:{description:"",type:{name:"number"},required:!1}}};var DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function TranscriptionLine(_ref){var _ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,_ref$color=_ref.color,color=void 0===_ref$color?"":_ref$color,mark=_ref.mark,_ref$onFinish=_ref.onFinish,onFinish=void 0===_ref$onFinish?DEFAULT_HANDLER:_ref$onFinish,_ref$state=_ref.state,state=void 0===_ref$state?"":_ref$state,transcriptionTaskColors={},stores=(0,react.useContext)(mobxreact_esm.Db),theme=(0,react.useContext)(styled_components_browser_esm.ThemeContext),_useState2=_slicedToArray((0,react.useState)(!1),2),allowFinish=_useState2[0],setAllowFinish=_useState2[1],usesTranscriptionTask=function storeMapper(stores){var _stores$classifierSto;return(null===(_stores$classifierSto=stores.classifierStore.workflows.active)||void 0===_stores$classifierSto?void 0:_stores$classifierSto.usesTranscriptionTask)||!1}(stores),t=(0,i18n.Bd)("plugins").t;theme&&(transcriptionTaskColors={active:theme.global.colors.drawingTools.green,default:theme.global.colors.drawingTools.blue,transcribed:theme.global.colors.drawingTools.pink,complete:theme.global.colors["light-5"]});var lineState=state||"default";active&&(lineState="active");var colorToRender=usesTranscriptionTask?transcriptionTaskColors[lineState]:color;function onHandleDrag(coords){mark.setCoordinates(coords)}function handlePointerDown(event){event.stopPropagation(),event.preventDefault(),setAllowFinish(!0)}function handleFinishClick(event){allowFinish&&(mark.finish(),onFinish(event))}if(usesTranscriptionTask&&"active"===lineState||"default"===lineState){var tooltipLabel=t("active"===lineState?"TranscriptionLine.editing":"TranscriptionLine.created");return(0,jsx_runtime.jsx)(Tooltip.A,{icon:(0,jsx_runtime.jsx)(TooltipIcon,{fill:colorToRender}),label:tooltipLabel,children:(0,jsx_runtime.jsx)(TranscriptionLineMark_TranscriptionLineMark,{active,color:colorToRender,handlePointerDown,handleFinishClick,mark,onHandleDrag})})}return(0,jsx_runtime.jsx)(TranscriptionLineMark_TranscriptionLineMark,{active,color:colorToRender,handlePointerDown,handleFinishClick,mark,onHandleDrag})}TranscriptionLine.propTypes={active:prop_types_default().bool,color:prop_types_default().string,mark:prop_types_default().object.isRequired,onFinish:prop_types_default().func,state:prop_types_default().string};const TranscriptionLine_TranscriptionLine=TranscriptionLine;TranscriptionLine.__docgenInfo={description:"",methods:[],displayName:"TranscriptionLine",props:{active:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},color:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},onFinish:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},state:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},mark:{description:"",type:{name:"object"},required:!0}}}},"./src/plugins/drawingTools/hooks/useScale.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>useScale});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_shared_SVGContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/plugins/drawingTools/shared/SVGContext.js");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function getScale(svgContext){var canvas=svgContext.canvas,_svgContext$rotate=svgContext.rotate,rotate=void 0===_svgContext$rotate?0:_svgContext$rotate;if(null!=canvas&&canvas.getBBox){var _canvas$getBoundingCl=canvas.getBoundingClientRect(),clientWidth=_canvas$getBoundingCl.width,clientHeight=_canvas$getBoundingCl.height,actualWidth=canvas.getBBox().width,scale=rotate%180==0?clientWidth/actualWidth:clientHeight/actualWidth;return Number.isNaN(scale)?1:scale}return 1}function useScale(){var _useContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_shared_SVGContext__WEBPACK_IMPORTED_MODULE_1__.A),canvas=_useContext.canvas,_useContext$rotate=_useContext.rotate,rotate=void 0===_useContext$rotate?0:_useContext$rotate,initialScale=getScale({canvas,rotate}),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialScale),2),scale=_useState2[0],setScale=_useState2[1];return setTimeout(function(){if(canvas){var newScale=getScale({canvas,rotate});newScale!==scale&&setScale(newScale)}}),scale}},"./src/plugins/drawingTools/models/marks/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Circle:()=>Circle_Circle,Ellipse:()=>Ellipse_Ellipse,FreehandLine:()=>FreehandLine_FreehandLine,Line:()=>Line_Line,Mark:()=>Mark,Point:()=>Point_Point,Polygon:()=>Polygon_Polygon,Rectangle:()=>Rectangle_Rectangle,RotateRectangle:()=>RotateRectangle_RotateRectangle,TemporalPoint:()=>TemporalPoint_TemporalPoint,TemporalRotateRectangle:()=>TemporalRotateRectangle_TemporalRotateRectangle,TranscriptionLine:()=>TranscriptionLine_TranscriptionLine});var mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),components=__webpack_require__("./src/plugins/drawingTools/components/index.js"),tools=__webpack_require__("./src/plugins/drawingTools/models/tools/index.js"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),single=__webpack_require__("./src/plugins/tasks/single/index.js"),multiple=__webpack_require__("./src/plugins/tasks/multiple/index.js"),tasks_text=__webpack_require__("./src/plugins/tasks/text/index.js"),dropdown_simple=__webpack_require__("./src/plugins/tasks/dropdown-simple/index.js"),AnnotationsStore=__webpack_require__("./src/store/AnnotationsStore.js"),BaseMark=mobx_state_tree_module.gK.model("BaseMark",{id:mobx_state_tree_module.gK.identifier,annotations:mobx_state_tree_module.gK.map(mobx_state_tree_module.gK.union(single.A.AnnotationModel,multiple.A.AnnotationModel,tasks_text.A.AnnotationModel,dropdown_simple.A.AnnotationModel)),frame:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),subTaskPreviousAnnotationValues:mobx_state_tree_module.gK.map(tasks_text.A.PreviousAnnotationValuesModel),toolIndex:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),toolType:mobx_state_tree_module.gK.string}).preProcessSnapshot(function(snapshot){var newSnapshot=Object.assign({},snapshot);if(newSnapshot.id=snapshot.id||cuid_default()(),snapshot.annotations&&Array.isArray(snapshot.annotations)){var annotations={};snapshot.annotations.forEach(function(annotation){annotation.id=annotation.id||cuid_default()(),annotations[annotation.id]=annotation}),newSnapshot.annotations=annotations}return newSnapshot}).postProcessSnapshot(function(snapshot){var newSnapshot=Object.assign({},snapshot);return delete newSnapshot.id,delete newSnapshot.subTaskPreviousAnnotationValues,newSnapshot.annotations=Object.values(snapshot.annotations),newSnapshot}).volatile(function(self){return{finished:!1,subTaskMarkBounds:void 0,subTaskVisibility:!1}}).views(function(self){return{getAngle:function getAngle(x1,y1,x2,y2){var deltaX=x2-x1,deltaY=y2-y1;return Math.atan2(deltaY,deltaX)*(180/Math.PI)},getDistance:function getDistance(x1,y1,x2,y2){var aSquared=Math.pow(x2-x1,2),bSquared=Math.pow(y2-y1,2);return Math.sqrt(aSquared+bSquared)},get element(){return document.getElementById("mark-".concat(self.id))},get isComplete(){return!self.tasks.some(function(task){var taskAnnotation=self.annotation(task);return task.required&&!(null!=taskAnnotation&&taskAnnotation.isComplete)})},get isValid(){return!0},get tool(){return(0,mobx_state_tree_module.PA)(self,2)},get tasks(){return self.tool.tasks},get videoTime(){}}}).actions(function(self){return{finish:function finish(){self.finished=!0,self.isValid||self.tool.deleteMark(self)},setPreviousAnnotations:function setPreviousAnnotations(previousAnnotationValues){(null==previousAnnotationValues?void 0:previousAnnotationValues.length)>0?previousAnnotationValues.forEach(function(previousAnnotationValue){self.subTaskPreviousAnnotationValues.put(previousAnnotationValue)}):self.subTaskPreviousAnnotationValues.clear()},setSubTaskVisibility:function setSubTaskVisibility(visibility,markBounds){self.tasks.length>0&&(self.subTaskVisibility=visibility,self.subTaskMarkBounds=markBounds)},setVideoTime:function setVideoTime(displayTime){}}});const Mark=mobx_state_tree_module.gK.compose("Mark",AnnotationsStore.A,BaseMark);var CircleModel=mobx_state_tree_module.gK.model("CircleModel",{x_center:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y_center:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),r:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0)}).views(function(self){return{get coords(){return{x:self.x_center,y:self.y_center}},deleteButtonPosition:function deleteButtonPosition(scale){var theta=Math.PI/180*-45;return{x:(self.r+12)*Math.cos(theta),y:(self.r+12)*Math.sin(theta)}},get isValid(){return self.r>=5},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.CircleTool)},get toolComponent(){return components.jl},get x(){return self.x_center},get y(){return self.y_center}}}).actions(function(self){return{initialDrag:function initialDrag(_ref){var x=_ref.x,y=_ref.y;self.r=self.getDistance(self.x_center,self.y_center,x,y)},initialPosition:function initialPosition(_ref2){var x=_ref2.x,y=_ref2.y;self.x_center=x,self.y_center=y},move:function move(_ref3){var x=_ref3.x,y=_ref3.y;self.x_center+=x,self.y_center+=y},setCoordinates:function setCoordinates(_ref4){var x=_ref4.x,y=_ref4.y,r=_ref4.r;self.x_center=x,self.y_center=y,self.r=r}}});const Circle_Circle=mobx_state_tree_module.gK.compose("Circle",Mark,CircleModel);var EllipseModel=mobx_state_tree_module.gK.model("EllipseModel",{x_center:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y_center:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),rx:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),ry:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),angle:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0)}).volatile(function(self){return{dragging:!1}}).views(function(self){return{get coords(){return{x:self.x_center,y:self.y_center}},deleteButtonPosition:function deleteButtonPosition(scale){var theta=Math.PI/180*-45;return{x:(self.rx+24)*Math.cos(theta),y:(self.ry+24)*Math.sin(theta)}},get isValid(){return self.rx-5>0},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.EllipseTool)},get toolComponent(){return components.Pp},get x(){return self.x_center},get y(){return self.y_center}}}).actions(function(self){return{initialDrag:function initialDrag(_ref){var x=_ref.x,y=_ref.y;if(self.dragging){var rx=self.getDistance(self.x_center,self.y_center,x,y),angle=self.getAngle(self.x_center,self.y_center,x,y);self.rx=rx,self.ry=1e-4*rx,self.angle=angle}},initialPosition:function initialPosition(_ref2){var x=_ref2.x,y=_ref2.y;self.x_center=x,self.y_center=y,self.dragging=!0},move:function move(_ref3){var x=_ref3.x,y=_ref3.y;self.x_center+=x,self.y_center+=y},setCoordinates:function setCoordinates(_ref4){var x=_ref4.x,y=_ref4.y,rx=_ref4.rx,ry=_ref4.ry,angle=_ref4.angle;self.x_center=x,self.y_center=y,self.rx=rx,self.ry=ry,self.angle=angle},setDragging:function setDragging(dragging){self.dragging=dragging}}});const Ellipse_Ellipse=mobx_state_tree_module.gK.compose("Ellipse",Mark,EllipseModel);var LineModel=mobx_state_tree_module.gK.model("LineModel",{x1:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y1:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),x2:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y2:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number)}).views(function(self){return{get coords(){return{x:self.x1,y:self.y1}},deleteButtonPosition:function deleteButtonPosition(scale){return{x:self.x1>self.x2?self.x1+16/scale:self.x1-16/scale,y:self.y1}},get length(){var x1=self.x1,y1=self.y1,x2=self.x2,y2=self.y2;return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))},get isValid(){return self.length-5>0},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.LineTool)},get toolComponent(){return components.N1}}}).actions(function(self){return{initialDrag:function initialDrag(_ref){var x=_ref.x,y=_ref.y;self.x2=x,self.y2=y},initialPosition:function initialPosition(_ref2){var x=_ref2.x,y=_ref2.y;self.x1=x,self.y1=y,self.x2=x,self.y2=y},move:function move(_ref3){var x=_ref3.x,y=_ref3.y;self.x1+=x,self.x2+=x,self.y1+=y,self.y2+=y},setCoordinates:function setCoordinates(_ref4){var x1=_ref4.x1,y1=_ref4.y1,x2=_ref4.x2,y2=_ref4.y2;self.x1=x1,self.y1=y1,self.x2=x2,self.y2=y2}}});const Line_Line=mobx_state_tree_module.gK.compose("Line",Mark,LineModel);var PointModel=mobx_state_tree_module.gK.model("PointModel",{x:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),y:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0)}).views(function(self){return{get coords(){return{x:self.x,y:self.y}},deleteButtonPosition:function deleteButtonPosition(scale){var theta=Math.PI/180*45;return{x:20/scale*Math.cos(theta),y:20/scale*-1*Math.sin(theta)}},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.PointTool)},get toolComponent(){return components.bR}}}).actions(function(self){return{initialDrag:function initialDrag(_ref){var x=_ref.x,y=_ref.y;self.x=x,self.y=y},initialPosition:function initialPosition(_ref2){var x=_ref2.x,y=_ref2.y;self.x=x,self.y=y},move:function move(_ref3){var x=_ref3.x,y=_ref3.y;self.x+=x,self.y+=y},setCoordinates:function setCoordinates(_ref4){var x=_ref4.x,y=_ref4.y;self.x=x,self.y=y}}});const Point_Point=mobx_state_tree_module.gK.compose("Point",Mark,PointModel),FixedNumber=mobx_state_tree_module.gK.custom({name:"FixedNumber",fromSnapshot:function fromSnapshot(snapshot){var roundedString=parseFloat(snapshot).toFixed(2);return parseFloat(roundedString)},toSnapshot:function toSnapshot(value){var roundedString=parseFloat(value).toFixed(2);return parseFloat(roundedString)},isTargetType:function isTargetType(value){var roundedValue=parseFloat(value).toFixed(2);return value===parseFloat(roundedValue)},getValidationMessage:function getValidationMessage(snapshot){var value=parseFloat(snapshot);return isNaN(value)?"".concat(snapshot," is not a number"):""}});function _toArray(r){return _arrayWithHoles(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||_unsupportedIterableToArray(r)||_nonIterableRest()}function _slicedToArray(r,e){return _arrayWithHoles(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _arrayWithHoles(r){if(Array.isArray(r))return r}var SingleCoord=mobx_state_tree_module.gK.model({x:FixedNumber,y:FixedNumber}).actions(function(self){return{moveTo:function moveTo(_ref){var x=_ref.x,y=_ref.y;self.x=x,self.y=y}}}),PolygonModel=mobx_state_tree_module.gK.model("PolygonModel",{points:mobx_state_tree_module.gK.array(SingleCoord)}).volatile(function(){return{guideLineX:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),guideLineY:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number)}}).views(function(self){return{get coords(){var _self$initialPoint,_self$initialPoint2;return{x:null===(_self$initialPoint=self.initialPoint)||void 0===_self$initialPoint?void 0:_self$initialPoint.x,y:null===(_self$initialPoint2=self.initialPoint)||void 0===_self$initialPoint2?void 0:_self$initialPoint2.y}},deleteButtonPosition:function deleteButtonPosition(scale){return{x:self.points[0].x-16/scale,y:self.points[0].y-16/scale}},get isValid(){return self.points.length>=3},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.PolygonTool)},get initialPoint(){var firstCoord=_slicedToArray(self.points,1)[0];return firstCoord||null},get lastPoint(){var lastCoord=self.points[self.points.length-1];return lastCoord||null},get path(){var _self$points2=_toArray(self.points),firstCoord=_self$points2[0];_arrayLikeToArray(_self$points2).slice(1);return firstCoord?self.points.map(function(_ref2){var x=_ref2.x,y=_ref2.y;return"".concat(x,",").concat(y)}).join(" "):""},get toolComponent(){return components.tS}}}).actions(function(self){return{initialDrag:function initialDrag(_ref3){var x=_ref3.x,y=_ref3.y,newPoint=SingleCoord.create({x,y}),initialPoint=self.initialPoint;newPoint.x!==initialPoint.x&&newPoint.y!==initialPoint.y&&(self.points[1]=newPoint)},initialPosition:function initialPosition(_ref4){var x=_ref4.x,y=_ref4.y;self.points[0]={x,y}},move:function move(_ref5){var x=_ref5.x,y=_ref5.y;return self.points.map(function(coord){coord.x+=x,coord.y+=y})},setCoordinates:function setCoordinates(points){self.points=points},appendPath:function appendPath(_ref6){var x=_ref6.x,y=_ref6.y;self.points.push({x,y})},shortenPath:function shortenPath(){for(var lengthToRemove=1;lengthToRemove--;)self.points.pop()},setGuideLine:function setGuideLine(event){self.guideLineX=event.x,self.guideLineY=event.y}}});const Polygon_Polygon=mobx_state_tree_module.gK.compose("Polygon",Mark,PolygonModel);var RectangleModel=mobx_state_tree_module.gK.model("RectangleModel",{x_center:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y_center:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),width:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),height:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number)}).views(function(self){return{get coords(){return{x:self.x_center,y:self.y_center}},deleteButtonPosition:function deleteButtonPosition(scale){return{x:self.x_center+self.width/2+16/scale,y:self.y_center-self.height/2}},get isValid(){return self.width-5>0&&self.height-5>0},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.RectangleTool)},get toolComponent(){return components.M_}}}).actions(function(self){return{initialDrag:function initialDrag(_ref){var x=_ref.x,y=_ref.y,x_left=x<self.x_center?x:self.x_center-self.width/2,x_right=x>self.x_center?x:self.x_center+self.width/2,y_top=y<self.y_center?y:self.y_center-self.height/2,y_bottom=y>self.y_center?y:self.y_center+self.height/2;self.width=x_right-x_left,self.height=y_bottom-y_top,self.x_center=(x_left+x_right)/2,self.y_center=(y_top+y_bottom)/2},initialPosition:function initialPosition(_ref2){var x=_ref2.x,y=_ref2.y;self.x_center=x,self.y_center=y,self.width=0,self.height=0},move:function move(_ref3){var x=_ref3.x,y=_ref3.y;self.x_center+=x,self.y_center+=y},setCoordinates:function setCoordinates(_ref4){var x_left=_ref4.x_left,x_right=_ref4.x_right,y_top=_ref4.y_top,y_bottom=_ref4.y_bottom;self.x_center=(x_left+x_right)/2,self.y_center=(y_top+y_bottom)/2,self.width=Math.abs(x_right-x_left),self.height=Math.abs(y_bottom-y_top)}}});const Rectangle_Rectangle=mobx_state_tree_module.gK.compose("Rectangle",Mark,RectangleModel);var RotateRectangleModel=mobx_state_tree_module.gK.model("RotateRectangleModel",{angle:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0)}).views(function(self){return{get tool(){return(0,mobx_state_tree_module.k2)(self,tools.RotateRectangleTool)},get toolComponent(){return components.ZT},get x_rotate(){return self.x_center},get y_rotate(){return self.y_center}}}).actions(function(self){return{setCoordinates:function setCoordinates(_ref){var x_left=_ref.x_left,x_right=_ref.x_right,y_top=_ref.y_top,y_bottom=_ref.y_bottom,angle=_ref.angle;self.x_center=(x_left+x_right)/2,self.y_center=(y_top+y_bottom)/2,self.width=Math.abs(x_right-x_left),self.height=Math.abs(y_bottom-y_top),self.angle=angle},resizeByCorner:function resizeByCorner(_ref2){var _ref2$dx=_ref2.dx,dx=void 0===_ref2$dx?0:_ref2$dx,_ref2$dy=_ref2.dy,dy=void 0===_ref2$dy?0:_ref2$dy,_ref2$corner=_ref2.corner,corner=void 0===_ref2$corner?"":_ref2$corner;if((0!==dx||0!==dy)&&["top left","top right","bottom right","bottom left"].includes(corner)){var deltaAngle=Math.atan2(dy,dx),deltaDistance=Math.sqrt(dx*dx+dy*dy),transformedAngle=deltaAngle-self.angle*Math.PI/180,transformedDx=Math.cos(transformedAngle)*deltaDistance,transformedDy=Math.sin(transformedAngle)*deltaDistance;switch(corner){case"top left":self.width=Math.max(self.width-transformedDx,1),self.height=Math.max(self.height-transformedDy,1);break;case"top right":self.width=Math.max(self.width+transformedDx,1),self.height=Math.max(self.height-transformedDy,1);break;case"bottom right":self.width=Math.max(self.width+transformedDx,1),self.height=Math.max(self.height+transformedDy,1);break;case"bottom left":self.width=Math.max(self.width-transformedDx,1),self.height=Math.max(self.height+transformedDy,1)}self.x_center+=.5*dx,self.y_center+=.5*dy}}}});const RotateRectangle_RotateRectangle=mobx_state_tree_module.gK.compose("RotateRectangle",Rectangle_Rectangle,RotateRectangleModel);var formatTimeStamp=__webpack_require__("./src/helpers/formatTimeStamp/formatTimeStamp.js"),TemporalPointModel=mobx_state_tree_module.gK.model("TemporalPointModel",{displayTime:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),displayTimeStamp:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"")}).views(function(self){return{get tool(){return(0,mobx_state_tree_module.k2)(self,tools.TemporalPointTool)},get toolComponent(){return components.bR},get videoTime(){return self.displayTime}}}).actions(function(self){return{setVideoTime:function setVideoTime(displayTime,duration){self.displayTime=displayTime,self.displayTimeStamp=(0,formatTimeStamp.A)(displayTime,duration)}}});const TemporalPoint_TemporalPoint=mobx_state_tree_module.gK.compose("TemporalPoint",Point_Point,TemporalPointModel);var TemporalRotateRectangleModel=mobx_state_tree_module.gK.model("TemporalRotateRectangleModel",{displayTime:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),displayTimeStamp:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"")}).views(function(self){return{get tool(){return(0,mobx_state_tree_module.k2)(self,tools.TemporalRotateRectangleTool)},get toolComponent(){return components.ZT},get videoTime(){return self.displayTime}}}).actions(function(self){return{setVideoTime:function setVideoTime(displayTime,duration){self.displayTime=displayTime,self.displayTimeStamp=(0,formatTimeStamp.A)(displayTime,duration)}}});const TemporalRotateRectangle_TemporalRotateRectangle=mobx_state_tree_module.gK.compose("TemporalRotateRectangle",RotateRectangle_RotateRectangle,TemporalRotateRectangleModel);function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return FreehandLine_arrayLikeToArray(r)}(r)||function FreehandLine_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function FreehandLine_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return FreehandLine_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?FreehandLine_arrayLikeToArray(r,a):void 0}}(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FreehandLine_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var FreehandLine_SingleCoord=mobx_state_tree_module.gK.model("SingleCoord",{x:FixedNumber,y:FixedNumber}),ActionType=mobx_state_tree_module.gK.model("ActionType",{type:mobx_state_tree_module.gK.enumeration(["append","end","start","splice-append","splice-close-point","splice-drag-point","splice-end"]),pointIndexDrag:mobx_state_tree_module.gK.number,pointIndexClose:mobx_state_tree_module.gK.number,pointsFromDrag:mobx_state_tree_module.gK.array(FreehandLine_SingleCoord),pointsFromClose:mobx_state_tree_module.gK.array(FreehandLine_SingleCoord),pointsSpliceCount:mobx_state_tree_module.gK.number,isReversed:mobx_state_tree_module.gK.boolean,throughBeginning:mobx_state_tree_module.gK.boolean}),FreehandLineModel=mobx_state_tree_module.gK.model("FreehandLineModel",{pathX:mobx_state_tree_module.gK.array(FixedNumber),pathY:mobx_state_tree_module.gK.array(FixedNumber)}).views(function(self){return{get isValid(){return!0},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.FreehandLineTool)},get toolComponent(){return components._6},get closeDistance(){return Math.ceil(10/self.scale)},get isCloseToStart(){return!(!self.dragPoint||!self.closePoint)&&self.pointDistance(self.dragPoint,self.closePoint)<self.closeDistance},pointDistance:function pointDistance(p1,p2){return self.getDistance(p1.x,p1.y,p2.x,p2.y)},findClosestPathPointIndex:function findClosestPathPointIndex(_ref){var x=_ref.x,y=_ref.y,distances=self.points.map(function(point){return self.pointDistance({x,y},point)}),minDistance=Math.min.apply(Math,_toConsumableArray(distances));return distances.indexOf(minDistance)},get visiblePathsRender(){var paths=[];if(self.spliceActive)if(self.spliceThroughBeginning){var startIndex=self.spliceReverse?self.spliceDragPointIndex:self.spliceClosePointIndex,endIndex=self.spliceReverse?self.spliceClosePointIndex:self.spliceDragPointIndex;paths.push(self.points.slice(startIndex,endIndex+1))}else{var _endIndex=self.spliceReverse?self.spliceClosePointIndex:self.spliceDragPointIndex;paths.push(self.points.slice(0,_endIndex+1));var _startIndex=self.spliceReverse?self.spliceDragPointIndex:self.spliceClosePointIndex;paths.push(self.points.slice(_startIndex,self.points.length))}else paths.push(self.points);return paths.push(self.splicePoints),paths},get splicePathRender(){if(!self.spliceActive)return[];var pnts=[],startIndex=self.spliceReverse?self.spliceClosePointIndex:self.spliceDragPointIndex,endIndex=self.spliceReverse?self.spliceDragPointIndex:self.spliceClosePointIndex;return pnts=self.spliceThroughBeginning?(pnts=pnts.concat(self.points.slice(endIndex,self.points.length))).concat(self.points.slice(0,startIndex+1)):pnts.concat(self.points.slice(startIndex,endIndex+1))},get toData(){return{scale:self.scale,points:self.points,dragPoint:self.dragPoint,closePoint:self.closePoint,pathIsClosed:self.pathIsClosed,isDragging:self.isDragging,spliceActive:self.spliceActive,spliceReverse:self.spliceReverse,spliceThroughBeginning:self.spliceThroughBeginning,spliceDragPointIndex:self.spliceDragPointIndex,spliceClosePointIndex:self.spliceClosePointIndex,splicePoints:self.splicePoints,drawActions:self.drawActions,redoActions:self.redoActions}}}}).volatile(function(self){return{scale:mobx_state_tree_module.gK.number,lineResolution:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,.5),minimumPoints:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,20),undoActionPointThreshold:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,20),points:mobx_state_tree_module.gK.array(FreehandLine_SingleCoord),dragPoint:mobx_state_tree_module.gK.maybeNull(FreehandLine_SingleCoord),closePoint:mobx_state_tree_module.gK.maybeNull(FreehandLine_SingleCoord),pathIsClosed:mobx_state_tree_module.gK.boolean,isDragging:!1,spliceActive:mobx_state_tree_module.gK.boolean,spliceReverse:mobx_state_tree_module.gK.boolean,spliceThroughBeginning:mobx_state_tree_module.gK.boolean,spliceDragPointIndex:mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.number),spliceClosePointIndex:mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.number),splicePoints:mobx_state_tree_module.gK.array(FreehandLine_SingleCoord),drawActions:mobx_state_tree_module.gK.array(ActionType),redoActions:mobx_state_tree_module.gK.array(ActionType)}}).actions(function(self){return{afterCreate:function afterCreate(){var points=self.points||[];self.pathX&&self.pathY&&(points=self.pathX.map(function(x,i){return{x:self.pathX[i],y:self.pathY[i]}})),self.initialize(points)},initialize:function initialize(){var points=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];self.scale=1,self.lineResolution=isNaN(self.lineResolution)?.5:self.lineResolution,self.minimumPoints=isNaN(self.minimumPoints)?20:self.minimumPoints,self.undoActionPointThreshold=isNaN(self.undoActionPointThreshold)?20:self.undoActionPointThreshold,self.pathIsClosed=!1,self.points=_toConsumableArray(points),self.setClosePoint(self.points.at(0)),self.setDragPoint(self.points.at(-1)),self.isCloseToStart&&self.points.length>self.minimumPoints&&(self.setClosePoint(null),self.setDragPoint(null),self.pathIsClosed=!0),self.splicePoints=[],self.spliceDragPointIndex=null,self.spliceClosePointIndex=null,self.spliceActive=!1,self.spliceReverse=!1,self.spliceThroughBeginning=!1,self.drawActions=[],self.redoActions=[]},setDragPoint:function setDragPoint(point){self.dragPoint=point},setClosePoint:function setClosePoint(point){self.closePoint=point},setScale:function setScale(scale){self.scale=scale},setLineResolution:function setLineResolution(lineResolution){self.lineResolution=lineResolution},setMinimumPoints:function setMinimumPoints(minimumPoints){self.minimumPoints=minimumPoints},setUndoActionPointThreshold:function setUndoActionPointThreshold(undoActionPointThreshold){self.undoActionPointThreshold=undoActionPointThreshold},initialPosition:function initialPosition(event){self.initialize([{x:event.x,y:event.y}]),self.appendPathStart()},initialDrag:function initialDrag(point){self.appendPath(point)},close:function close(){self.closePath()},appendPathStart:function appendPathStart(){self.isDragging=!0,self.drawActions.push({type:self.spliceActive?"splice-append":"append",pointIndexDrag:self.spliceDragPointIndex,pointIndexClose:self.spliceClosePointIndex,pointsFromDrag:[],pointsFromClose:[],pointsSpliceCount:0,isReversed:self.spliceReverse,throughBeginning:self.spliceThroughBeginning}),self.spliceActive&&0==self.splicePoints.length&&(self.splicePoints=[self.points[self.spliceDragPointIndex]]),self.redoActionsClear()},appendPath:function appendPath(_ref2){var x=_ref2.x,y=_ref2.y;if(self.isDragging){var pathPoints=self.spliceActive?self.splicePoints:self.points,newPoint={x,y};self.pointDistance(newPoint,pathPoints.at(-1))<self.lineResolution||(pathPoints.push(newPoint),self.drawActions.at(-1).pointsFromDrag.length>self.undoActionPointThreshold&&self.appendPathStart(),self.drawActions.at(-1).pointsFromDrag.push(newPoint),self.setDragPoint(newPoint),self.isCloseToStart&&(self.spliceActive||!self.spliceActive&&self.points.length>self.minimumPoints)&&(self.isDragging=!1,self.closePath()))}},appendPathEnd:function appendPathEnd(){self.isDragging=!1,0==self.drawActions.at(-1).pointsFromDrag.length&&self.drawActions.pop()},closePath:function closePath(){if(self.spliceActive){var spliceEndAction=self.closeSplice();self.drawActions.push(spliceEndAction)}else self.drawActions.push({type:"end",pointIndexDrag:-1,pointIndexClose:-1,pointsFromDrag:[{x:self.points.at(0).x,y:self.points.at(0).y}],pointsFromClose:[],pointsSpliceCount:0,isReversed:!1,throughBeginning:!1}),self.points.push(self.points.at(0)),self.setDragPoint(null),self.setClosePoint(null),self.pathIsClosed=!0},closeSplice:function closeSplice(){self.splicePoints.shift();var _self$points,_self$points2,closeSpliceAction={type:"splice-end",pointIndexDrag:self.spliceDragPointIndex,pointIndexClose:self.spliceClosePointIndex,pointsFromDrag:[],pointsFromClose:[],pointsSpliceCount:self.splicePoints.length,isReversed:self.spliceReverse,throughBeginning:self.spliceThroughBeginning},startIndex=self.spliceReverse?self.spliceClosePointIndex:self.spliceDragPointIndex,endIndex=self.spliceReverse?self.spliceDragPointIndex:self.spliceClosePointIndex;(startIndex++,self.spliceThroughBeginning)?(self.spliceReverse&&(self.splicePoints=self.splicePoints.reverse()),self.splicePoints.push(self.points.at(endIndex)),closeSpliceAction.pointsFromClose=closeSpliceAction.pointsFromClose.concat(self.points.slice(startIndex,self.points.length)),closeSpliceAction.pointsFromDrag=closeSpliceAction.pointsFromDrag.concat(self.points.slice(0,endIndex)),self.points.splice(startIndex,self.points.length-startIndex),self.points.splice(0,endIndex),(_self$points=self.points).splice.apply(_self$points,[self.points.length,0].concat(_toConsumableArray(self.splicePoints)))):(closeSpliceAction.pointsFromDrag=closeSpliceAction.pointsFromDrag.concat(self.points.slice(startIndex,endIndex)),self.spliceReverse&&(self.splicePoints=self.splicePoints.reverse()),(_self$points2=self.points).splice.apply(_self$points2,[startIndex,endIndex-startIndex].concat(_toConsumableArray(self.splicePoints))));return self.spliceReset(),self.setDragPoint(self.pathIsClosed?null:self.points.at(-1)),self.setClosePoint(self.pathIsClosed?null:self.points.at(0)),closeSpliceAction},undo:function undo(){if(0!=self.drawActions.length){var action=self.drawActions.at(-1);if("start"==action.type)self.drawActions.pop(),self.tool.deleteMark(self);else if("end"==action.type)self.points.pop(),self.setDragPoint(self.points.at(-1)),self.setClosePoint(self.points.at(0)),self.drawActions.pop();else if("append"==action.type){var indexStart=self.points.length-action.pointsFromDrag.length;self.points.splice(indexStart,action.pointsFromDrag.length),self.setDragPoint(self.points.at(-1)),self.drawActions.pop()}else if("splice-drag-point"==action.type)self.spliceDragPointIndex=null,self.setDragPoint(self.pathIsClosed?null:self.points.at(-1)),self.setClosePoint(self.pathIsClosed?null:self.points.at(0)),self.drawActions.pop();else if("splice-close-point"==action.type)self.splicePoints.length=0,self.setClosePoint(null),self.spliceReverse=!1,self.spliceThroughBeginning=!1,self.spliceActive=!1,self.spliceClosePointIndex=null,self.drawActions.pop();else if("splice-append"==action.type){var _indexStart=self.splicePoints.length-action.pointsFromDrag.length;self.splicePoints.splice(_indexStart,action.pointsFromDrag.length),self.setDragPoint(self.splicePoints.at(-1)),self.drawActions.pop()}else if("splice-end"==action.type){if(action.throughBeginning){var _self$points3,_self$points4,spliceIndex=Math.abs(action.pointIndexDrag-action.pointIndexClose);self.splicePoints=self.splicePoints.concat(self.points.slice(spliceIndex,self.points.length-1)),action.isReversed&&(self.splicePoints=self.splicePoints.reverse()),(_self$points3=self.points).splice.apply(_self$points3,[spliceIndex+1,self.points.length-spliceIndex].concat(_toConsumableArray(action.pointsFromClose))),(_self$points4=self.points).splice.apply(_self$points4,[0,0].concat(_toConsumableArray(action.pointsFromDrag)))}else{var _self$points5,_spliceIndex=action.isReversed?action.pointIndexClose:action.pointIndexDrag;self.splicePoints=self.splicePoints.concat(self.points.slice(_spliceIndex,_spliceIndex+action.pointsSpliceCount+1)),action.isReversed&&(self.splicePoints=self.splicePoints.reverse()),(_self$points5=self.points).splice.apply(_self$points5,[_spliceIndex+1,action.pointsSpliceCount].concat(_toConsumableArray(action.pointsFromDrag)))}self.spliceActive=!0,self.spliceReverse=action.isReversed,self.spliceThroughBeginning=action.throughBeginning,self.spliceDragPointIndex=action.pointIndexDrag,self.spliceClosePointIndex=action.pointIndexClose,self.setDragPoint(self.splicePoints.at(-1)),self.setClosePoint(self.points[self.spliceClosePointIndex]),self.drawActions.pop()}self.redoActions.push(action)}else 1==self.points.length&&self.finish()},redo:function redo(){if(0!=self.redoActions.length){var action=self.redoActions.at(-1);if("end"==action.type)self.closePath();else if("append"==action.type){var _self$points6;(_self$points6=self.points).splice.apply(_self$points6,[self.points.length,0].concat(_toConsumableArray(action.pointsFromDrag))),self.setDragPoint(self.points.at(-1)),self.drawActions.push(action)}else if("splice-drag-point"==action.type)self.spliceDragPointIndex=action.pointIndexDrag,self.setDragPoint(self.points[action.pointIndexDrag]),self.setClosePoint(null),self.drawActions.push(action);else if("splice-close-point"==action.type)self.setClosePoint(self.points[action.pointIndexDrag]),self.drawActions.push(action),self.splicePathSetup();else if("splice-append"==action.type){var _self$splicePoints;0==self.splicePoints.length&&self.splicePoints.push(self.dragPoint),(_self$splicePoints=self.splicePoints).splice.apply(_self$splicePoints,[self.splicePoints.length,0].concat(_toConsumableArray(action.pointsFromDrag))),self.setDragPoint(self.splicePoints.at(-1)),self.drawActions.push(action)}else"splice-end"==action.type&&(self.closeSplice(),self.drawActions.push(action));self.redoActions.pop()}},redoActionsClear:function redoActionsClear(){self.redoActions.length=0},splicePathDragPoint:function splicePathDragPoint(point){if(!self.spliceDragPointIndex){var closestPointIndex=self.findClosestPathPointIndex(point);self.drawActions.push({type:"splice-drag-point",pointIndexDrag:closestPointIndex,pointIndexClose:-1,pointsFromDrag:[],pointsFromClose:[],pointsSpliceCount:0,isReversed:!1,throughBeginning:!1}),self.spliceDragPointIndex=closestPointIndex,self.setDragPoint(self.points.at(closestPointIndex)),self.setClosePoint(null),self.redoActionsClear()}},splicePathClosePoint:function splicePathClosePoint(point){if(self.spliceDragPointIndex&&!self.spliceClosePointIndex){var dragPointIndex=self.spliceDragPointIndex,closePointIndex=self.findClosestPathPointIndex(point),spliceSpan=Math.abs(closePointIndex-dragPointIndex),spliceReverse=closePointIndex<dragPointIndex,spliceThroughBeginning=!1;self.pathIsClosed&&(spliceSpan>self.points.length/2&&(spliceSpan=Math.abs(dragPointIndex-closePointIndex),spliceReverse=dragPointIndex<closePointIndex),(spliceReverse&&dragPointIndex<spliceSpan||!spliceReverse&&dragPointIndex+spliceSpan>self.points.length)&&(spliceThroughBeginning=!0)),self.drawActions.push({type:"splice-close-point",pointIndexDrag:dragPointIndex,pointIndexClose:closePointIndex,pointsFromDrag:[],pointsFromClose:[],pointsSpliceCount:0,isReversed:spliceReverse,throughBeginning:spliceThroughBeginning}),self.splicePathSetup(),self.redoActionsClear()}},splicePathSetup:function splicePathSetup(){var action=self.drawActions.at(-1);self.spliceClosePointIndex=action.pointIndexClose,self.spliceReverse=action.isReversed,self.spliceThroughBeginning=action.throughBeginning,self.spliceActive=!0,self.setClosePoint(self.points[action.pointIndexClose])},spliceReset:function spliceReset(){self.splicePoints.length=0,self.spliceActive=!1,self.spliceReverse=!1,self.spliceThroughBeginning=!1,self.spliceDragPointIndex=null,self.spliceClosePointIndex=null},move:function move(){},inactive:function inactive(){if(0!==self.drawActions.length)for(;["splice-drag-point","splice-close-point","splice-append"].indexOf(self.drawActions.at(-1).type)>-1;)self.undo(),self.redoActionsClear()},finalizePoints:function finalizePoints(){self.pathX=[],self.pathY=[],self.points.forEach(function(point){self.pathX.push(point.x),self.pathY.push(point.y)})},finish:function finish(){if(self.points.length<self.minimumPoints)return self.tool.deleteMark(self);self.isDragging?(self.appendPathEnd(),self.finished=!0):self.pathIsClosed?(self.finished=!0,self.finalizePoints()):self.finalizePoints()}}});const FreehandLine_FreehandLine=mobx_state_tree_module.gK.compose("FreehandLine",Mark,FreehandLineModel);var TranscriptionLineModel=mobx_state_tree_module.gK.model("TranscriptionLineModel",{x1:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y1:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),x2:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),y2:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number)}).views(function(self){return{get coords(){return{x:self.x1,y:self.y1}},deleteButtonPosition:function deleteButtonPosition(scale){var dx=self.x2-self.x1,dy=self.y2-self.y1,xBuffer=dx?dx/self.length*20:20,yBuffer=dy?dy/self.length*20:0;return{x:self.x2+xBuffer/scale,y:self.y2+yBuffer/scale}},get isValid(){return self.x1!==self.x2||self.y1!==self.y2},get length(){var x1=self.x1,y1=self.y1,x2=self.x2,y2=self.y2;return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))},get tool(){return(0,mobx_state_tree_module.k2)(self,tools.TranscriptionLineTool)},get toolComponent(){return components.Xj}}}).actions(function(self){return{initialDrag:function initialDrag(_ref){var x=_ref.x,y=_ref.y;self.x2=x,self.y2=y},initialPosition:function initialPosition(_ref2){var x=_ref2.x,y=_ref2.y;self.x1=x,self.y1=y,self.x2=x,self.y2=y},move:function move(_ref3){var x=_ref3.x,y=_ref3.y;self.x1+=x,self.x2+=x,self.y1+=y,self.y2+=y},setCoordinates:function setCoordinates(_ref4){var x1=_ref4.x1,y1=_ref4.y1,x2=_ref4.x2,y2=_ref4.y2;self.x1=x1,self.y1=y1,self.x2=x2,self.y2=y2}}});const TranscriptionLine_TranscriptionLine=mobx_state_tree_module.gK.compose("TranscriptionLine",Mark,TranscriptionLineModel)},"./src/plugins/drawingTools/models/tools/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CircleTool:()=>CircleTool_CircleTool,EllipseTool:()=>EllipseTool_EllipseTool,FreehandLineTool:()=>FreehandLineTool_FreehandLineTool,LineTool:()=>LineTool_LineTool,PointTool:()=>PointTool_PointTool,PolygonTool:()=>PolygonTool_PolygonTool,RectangleTool:()=>RectangleTool_RectangleTool,RotateRectangleTool:()=>RotateRectangleTool_RotateRectangleTool,TemporalPointTool:()=>TemporalPointTool_TemporalPointTool,TemporalRotateRectangleTool:()=>TemporalRotateRectangleTool_TemporalRotateRectangleTool,Tool:()=>Tool_Tool,TranscriptionLineTool:()=>TranscriptionLineTool_TranscriptionLineTool});var mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),marks=__webpack_require__("./src/plugins/drawingTools/models/marks/index.js"),single=__webpack_require__("./src/plugins/tasks/single/index.js"),multiple=__webpack_require__("./src/plugins/tasks/multiple/index.js"),tasks_text=__webpack_require__("./src/plugins/tasks/text/index.js"),dropdown_simple=__webpack_require__("./src/plugins/tasks/dropdown-simple/index.js");const Tool_Tool=mobx_state_tree_module.gK.model("Tool",{color:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),details:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen()),label:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),marks:mobx_state_tree_module.gK.map(marks.Mark),max:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.union(mobx_state_tree_module.gK.string,mobx_state_tree_module.gK.number),1/0),min:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.union(mobx_state_tree_module.gK.string,mobx_state_tree_module.gK.number),0),tasks:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.union(single.A.TaskModel,multiple.A.TaskModel,tasks_text.A.TaskModel,dropdown_simple.A.TaskModel)),type:mobx_state_tree_module.gK.literal("default")}).preProcessSnapshot(function(snapshot){var newSnapshot=Object.assign({},snapshot);return snapshot.max||(newSnapshot.max=1/0),snapshot.min||(newSnapshot.min=0),snapshot.details&&!snapshot.tasks&&(newSnapshot.tasks=[],snapshot.details.forEach(function(detail,detailIndex){var toolKey=snapshot.key||"subtask",taskKey="".concat(toolKey,".").concat(detailIndex),taskSnapshot=Object.assign({},detail,{taskKey});newSnapshot.tasks.push(taskSnapshot)})),newSnapshot}).views(function(self){return{get disabled(){return self.marks.size>=self.max},get isComplete(){return Array.from(self.marks.values()).reduce(function(allComplete,mark){return allComplete&&mark.isComplete},!0)&&self.marks.size>=self.min},get isValid(){return Array.from(self.marks.values()).reduce(function(allValid,mark){return allValid&&mark.isValid},!0)}}}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.Mark.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},createTask:function createTask(snapshot){try{return self.tasks.push(snapshot),self.tasks[self.tasks.length-1]}catch(e){console.error("".concat(snapshot.taskKey," is not a valid drawing subtask"))}},deleteMark:function deleteMark(mark){self.marks.delete(mark.id)},reset:function reset(){self.marks.clear()},validate:function validate(){self.marks.forEach(function(mark){mark.finish()})}}});var CircleTool=mobx_state_tree_module.gK.model("Circle",{marks:mobx_state_tree_module.gK.map(marks.Circle),type:mobx_state_tree_module.gK.literal("circle")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.Circle.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const CircleTool_CircleTool=mobx_state_tree_module.gK.compose("CircleTool",Tool_Tool,CircleTool);var EllipseTool=mobx_state_tree_module.gK.model("Ellipse",{marks:mobx_state_tree_module.gK.map(marks.Ellipse),type:mobx_state_tree_module.gK.literal("ellipse")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.Ellipse.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.setDragging(!1)}}});const EllipseTool_EllipseTool=mobx_state_tree_module.gK.compose("EllipseTool",Tool_Tool,EllipseTool);var LineTool=mobx_state_tree_module.gK.model("Line",{marks:mobx_state_tree_module.gK.map(marks.Line),type:mobx_state_tree_module.gK.literal("line")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.Line.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const LineTool_LineTool=mobx_state_tree_module.gK.compose("LineTool",Tool_Tool,LineTool);var PointTool=mobx_state_tree_module.gK.model("Point",{marks:mobx_state_tree_module.gK.map(marks.Point),size:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration(["large","small"]),"large"),type:mobx_state_tree_module.gK.literal("point")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.Point.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const PointTool_PointTool=mobx_state_tree_module.gK.compose("PointTool",Tool_Tool,PointTool);var PolygonTool=mobx_state_tree_module.gK.model("Polygon",{marks:mobx_state_tree_module.gK.map(marks.Polygon),type:mobx_state_tree_module.gK.literal("polygon")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.Polygon.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerDown:function handlePointerDown(event,mark){mark.appendPath(event)},handlePointerMove:function handlePointerMove(event,mark){null==mark||mark.setGuideLine(event)},handlePointerUp:function handlePointerUp(event,mark){1===(null==mark?void 0:mark.points.length)&&mark.initialDrag(event)}}});const PolygonTool_PolygonTool=mobx_state_tree_module.gK.compose("PolygonTool",Tool_Tool,PolygonTool);var RectangleTool=mobx_state_tree_module.gK.model("Rectangle",{marks:mobx_state_tree_module.gK.map(marks.Rectangle),type:mobx_state_tree_module.gK.literal("rectangle")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.Rectangle.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const RectangleTool_RectangleTool=mobx_state_tree_module.gK.compose("RectangleTool",Tool_Tool,RectangleTool);var RotateRectangleTool=mobx_state_tree_module.gK.model("RotateRectangle",{marks:mobx_state_tree_module.gK.map(marks.RotateRectangle),type:mobx_state_tree_module.gK.literal("rotateRectangle")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.RotateRectangle.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const RotateRectangleTool_RotateRectangleTool=mobx_state_tree_module.gK.compose("RotateRectangleTool",RectangleTool_RectangleTool,RotateRectangleTool);var TemporalPointTool=mobx_state_tree_module.gK.model("TemporalPoint",{marks:mobx_state_tree_module.gK.map(marks.TemporalPoint),type:mobx_state_tree_module.gK.literal("temporalPoint")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.TemporalPoint.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const TemporalPointTool_TemporalPointTool=mobx_state_tree_module.gK.compose("TemporalPointTool",PointTool_PointTool,TemporalPointTool);var TemporalRotateRectangleTool=mobx_state_tree_module.gK.model("TemporalRotateRectangle",{marks:mobx_state_tree_module.gK.map(marks.TemporalRotateRectangle),type:mobx_state_tree_module.gK.literal("temporalRotateRectangle")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.TemporalRotateRectangle.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag(event)},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const TemporalRotateRectangleTool_TemporalRotateRectangleTool=mobx_state_tree_module.gK.compose("TemporalRotateRectangleTool",RotateRectangleTool_RotateRectangleTool,TemporalRotateRectangleTool);function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var FreehandLineTool=mobx_state_tree_module.gK.model("FreehandLine",{marks:mobx_state_tree_module.gK.map(marks.FreehandLine),type:mobx_state_tree_module.gK.literal("freehandLine")}).actions(function(self){return{createMark:function createMark(mark){var newMark=marks.FreehandLine.create(_objectSpread(_objectSpread({},mark),{},{toolType:self.type}));return self.marks.put(newMark),newMark},handlePointerMove:function handlePointerMove(event,mark){mark.initialDrag({x:event.x,y:event.y})},handlePointerUp:function handlePointerUp(event,mark){mark.finish()}}});const FreehandLineTool_FreehandLineTool=mobx_state_tree_module.gK.compose("FreehandLineTool",Tool_Tool,FreehandLineTool);var TranscriptionLineTool=mobx_state_tree_module.gK.model("TranscriptionLine",{marks:mobx_state_tree_module.gK.map(marks.TranscriptionLine),type:mobx_state_tree_module.gK.literal("transcriptionLine")}).actions(function(self){return{handlePointerDown:function handlePointerDown(event,mark){mark.initialDrag(event),mark.finish()},createMark:function createMark(mark){var newMark=marks.TranscriptionLine.create(Object.assign({},mark,{toolType:self.type}));return self.marks.put(newMark),newMark}}});const TranscriptionLineTool_TranscriptionLineTool=mobx_state_tree_module.gK.compose("TranscriptionLineTool",Tool_Tool,TranscriptionLineTool)},"./src/plugins/drawingTools/shared/SVGContext.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("../../node_modules/react/index.js").createContext)({canvas:null,rotate:0,transformMatrix:{scaleX:1,scaleY:1,skewX:0,skewY:0,translateX:0,translateY:0}})},"./src/plugins/tasks/components/InputIcon/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>InputIcon});var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledInputIcon=styled_components_browser_esm.default.span.withConfig({displayName:"InputIcon__StyledInputIcon",componentId:"sc-yki6kh-0"})([""," display:flex;align-items:center;padding:15px;"," > svg{fill-opacity:0.1;height:1.5em;stroke:currentColor;stroke-width:5;width:1.5em;}"],function(props){return props.color&&(0,styled_components_browser_esm.css)(["color:",";"],props.color)},function(props){return"rgb(0, 0, 0)"===props.color||"#000000"===props.color?(0,styled_components_browser_esm.css)(["background:radial-gradient(#cbcccb 0%,#2D2D2D 80%);"]):(0,styled_components_browser_esm.css)(["background:#2D2D2D;"])});function InputIcon(_ref){var _ref$color=_ref.color,color=void 0===_ref$color?"white":_ref$color,icon=_ref.icon;return(0,jsx_runtime.jsx)(StyledInputIcon,{color,children:icon})}InputIcon.propTypes={color:prop_types.string,icon:prop_types.node.isRequired},InputIcon.__docgenInfo={description:"",methods:[],displayName:"InputIcon",props:{color:{defaultValue:{value:"'white'",computed:!1},description:"",type:{name:"custom",raw:"string"},required:!1},icon:{description:"",type:{name:"node"},required:!0}}}},"./src/plugins/tasks/components/InputStatus/InputStatus.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>InputStatus});var prop_types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/prop-types/index.js"),grommet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),styled_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_translations_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/translations/i18n.jsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledInputStatus=(0,styled_components__WEBPACK_IMPORTED_MODULE_2__.default)(grommet__WEBPACK_IMPORTED_MODULE_1__.E).withConfig({displayName:"InputStatus__StyledInputStatus",componentId:"sc-1xvksjw-0"})(["display:flex;justify-content:end;align-items:center;flex-grow:1;"]);function InputStatus(_ref){var _ref$count=_ref.count,count=void 0===_ref$count?0:_ref$count,_ref$tool=_ref.tool,tool=void 0===_ref$tool?{}:_ref$tool,t=(0,_translations_i18n__WEBPACK_IMPORTED_MODULE_3__.Bd)("plugins").t,status=t("InputStatus.drawn",{count}),hasMin=tool.min&&tool.min>0,hasMax=tool.max&&tool.max<1/0;return hasMin&&hasMax?status=t("InputStatus.maxAndMin",{count,max:tool.max,min:tool.min}):hasMax?status=t("InputStatus.max",{count,max:tool.max}):hasMin&&(status=t("InputStatus.min",{count,min:tool.min})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(StyledInputStatus,{children:status})}InputStatus.propTypes={count:prop_types__WEBPACK_IMPORTED_MODULE_0__.number,tool:(0,prop_types__WEBPACK_IMPORTED_MODULE_0__.shape)({min:(0,prop_types__WEBPACK_IMPORTED_MODULE_0__.oneOfType)([prop_types__WEBPACK_IMPORTED_MODULE_0__.number,prop_types__WEBPACK_IMPORTED_MODULE_0__.string]),max:(0,prop_types__WEBPACK_IMPORTED_MODULE_0__.oneOfType)([prop_types__WEBPACK_IMPORTED_MODULE_0__.number,prop_types__WEBPACK_IMPORTED_MODULE_0__.string])})},InputStatus.__docgenInfo={description:"",methods:[],displayName:"InputStatus",props:{count:{defaultValue:{value:"0",computed:!1},description:"",type:{name:"custom",raw:"number"},required:!1},tool:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{min:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},max:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}},required:!1}}}},"./src/plugins/tasks/components/InputStatus/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>_InputStatus__WEBPACK_IMPORTED_MODULE_0__.A});var _InputStatus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/plugins/tasks/components/InputStatus/InputStatus.jsx")},"./src/plugins/tasks/components/TaskInput/TaskInput.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>TaskInput_TaskInput});var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),polished_esm=__webpack_require__("../../node_modules/polished/dist/polished.esm.js"),Text=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),Markdownz=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");var StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"TaskInputLabel__StyledText",componentId:"sc-101o3f3-0"})(["display:flex;align-content:center;align-items:center;padding:5px 0 5px 15px;gap:15px;"]);function TaskInputLabel(_ref){var _ref$label=_ref.label,label=void 0===_ref$label?"":_ref$label,_ref$labelIcon=_ref.labelIcon,labelIcon=void 0===_ref$labelIcon?null:_ref$labelIcon,_ref$labelStatus=_ref.labelStatus,labelStatus=void 0===_ref$labelStatus?null:_ref$labelStatus,howShouldTheLabelBeAligned=label&&function doesTheLabelHaveAnImage(label){return label&&/(?:!\[(.*?)\]\((.*?)\))/g.test(label)}(label)||label&&labelIcon?"start":"center";return(0,jsx_runtime.jsxs)(Box.a,{as:"span",direction:"row",fill:"horizontal",justify:howShouldTheLabelBeAligned,pad:{right:"15px"},children:[labelIcon&&labelIcon,(0,jsx_runtime.jsx)(StyledText,{children:(0,jsx_runtime.jsx)(Markdownz.Ay,{inline:!0,children:label})}),labelStatus&&labelStatus]})}function getHoverStyles(props){var active=arguments.length>1&&void 0!==arguments[1]&&arguments[1],_props$theme=props.theme,dark=_props$theme.dark,colors=_props$theme.global.colors;if(dark){var borderColor=active?colors["accent-1"]:colors["light-1"],darkerBackgroundColor=(0,polished_esm.e$)(.04,colors["neutral-1"]);return(0,styled_components_browser_esm.css)(["background:",";border:2px solid ",";color:",";"],darkerBackgroundColor,borderColor,colors.text.dark)}var gradientTop=(0,polished_esm.a)(.05,colors["accent-1"]),gradientBottom=(0,polished_esm.e$)(.11,colors["accent-1"]),borderTopColor=active?colors.brand:gradientTop,borderBottomColor=active?colors.brand:gradientBottom,borderRightColor=active?colors.brand:"transparent",borderLeftColor=active?colors.brand:"transparent";return(0,styled_components_browser_esm.css)(["background:linear-gradient(",",",");border-width:2px;border-style:solid;border-left-color:",";border-right-color:",";border-top-color:",";border-bottom-color:",";color:'black';"],gradientTop,gradientBottom,borderLeftColor,borderRightColor,borderTopColor,borderBottomColor)}TaskInputLabel.propTypes={label:prop_types_default().string,labelIcon:prop_types_default().oneOfType([prop_types_default().node,prop_types_default().object]),labelStatus:prop_types_default().oneOfType([prop_types_default().node,prop_types_default().object])},TaskInputLabel.__docgenInfo={description:"",methods:[],displayName:"TaskInputLabel",props:{label:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},labelIcon:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"union",value:[{name:"node"},{name:"object"}]},required:!1},labelStatus:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"union",value:[{name:"node"},{name:"object"}]},required:!1}}};var TaskInput_StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"TaskInput__StyledText",componentId:"sc-1e05gc2-0"})([""," "," box-shadow:1px 1px 2px 0 rgba(0,0,0,0.5);cursor:pointer;display:flex;align-items:center;min-height:45px;margin:8px 0;"],function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["background:transparent;"]):(0,styled_components_browser_esm.css)(["background:",";"],props.theme.global.colors["light-1"])},function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["border:2px solid ",";"],props.theme.global.colors["light-1"]):(0,styled_components_browser_esm.css)(["border:2px solid transparent;"])}),StyledLabel=styled_components_browser_esm.default.label.withConfig({displayName:"TaskInput__StyledLabel",componentId:"sc-1e05gc2-1"})(["position:relative;input{opacity:0.01;position:absolute;}input:enabled + ",":hover{","}input:focus + ","{","}input:enabled:active + ","{","}input:checked + ","{"," "," ","}input:focus:checked + ",",input:checked + ",":hover{"," > img:only-child,svg:only-child{background-color:inherit !important;}}input:checked + ",":hover{> div > span > p{","}}"],TaskInput_StyledText,function(props){return getHoverStyles(props)},TaskInput_StyledText,function(props){return getHoverStyles(props)},TaskInput_StyledText,function(props){return getHoverStyles(props,!0)},TaskInput_StyledText,function(props){return(0,styled_components_browser_esm.css)(["background:",";"],props.theme.global.colors.brand)},function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["border:2px solid ",";"],props.theme.global.colors["light-1"]):(0,styled_components_browser_esm.css)(["border:2px solid transparent;"])},function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["color:",";"],props.theme.global.colors.text.dark):(0,styled_components_browser_esm.css)(["color:white;"])},TaskInput_StyledText,TaskInput_StyledText,function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["border:2px solid ",";"],props.theme.global.colors["light-1"]):(0,styled_components_browser_esm.css)(["border:2px solid ",";"],props.theme.global.colors["neutral-1"])},TaskInput_StyledText,function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["color:",";"],props.theme.global.colors.text.dark):(0,styled_components_browser_esm.css)(["color:black;"])}),DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function TaskInput(_ref){var _ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$checked=_ref.checked,checked=void 0!==_ref$checked&&_ref$checked,_ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,index=_ref.index,_ref$label=_ref.label,label=void 0===_ref$label?"":_ref$label,_ref$labelIcon=_ref.labelIcon,labelIcon=void 0===_ref$labelIcon?null:_ref$labelIcon,_ref$labelStatus=_ref.labelStatus,labelStatus=void 0===_ref$labelStatus?null:_ref$labelStatus,name=_ref.name,_ref$onChange=_ref.onChange,onChange=void 0===_ref$onChange?DEFAULT_HANDLER:_ref$onChange,type=_ref.type,id="".concat(type,"-").concat(name,"-").concat(index);return(0,jsx_runtime.jsxs)(StyledLabel,{className,htmlFor:id,children:[(0,jsx_runtime.jsx)("input",{autoFocus,checked,disabled,id,name,onChange,type,value:index}),(0,jsx_runtime.jsx)(TaskInput_StyledText,{children:(0,jsx_runtime.jsx)(TaskInputLabel,{label,labelIcon,labelStatus})})]})}TaskInput.propTypes={autoFocus:prop_types_default().bool,checked:prop_types_default().bool,className:prop_types_default().string,disabled:prop_types_default().bool,index:prop_types_default().number.isRequired,label:prop_types_default().string,labelIcon:prop_types_default().oneOfType([prop_types_default().node,prop_types_default().object]),labelStatus:prop_types_default().oneOfType([prop_types_default().node,prop_types_default().object]),name:prop_types_default().string.isRequired,onChange:prop_types_default().func,type:prop_types_default().string.isRequired};const TaskInput_TaskInput=TaskInput;TaskInput.__docgenInfo={description:"",methods:[],displayName:"TaskInput",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},checked:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},className:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},label:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},labelIcon:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"union",value:[{name:"node"},{name:"object"}]},required:!1},labelStatus:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"union",value:[{name:"node"},{name:"object"}]},required:!1},onChange:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},index:{description:"",type:{name:"number"},required:!0},name:{description:"",type:{name:"string"},required:!0},type:{description:"",type:{name:"string"},required:!0}}}},"./src/plugins/tasks/components/TaskInput/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>_TaskInput__WEBPACK_IMPORTED_MODULE_0__.A});var _TaskInput__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/plugins/tasks/components/TaskInput/TaskInput.jsx")},"./src/plugins/tasks/dataVisAnnotation/components/DataVisAnnotationTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_DataVisAnnotationTask});var Text=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),Markdownz=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),TaskInput=__webpack_require__("./src/plugins/tasks/components/TaskInput/index.js"),InputIcon=__webpack_require__("./src/plugins/tasks/components/InputIcon/index.js"),Blank=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Blank.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function Graph2dRangeXIcon(){return(0,jsx_runtime.jsx)(Blank.h,{viewBox:"0 0 100 100",children:(0,jsx_runtime.jsx)("rect",{className:"shape",x:"25",y:"0",width:"25",height:"100%"})})}Graph2dRangeXIcon.__docgenInfo={description:"",methods:[],displayName:"Graph2dRangeXIcon"};var StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"DataVisAnnotationTask__StyledText",componentId:"sc-kmfh15-0"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]);function DataVisAnnotationTask(props){var _props$task=props.task,task=void 0===_props$task?{}:_props$task,setActiveTool=task.setActiveTool;return(0,jsx_runtime.jsxs)(Box.a,{children:[(0,jsx_runtime.jsx)(StyledText,{as:"legend",size:"small",children:(0,jsx_runtime.jsx)(Markdownz.Ay,{children:task.instruction})}),task.tools.map(function(tool,index){var checked=task.activeToolIndex===index;return(0,jsx_runtime.jsx)(TaskInput.A,{checked,index,label:task.strings.get("tools.".concat(index,".label")),labelIcon:(0,jsx_runtime.jsx)(InputIcon.A,{icon:(0,jsx_runtime.jsx)(Graph2dRangeXIcon,{}),color:"white"}),name:task.taskKey,onChange:function onChange(event){return function _onChange(index,event){event.target.checked&&setActiveTool(index)}(index,event)},required:task.required,type:"radio"},"".concat(task.taskKey,"_").concat(index))})]})}DataVisAnnotationTask.propTypes={task:prop_types_default().shape({help:prop_types_default().string,instruction:prop_types_default().string,required:prop_types_default().bool})};const components_DataVisAnnotationTask=(0,mobxreact_esm.PA)(DataVisAnnotationTask);DataVisAnnotationTask.__docgenInfo={description:"",methods:[],displayName:"DataVisAnnotationTask",props:{task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},required:{name:"bool",required:!1}}},required:!1}}}},"./src/plugins/tasks/drawing/components/DrawingTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_DrawingTask});var Text=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),Blank=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Blank.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),Markdownz=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),AnchoredEllipse=function AnchoredEllipse(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("ellipse",{rx:"45",ry:"25",cx:"50",cy:"50",transform:"rotate(-30, 50, 50)"}),(0,jsx_runtime.jsx)("circle",{r:"5",cy:"50",cx:"50"})]})};const icons_AnchoredEllipse=AnchoredEllipse;AnchoredEllipse.__docgenInfo={description:"",methods:[],displayName:"AnchoredEllipse"};var Bezier=function Bezier(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("path",{d:"M90 90 Q 10 50 90 10",fill:"none"}),(0,jsx_runtime.jsx)("path",{d:"M90 90 L 10 50 L 90 10",strokeDasharray:[10,10],fill:"none"})]})};const icons_Bezier=Bezier;Bezier.__docgenInfo={description:"",methods:[],displayName:"Bezier"};var Circle=function Circle(){return(0,jsx_runtime.jsx)("ellipse",{rx:"33",ry:"33",cx:"50",cy:"50"})};const icons_Circle=Circle;Circle.__docgenInfo={description:"",methods:[],displayName:"Circle"};var Column=function Column(){return(0,jsx_runtime.jsx)("rect",{x:"10",y:"0",width:"25",height:"100%"})};const icons_Column=Column;Column.__docgenInfo={description:"",methods:[],displayName:"Column"};var Ellipse=function Ellipse(){return(0,jsx_runtime.jsx)("ellipse",{rx:"45",ry:"25",cx:"50",cy:"50",transform:"rotate(-30, 50, 50)"})};const icons_Ellipse=Ellipse;Ellipse.__docgenInfo={description:"",methods:[],displayName:"Ellipse"};var Fan=function Fan(){return(0,jsx_runtime.jsx)("path",{d:"M 50 95 L 80 33 A 20 20 0 1 0 20 33 Z"})};const icons_Fan=Fan;Fan.__docgenInfo={description:"",methods:[],displayName:"Fan"};var FreehandLine=function FreehandLine(){return(0,jsx_runtime.jsx)("path",{d:"M10,50 Q25,10,50,50,75,90,90,50"})};const icons_FreehandLine=FreehandLine;FreehandLine.__docgenInfo={description:"",methods:[],displayName:"FreehandLine"};var FreehandSegmentLine=function FreehandSegmentLine(){return(0,jsx_runtime.jsx)("path",{d:"M10,50 Q25,10,50,50,75,90,90,50",fill:"none"})};const icons_FreehandSegmentLine=FreehandSegmentLine;FreehandSegmentLine.__docgenInfo={description:"",methods:[],displayName:"FreehandSegmentLine"};var FreehandSegmentShape=function FreehandSegmentShape(){return(0,jsx_runtime.jsx)("path",{d:"M20,60 C10,10,80,10,50,50 C20,90 90,90 80,40 z"})};const icons_FreehandSegmentShape=FreehandSegmentShape;FreehandSegmentShape.__docgenInfo={description:"",methods:[],displayName:"FreehandSegmentShape"};var FreehandShape=function FreehandShape(){return(0,jsx_runtime.jsx)("path",{d:"M20,60 C10,10,80,10,50,50 C20,90 90,90 80,40 z"})};const icons_FreehandShape=FreehandShape;FreehandShape.__docgenInfo={description:"",methods:[],displayName:"FreehandShape"};var FullHeightLine=function FullHeightLine(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",strokeDasharray:[10,10]}),(0,jsx_runtime.jsx)("line",{x1:"50",y1:"0",x2:"50",y2:"100"})]})};const icons_FullHeightLine=FullHeightLine;FullHeightLine.__docgenInfo={description:"",methods:[],displayName:"FullHeightLine"};var FullWidthLine=function FullWidthLine(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",strokeDasharray:[10,10]}),(0,jsx_runtime.jsx)("line",{x1:"0",y1:"50",x2:"100",y2:"50"})]})};const icons_FullWidthLine=FullWidthLine;FullWidthLine.__docgenInfo={description:"",methods:[],displayName:"FullWidthLine"};var Grid=function Grid(){return(0,jsx_runtime.jsx)("polyline",{points:"0, 25 50, 25 50, 75 0, 75 0, 25 50, 25 100, 25 100, 75 50, 75 50, 25"})};const icons_Grid=Grid;Grid.__docgenInfo={description:"",methods:[],displayName:"Grid"};var Line=function Line(){return(0,jsx_runtime.jsx)("line",{x1:"25",y1:"90",x2:"75",y2:"10"})};const icons_Line=Line;Line.__docgenInfo={description:"",methods:[],displayName:"Line"};var Point=function Point(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("circle",{r:"30",cx:"50",cy:"50"}),(0,jsx_runtime.jsx)("line",{x1:"50",y1:"5",x2:"50",y2:"40"}),(0,jsx_runtime.jsx)("line",{x1:"95",y1:"50",x2:"60",y2:"50"}),(0,jsx_runtime.jsx)("line",{x1:"50",y1:"95",x2:"50",y2:"60"}),(0,jsx_runtime.jsx)("line",{x1:"5",y1:"50",x2:"40",y2:"50"})]})};const icons_Point=Point;Point.__docgenInfo={description:"",methods:[],displayName:"Point"};var PointGrid=function PointGrid(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("line",{x1:"20",y1:"0",x2:"20",y2:"80"}),(0,jsx_runtime.jsx)("line",{x1:"40",y1:"0",x2:"40",y2:"80"}),(0,jsx_runtime.jsx)("line",{x1:"60",y1:"0",x2:"60",y2:"80"}),(0,jsx_runtime.jsx)("line",{x1:"0",y1:"20",x2:"80",y2:"20"}),(0,jsx_runtime.jsx)("line",{x1:"0",y1:"40",x2:"80",y2:"40"}),(0,jsx_runtime.jsx)("line",{x1:"0",y1:"60",x2:"80",y2:"60"})]})};const icons_PointGrid=PointGrid;PointGrid.__docgenInfo={description:"",methods:[],displayName:"PointGrid"};var Polygon=function Polygon(){return(0,jsx_runtime.jsx)("polyline",{points:"50, 5 90, 90 50, 70 5, 90 50, 5"})};const icons_Polygon=Polygon;Polygon.__docgenInfo={description:"",methods:[],displayName:"Polygon"};var Rectangle=function Rectangle(){return(0,jsx_runtime.jsx)("rect",{x:"10",y:"30",width:"80",height:"40"})};const icons_Rectangle=Rectangle;Rectangle.__docgenInfo={description:"",methods:[],displayName:"Rectangle"};var RotateRectangle=function RotateRectangle(){return(0,jsx_runtime.jsx)("rect",{x:"10",y:"30",width:"80",height:"40"})};const icons_RotateRectangle=RotateRectangle;RotateRectangle.__docgenInfo={description:"",methods:[],displayName:"RotateRectangle"};var TranscriptionLine=function TranscriptionLine(){return(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)("line",{x1:"50",y1:"80.8",x2:"50",y2:"19"}),(0,jsx_runtime.jsx)("polyline",{points:"76.4,31 76.4,19 23.6,19 23.6,31 "}),(0,jsx_runtime.jsx)("line",{x1:"40.4",y1:"80.8",x2:"59.6",y2:"80.8"})]})};const icons_TranscriptionLine=TranscriptionLine;TranscriptionLine.__docgenInfo={description:"",methods:[],displayName:"TranscriptionLine"};var Triangle=function Triangle(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("polygon",{points:"50, 12 95, 90 5,90 "}),(0,jsx_runtime.jsx)("ellipse",{cx:"50",cy:"64",rx:"17",ry:"9"})]})};const icons_Triangle=Triangle;Triangle.__docgenInfo={description:"",methods:[],displayName:"Triangle"};var icons={anchoredEllipse:icons_AnchoredEllipse,bezier:icons_Bezier,circle:icons_Circle,column:icons_Column,ellipse:icons_Ellipse,fan:icons_Fan,freehandLine:icons_FreehandLine,freehandSegmentLine:icons_FreehandSegmentLine,freehandSegmentShape:icons_FreehandSegmentShape,freehandShape:icons_FreehandShape,fullHeightLine:icons_FullHeightLine,fullWidthLine:icons_FullWidthLine,grid:icons_Grid,line:icons_Line,point:icons_Point,pointGrid:icons_PointGrid,polygon:icons_Polygon,rectangle:icons_Rectangle,rotateRectangle:icons_RotateRectangle,temporalPoint:icons_Point,temporalRotateRectangle:icons_RotateRectangle,transcriptionLine:icons_TranscriptionLine,triangle:icons_Triangle};const helpers_getIcon=function getIcon(icon){return icons[icon]||function(){return null}};var InputIcon=__webpack_require__("./src/plugins/tasks/components/InputIcon/index.js"),InputStatus=__webpack_require__("./src/plugins/tasks/components/InputStatus/index.js"),TaskInput=__webpack_require__("./src/plugins/tasks/components/TaskInput/index.js"),ToolIcon=function ToolIcon(_ref){var type=_ref.type,Icon=helpers_getIcon(type);return(0,jsx_runtime.jsx)(Blank.h,{viewBox:"0 0 100 100",children:(0,jsx_runtime.jsx)(Icon,{})})},StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"DrawingTask__StyledText",componentId:"sc-oij4rx-0"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]);function DrawingTask(_ref2){var _ref2$disabled=_ref2.disabled,disabled=void 0!==_ref2$disabled&&_ref2$disabled,task=_ref2.task,setActiveTool=task.setActiveTool;return(0,jsx_runtime.jsxs)(Box.a,{children:[(0,jsx_runtime.jsx)(StyledText,{as:"legend",size:"small",children:(0,jsx_runtime.jsx)(Markdownz.Ay,{children:task.instruction})}),task.tools.map(function(tool,index){var checked=task.activeToolIndex===index;return(0,jsx_runtime.jsx)(TaskInput.A,{checked,disabled,index,label:task.strings.get("tools.".concat(index,".label")),labelIcon:(0,jsx_runtime.jsx)(InputIcon.A,{icon:(0,jsx_runtime.jsx)(ToolIcon,{type:tool.type}),color:tool.color}),labelStatus:(0,jsx_runtime.jsx)(InputStatus.A,{count:tool.marks.size,tool}),name:"drawing-tool",onChange:function onChange(event){return function _onChange(index,event){event.target.checked&&setActiveTool(index)}(index,event)},required:task.required,type:"radio"},"".concat(task.taskKey,"_").concat(index))})]})}DrawingTask.propTypes={disabled:prop_types_default().bool,task:prop_types_default().shape({help:prop_types_default().string,instruction:prop_types_default().string,required:prop_types_default().bool,setActiveTool:prop_types_default().func}).isRequired};const components_DrawingTask=(0,mobxreact_esm.PA)(DrawingTask);DrawingTask.__docgenInfo={description:"",methods:[],displayName:"DrawingTask",props:{disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},required:{name:"bool",required:!1},setActiveTool:{name:"func",required:!1}}},required:!0}}}},"./src/plugins/tasks/drawing/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>drawing});var DrawingTask=__webpack_require__("./src/plugins/tasks/drawing/components/DrawingTask.jsx"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),mobx_esm=__webpack_require__("../../node_modules/mobx/dist/mobx.esm.js"),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Task=__webpack_require__("./src/plugins/tasks/models/Task.js"),shownMarks=__webpack_require__("./src/helpers/shownMarks.js"),tools=__webpack_require__("./src/plugins/drawingTools/models/tools/index.js"),marks=__webpack_require__("./src/plugins/drawingTools/models/marks/index.js"),Annotation=__webpack_require__("./src/plugins/tasks/models/Annotation.js"),_excluded=["id"],_excluded2=["annotations"];function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var allDrawingMarks=Object.values(marks),GenericMark=mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,allDrawingMarks),Drawing=mobx_state_tree_module.gK.model("Drawing",{taskType:mobx_state_tree_module.gK.literal("drawing"),value:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.safeReference(GenericMark))}).views(function(self){return{toSnapshot:function toSnapshot(){var snapshot=(0,mobx_state_tree_module.dV)(self),value=(0,mobx_state_tree_module.KE)(models_DrawingTask,(0,mobx_state_tree_module.Zn)(self),self.task).marks.map(function(mark){return(0,mobx_state_tree_module.dV)(mark)}),drawingSnapshot=Object.assign({},snapshot,{value}),drawingAnnotations=[drawingSnapshot];return drawingSnapshot.value.forEach(function(markSnapshot,markIndex){var mark=Object.assign({},markSnapshot);mark.details=mark.annotations.map(function(annotation){return{task:annotation.task}}),mark.annotations.forEach(function(markAnnotation){var finalAnnotation=Object.assign({},markAnnotation,{markIndex}),rest=(finalAnnotation.id,_objectWithoutProperties(finalAnnotation,_excluded));drawingAnnotations.push(rest)});mark.annotations;var rest=_objectWithoutProperties(mark,_excluded2);drawingSnapshot.value[markIndex]=rest}),drawingAnnotations}}});const models_DrawingAnnotation=mobx_state_tree_module.gK.compose("DrawingAnnotation",Annotation.A,Drawing);function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var markModels=Object.values(marks),DrawingTask_GenericMark=mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,markModels),toolModels=Object.values(tools),GenericTool=mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,toolModels),DrawingTask_Drawing=mobx_state_tree_module.gK.model("Drawing",{activeMark:mobx_state_tree_module.gK.safeReference(DrawingTask_GenericMark),activeToolIndex:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),annotation:mobx_state_tree_module.gK.safeReference(models_DrawingAnnotation),shownMarks:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration(Object.keys(shownMarks.A)),shownMarks.A.ALL),hiddenMarkIds:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.string),[]),tools:mobx_state_tree_module.gK.array(GenericTool),type:mobx_state_tree_module.gK.literal("drawing")}).preProcessSnapshot(function(snapshot){var _snapshot$tools,newSnapshot=_objectSpread({},snapshot);return newSnapshot.tools=[],null===(_snapshot$tools=snapshot.tools)||void 0===_snapshot$tools||_snapshot$tools.forEach(function(tool,toolIndex){var toolKey="".concat(snapshot.taskKey,".").concat(toolIndex),toolSnapshot=_objectSpread(_objectSpread({},tool),{},{key:toolKey});newSnapshot.tools.push(toolSnapshot)}),newSnapshot}).views(function(self){return{get activeTool(){return self.tools[self.activeToolIndex]},defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_DrawingAnnotation.create({id,task:self.taskKey,taskType:self.type})},isComplete:function isComplete(){return self.tools.reduce(function(isTaskComplete,tool){return isTaskComplete&&tool.isComplete},!0)},get isValid(){return self.tools.reduce(function(isTaskValid,tool){return isTaskValid&&tool.isValid},!0)},get marks(){return self.tools.reduce(function flattenMarks(allMarks,tool){var toolMarks=Array.from(tool.marks.values());return allMarks.concat(toolMarks)},[])}}}).actions(function(self){function _onLocaleChange(){var stringsSnapshot=(0,mobx_state_tree_module.dV)(self.strings);self.setToolTaskStrings(stringsSnapshot)}function _onToolChange(){self.activeToolIndex>-1&&(self.validate(),self.setActiveMark(void 0))}return{afterCreate:function afterCreate(){(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(_onLocaleChange)),(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(_onToolChange))},setActiveMark:function setActiveMark(mark){self.activeMark=null==mark?void 0:mark.id},setActiveTool:function setActiveTool(toolIndex){self.activeToolIndex=toolIndex},complete:function complete(annotation){self.subTaskVisibility=!1},reset:function reset(){self.tools.forEach(function(tool){return tool.reset()}),self.activeToolIndex=0,self.subTaskVisibility=!1,self.shownMarks===shownMarks.A.NONE&&(self.hiddenMarkIds.clear(),self.shownMarks=shownMarks.A.ALL)},setToolTaskStrings:function setToolTaskStrings(stringsSnapshot){var stringEntries=Object.entries(stringsSnapshot);self.tools.forEach(function(tool,toolIndex){var toolPrefix="tools.".concat(toolIndex);tool.tasks.forEach(function(task,taskIndex){var prefix="".concat(toolPrefix,".details.").concat(taskIndex,"."),taskStrings=stringEntries.filter(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0];_ref2[1];return key.startsWith(prefix)}),taskStringsSnapshot={};taskStrings.forEach(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1],newKey=key.slice(prefix.length);taskStringsSnapshot[newKey]=value});try{(0,mobx_state_tree_module.Nh)(task.strings,taskStringsSnapshot)}catch(error){console.error("".concat(task.taskKey," ").concat(task.type,": could not apply language strings")),console.error(error)}})})},togglePreviousMarks:function togglePreviousMarks(){self.shownMarks=self.shownMarks===shownMarks.A.ALL?shownMarks.A.NONE:shownMarks.A.ALL,self.shownMarks===shownMarks.A.NONE?self.hiddenMarkIds.replace(self.marks.map(function(mark){return mark.id})):self.hiddenMarkIds.clear()},validate:function validate(){self.tools.forEach(function(tool){return tool.validate()})}}});const models_DrawingTask=mobx_state_tree_module.gK.compose("DrawingTask",Task.A,DrawingTask_Drawing),drawing={TaskComponent:DrawingTask.A,TaskModel:models_DrawingTask,AnnotationModel:models_DrawingAnnotation}},"./src/plugins/tasks/dropdown-simple/components/SimpleDropdownTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),grommet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),grommet__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),grommet__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/grommet/es6/components/Select/Select.js"),grommet_icons__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Down.js"),mobx_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),mobx_state_tree__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),prop_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_7__),react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_translations_i18n__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/translations/i18n.jsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var StyledText=(0,styled_components__WEBPACK_IMPORTED_MODULE_9__.default)(grommet__WEBPACK_IMPORTED_MODULE_1__.E).withConfig({displayName:"SimpleDropdownTask__StyledText",componentId:"sc-1m8uzqv-0"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]);function SimpleDropdownTask(_ref){var annotation=_ref.annotation,_ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,task=_ref.task,t=(0,_translations_i18n__WEBPACK_IMPORTED_MODULE_10__.Bd)("plugins").t,value=annotation.value,stringsSnapshot=(0,mobx_state_tree__WEBPACK_IMPORTED_MODULE_6__.dV)(task.strings),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_8__.useState)(""),2),selectedOption=_useState2[0],setSelectedOption=_useState2[1],optionsToDisplay=Object.entries(stringsSnapshot).filter(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0];_ref3[1];return key.startsWith("selects.0.options.*.")}).map(function(_ref4){var _ref5=_slicedToArray(_ref4,2);_ref5[0];return _ref5[1]}),_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_8__.useState)(optionsToDisplay),2),filteredOptions=_useState4[0],setFilteredOptions=_useState4[1];function onSearch(text){var escapedText=text.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),exp=new RegExp(escapedText,"i");setFilteredOptions(optionsToDisplay.filter(function(o){return exp.test(o)}))}return!0===(null==value?void 0:value.option)&&selectedOption!==optionsToDisplay[null==value?void 0:value.selection]&&setSelectedOption(optionsToDisplay[null==value?void 0:value.selection]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsxs)(grommet__WEBPACK_IMPORTED_MODULE_2__.a,{className,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(StyledText,{as:"legend",size:"small",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__.Ay,{children:task.instruction})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(grommet__WEBPACK_IMPORTED_MODULE_2__.a,{gap:"xsmall",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(grommet__WEBPACK_IMPORTED_MODULE_3__.l,{disabled,icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(grommet_icons__WEBPACK_IMPORTED_MODULE_4__.R,{size:"small"}),labelKey:"text",onChange:function onChange(ev){var matchIndex=optionsToDisplay.indexOf(ev.value);setSelectedOption(ev.value),annotation.update({selection:matchIndex,option:!0})},onSearch,onBlur:function onBlur(){onSearch("")},options:filteredOptions,placeholder:t("SimpleDropdownTask.selectPlaceholder"),size:"small",value:selectedOption})})]})}SimpleDropdownTask.propTypes={annotation:prop_types__WEBPACK_IMPORTED_MODULE_7___default().shape({update:prop_types__WEBPACK_IMPORTED_MODULE_7___default().func,value:prop_types__WEBPACK_IMPORTED_MODULE_7___default().object}).isRequired,className:prop_types__WEBPACK_IMPORTED_MODULE_7___default().string,disabled:prop_types__WEBPACK_IMPORTED_MODULE_7___default().bool,task:prop_types__WEBPACK_IMPORTED_MODULE_7___default().shape({allowCreate:prop_types__WEBPACK_IMPORTED_MODULE_7___default().bool,help:prop_types__WEBPACK_IMPORTED_MODULE_7___default().string,instruction:prop_types__WEBPACK_IMPORTED_MODULE_7___default().string,options:prop_types__WEBPACK_IMPORTED_MODULE_7___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_7___default().string),required:prop_types__WEBPACK_IMPORTED_MODULE_7___default().bool}).isRequired};const __WEBPACK_DEFAULT_EXPORT__=(0,mobx_react__WEBPACK_IMPORTED_MODULE_5__.PA)(SimpleDropdownTask);SimpleDropdownTask.__docgenInfo={description:"",methods:[],displayName:"SimpleDropdownTask",props:{className:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},annotation:{description:"",type:{name:"shape",value:{update:{name:"func",required:!1},value:{name:"object",required:!1}}},required:!0},task:{description:"",type:{name:"shape",value:{allowCreate:{name:"bool",required:!1},help:{name:"string",required:!1},instruction:{name:"string",required:!1},options:{name:"arrayOf",value:{name:"string"},required:!1},required:{name:"bool",required:!1}}},required:!0}}}},"./src/plugins/tasks/dropdown-simple/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>dropdown_simple});var SimpleDropdownTask=__webpack_require__("./src/plugins/tasks/dropdown-simple/components/SimpleDropdownTask.jsx"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js");var Task=__webpack_require__("./src/plugins/tasks/models/Task.js"),Annotation=__webpack_require__("./src/plugins/tasks/models/Annotation.js"),presetOption=mobx_state_tree_module.gK.model("SimpleDropdownPresetOption",{selection:mobx_state_tree_module.gK.number,option:mobx_state_tree_module.gK.literal(!0)}),otherOption=mobx_state_tree_module.gK.model("SimpleDropdownOtherOption",{selection:mobx_state_tree_module.gK.string,option:mobx_state_tree_module.gK.literal(!1)}),SimpleDropdown=mobx_state_tree_module.gK.model("SimpleDropdown",{taskType:mobx_state_tree_module.gK.literal("dropdown-simple"),value:mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.union(presetOption,otherOption),null)}).views(function(self){return{get isComplete(){var _self$value,_self$value2,_self$value3;return null!==(_self$value=self.value)&&void 0!==_self$value&&_self$value.option?(null===(_self$value2=self.value)||void 0===_self$value2?void 0:_self$value2.selection)>=0:(null===(_self$value3=self.value)||void 0===_self$value3||null===(_self$value3=_self$value3.selection)||void 0===_self$value3?void 0:_self$value3.length)>0}}});const models_SimpleDropdownAnnotation=mobx_state_tree_module.gK.compose("SimpleDropdownAnnotation",Annotation.A,SimpleDropdown);var MenuOptions=mobx_state_tree_module.gK.refinement("MenuOptions",mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.string),function(value){return value.length>=4&&value.length<=200}),SimpleDropdownTask_SimpleDropdown=mobx_state_tree_module.gK.model("SimpleDropdown",{allowCreate:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),annotation:mobx_state_tree_module.gK.safeReference(models_SimpleDropdownAnnotation),options:MenuOptions,type:mobx_state_tree_module.gK.literal("dropdown-simple")}).preProcessSnapshot(function(snapshot){return function legacyDropdownAdapter(snapshot){var newSnapshot={},selects=snapshot.selects;if(1===(null==selects?void 0:selects.length)){var menu=selects[0];newSnapshot.allowCreate=menu.allowCreate,newSnapshot.help=snapshot.help,newSnapshot.instruction=snapshot.instruction,newSnapshot.required=menu.required,newSnapshot.taskKey=snapshot.taskKey,newSnapshot.type="dropdown-simple";var options=menu.options["*"];return newSnapshot.options=options.map(function(option){return option.label}),newSnapshot}return snapshot}(snapshot)}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_SimpleDropdownAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const models_SimpleDropdownTask=mobx_state_tree_module.gK.compose("SimpleDropdownTask",Task.A,SimpleDropdownTask_SimpleDropdown),dropdown_simple={TaskComponent:SimpleDropdownTask.A,TaskModel:models_SimpleDropdownTask,AnnotationModel:models_SimpleDropdownAnnotation}},"./src/plugins/tasks/experimental/geoDrawing/task/models/GeoDrawingAnnotation.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),_models_Annotation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/plugins/tasks/models/Annotation.js"),GeoDrawing=mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.model("GeoDrawing",{taskType:mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.literal("geoDrawing"),value:mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.optional(mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.array(mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.frozen()),[])}).views(function(self){return{get isComplete(){return self.value.length>0}}});const __WEBPACK_DEFAULT_EXPORT__=mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.compose("GeoDrawingAnnotation",_models_Annotation__WEBPACK_IMPORTED_MODULE_1__.A,GeoDrawing)},"./src/plugins/tasks/experimental/geoDrawing/task/models/GeoDrawingTask.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>models_GeoDrawingTask});var models_namespaceObject={};__webpack_require__.r(models_namespaceObject),__webpack_require__.d(models_namespaceObject,{PointTool:()=>PointTool_PointTool});var cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Task=__webpack_require__("./src/plugins/tasks/models/Task.js"),GeoDrawingAnnotation=__webpack_require__("./src/plugins/tasks/experimental/geoDrawing/task/models/GeoDrawingAnnotation.js");const PointTool_PointTool=mobx_state_tree_module.gK.model("PointTool",{color:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),label:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),type:mobx_state_tree_module.gK.literal("Point"),uncertainty_circle:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1)});var toolModels=Object.values(models_namespaceObject),GenericTool=mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,toolModels),GeoDrawing=mobx_state_tree_module.gK.model("GeoDrawing",{annotation:mobx_state_tree_module.gK.safeReference(GeoDrawingAnnotation.A),required:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.union(mobx_state_tree_module.gK.string,mobx_state_tree_module.gK.boolean)),tools:mobx_state_tree_module.gK.array(GenericTool),type:mobx_state_tree_module.gK.literal("geoDrawing")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return GeoDrawingAnnotation.A.create({id,task:self.taskKey,taskType:self.type,value:[]})}}});const models_GeoDrawingTask=mobx_state_tree_module.gK.compose("GeoDrawingTask",Task.A,GeoDrawing)},"./src/plugins/tasks/experimental/highlighter/components/HighlighterTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_HighlighterTask});var Text=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),Button=__webpack_require__("../../node_modules/grommet/es6/components/Button/Button.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),i18n=__webpack_require__("./src/translations/i18n.jsx"),Markdownz=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js");function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]}},e:function e(r){throw r},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function s(){t=t.call(r)},n:function n(){var r=t.next();return a=r.done,r},e:function e(r){u=!0,o=r},f:function f(){try{a||null==t.return||t.return()}finally{if(u)throw o}}}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"HighlighterTask__StyledText",componentId:"sc-hafdol-0"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]),StyledLabelColor=styled_components_browser_esm.default.span.withConfig({displayName:"HighlighterTask__StyledLabelColor",componentId:"sc-hafdol-1"})(["align-self:center;background-color:",";border-radius:3px;height:1.8em;margin:0 .8em;width:40px;"],function(props){return props.color}),StyledButton=(0,styled_components_browser_esm.default)(Button.$).withConfig({displayName:"HighlighterTask__StyledButton",componentId:"sc-hafdol-2"})([""," border-radius:4px;margin-bottom:.8em;margin-top:.8em;box-shadow:1px 1px 4px rgba(0,0,0,0.25);&:hover{","  box-shadow:1px 1px 4px rgba(0,0,0,0.25);}&:active{background:",";"," box-shadow:1px 1px 4px rgba(0,0,0,0.25);color:white;}&:focus:not(:focus-visible){box-shadow:1px 1px 4px rgba(0,0,0,0.25);}"],function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["background:",";border:2px solid ",";color:white;"],props.theme.global.colors["dark-4"],props.theme.global.colors["light-1"]):(0,styled_components_browser_esm.css)(["background:",";border:none;"],props.theme.global.colors["light-1"])},function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["background:",";border:2px solid ",";"],props.theme.global.colors["neutral-1"],props.theme.global.colors["light-1"]):(0,styled_components_browser_esm.css)(["background:linear-gradient(180deg,"," 0%,"," 100%);border:none;"],props.theme.global.colors["light-2"],props.theme.global.colors["accent-1"])},function(props){return props.theme.global.colors.brand},function(props){return props.theme.dark?(0,styled_components_browser_esm.css)(["border:2px solid ",";"],props.theme.global.colors["light-1"]):(0,styled_components_browser_esm.css)(["border:1px solid ",";"],props.theme.global.colors["light-5"])});function StyledButtonLabel(_ref){var color=_ref.color,_ref$count=_ref.count,count=void 0===_ref$count?0:_ref$count,label=_ref.label,status=(0,(0,i18n.Bd)("plugins").t)("HighlighterTask.status",{count});return(0,jsx_runtime.jsxs)(Box.a,{align:"center",as:"span",direction:"row",children:[(0,jsx_runtime.jsx)(StyledLabelColor,{color}),(0,jsx_runtime.jsxs)(Box.a,{fill:"horizontal",direction:"row",justify:"between",margin:{left:"small"},children:[(0,jsx_runtime.jsx)(Text.E,{size:"16px",textAlign:"start",children:label}),(0,jsx_runtime.jsx)(Text.E,{color:{dark:count?"inherit":"dark-5",light:count?"inherit":"light-4"},children:status})]})]})}function HighlighterTask(_ref2){var annotation=_ref2.annotation,_ref2$disabled=_ref2.disabled,disabled=void 0!==_ref2$disabled&&_ref2$disabled,task=_ref2.task,t=(0,i18n.Bd)("plugins").t;function createLabelAnnotation(selection,labelIndex){var range=selection.getRangeAt(0),offset=function getOffset(selection){var _step,anchorNode=selection.anchorNode,start=0,_iterator=_createForOfIteratorHelper(anchorNode.parentNode.childNodes);try{for(_iterator.s();!(_step=_iterator.n()).done;){var node=_step.value;if(8!==node.nodeType&&node!==anchorNode){var text=node.getAttribute?node.getAttribute("data-selection"):node.textContent;start+=(null==text?void 0:text.length)||0}if(node===anchorNode)break}}catch(err){_iterator.e(err)}finally{_iterator.f()}return start}(selection),start=offset+range.startOffset,end=offset+range.endOffset-1,labelInformation=(0,mobx_state_tree_module.dV)(task.highlighterLabels[labelIndex]),selectable=function selectableArea(selection,range,offset,start,end){var _selection$anchorNode,spansNodes=range.startContainer!==range.endContainer,noAreaSelected=start===end,subjectSelection=null===(_selection$anchorNode=selection.anchorNode.parentNode.parentNode)||void 0===_selection$anchorNode||null===(_selection$anchorNode=_selection$anchorNode.getAttribute("aria-label"))||void 0===_selection$anchorNode?void 0:_selection$anchorNode.startsWith("Subject");return!spansNodes&&!noAreaSelected&&subjectSelection}(selection,range,0,start,end);if(selectable){var newValue=Array.from(annotation.value);newValue.push({labelInformation,start,end,text:range.toString()}),annotation.update(newValue)}selection.collapseToEnd()}function handleClick(event,index){var selection=document.getSelection();return selection.rangeCount&&selection.getRangeAt(0).toString().length&&createLabelAnnotation(selection,index),null}return(0,jsx_runtime.jsxs)(Box.a,{direction:"column",children:[(0,jsx_runtime.jsx)(StyledText,{as:"legend",size:"small",children:(0,jsx_runtime.jsx)(Markdownz.Ay,{children:task.instruction})}),task.highlighterLabels?task.highlighterLabels.map(function(label,index){var count=annotation.value.filter(function(value){return value.labelInformation.label===label.label}).length;return(0,jsx_runtime.jsx)(StyledButton,{disabled,label:(0,jsx_runtime.jsx)(StyledButtonLabel,{color:label.color,count,label:task.strings.get("highlighterLabels.".concat(index,".label"))}),name:"highlighter-label",onClick:function onClick(event){return handleClick(0,index)},onTouchEnd:function onTouchEnd(event){event.preventDefault(),handleClick(0,index)}},"".concat(task.taskKey,"_").concat(index))}):(0,jsx_runtime.jsx)("span",{children:t("HighlighterTask.noLabels")})]})}HighlighterTask.propTypes={annotation:prop_types_default().shape({update:prop_types_default().func,value:prop_types_default().array}).isRequired,disabled:prop_types_default().bool,task:prop_types_default().shape({help:prop_types_default().string,instruction:prop_types_default().string,required:prop_types_default().bool,taskKey:prop_types_default().string,type:prop_types_default().string}).isRequired};const components_HighlighterTask=(0,mobxreact_esm.PA)(HighlighterTask);HighlighterTask.__docgenInfo={description:"",methods:[],displayName:"HighlighterTask",props:{disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},annotation:{description:"",type:{name:"shape",value:{update:{name:"func",required:!1},value:{name:"array",required:!1}}},required:!0},task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},required:{name:"bool",required:!1},taskKey:{name:"string",required:!1},type:{name:"string",required:!1}}},required:!0}}}},"./src/plugins/tasks/experimental/textFromSubject/components/TextFromSubjectTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>TextFromSubjectTask});var grommet__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),grommet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet/es6/components/TextArea/TextArea.js"),grommet__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),prop_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_3__),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/react/index.js"),_translations_i18n__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/translations/i18n.jsx"),styled_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),_zooniverse_react_components_PrimaryButton__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../lib-react-components/dist/esm/PrimaryButton/PrimaryButton.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledText=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.default)(grommet__WEBPACK_IMPORTED_MODULE_0__.E).withConfig({displayName:"TextFromSubjectTask__StyledText",componentId:"sc-rujl32-0"})(["display:block;margin:10px 0;"]),StyledTextArea=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.default)(grommet__WEBPACK_IMPORTED_MODULE_1__.f).withConfig({displayName:"TextFromSubjectTask__StyledTextArea",componentId:"sc-rujl32-1"})(["font-family:'Anonymous Pro',monospace;@font-face{font-family:'Anonymous Pro';font-style:normal;font-weight:400;src:local('Anonymous Pro'),local('Anonymous Pro-Regular'),url(https://fonts.gstatic.com/s/anonymouspro/v21/rP2Bp2a15UIB7Un-bOeISG3pHls29QP-4Ks.woff2)  format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}"]);function TextFromSubjectTask(_ref){var _ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$isChanged=_ref.isChanged,isChanged=void 0!==_ref$isChanged&&_ref$isChanged,_ref$resetToSubject=_ref.resetToSubject,resetToSubject=void 0===_ref$resetToSubject?function(){return!0}:_ref$resetToSubject,task=_ref.task,_ref$updateAnnotation=_ref.updateAnnotation,updateAnnotation=void 0===_ref$updateAnnotation?function(){return!0}:_ref$updateAnnotation,value=_ref.value,textArea=(0,react__WEBPACK_IMPORTED_MODULE_4__.useRef)(),t=(0,_translations_i18n__WEBPACK_IMPORTED_MODULE_5__.Bd)("plugins").t;var components={a:StyledText,h1:StyledText,h2:StyledText,h3:StyledText,h4:StyledText,h5:StyledText,h6:StyledText,p:StyledText,span:grommet__WEBPACK_IMPORTED_MODULE_0__.E};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(grommet__WEBPACK_IMPORTED_MODULE_2__.a,{direction:"column",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("label",{htmlFor:"".concat(task.taskKey,"-").concat(task.type),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_7__.Ay,{components,children:task.instruction}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(StyledTextArea,{ref:textArea,autoFocus,disabled,id:"".concat(task.taskKey,"-").concat(task.type),rows:(null==value?void 0:value.split(/\r\n|\r|\n/).length)+3,value,onChange:function onChange(){updateAnnotation(textArea)}})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_zooniverse_react_components_PrimaryButton__WEBPACK_IMPORTED_MODULE_8__.A,{color:"teal",disabled:disabled||!isChanged,label:t("TextFromSubjectTask.reset"),onClick:function onClick(){return resetToSubject()}})]})}TextFromSubjectTask.propTypes={autoFocus:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,disabled:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,isChanged:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,resetToSubject:prop_types__WEBPACK_IMPORTED_MODULE_3___default().func,task:prop_types__WEBPACK_IMPORTED_MODULE_3___default().shape({help:prop_types__WEBPACK_IMPORTED_MODULE_3___default().string,instruction:prop_types__WEBPACK_IMPORTED_MODULE_3___default().string,required:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,taskKey:prop_types__WEBPACK_IMPORTED_MODULE_3___default().string,text_tags:prop_types__WEBPACK_IMPORTED_MODULE_3___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_3___default().string),type:prop_types__WEBPACK_IMPORTED_MODULE_3___default().string}).isRequired,updateAnnotation:prop_types__WEBPACK_IMPORTED_MODULE_3___default().func,value:prop_types__WEBPACK_IMPORTED_MODULE_3___default().string.isRequired},TextFromSubjectTask.__docgenInfo={description:"",methods:[],displayName:"TextFromSubjectTask",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},isChanged:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},resetToSubject:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},updateAnnotation:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},required:{name:"bool",required:!1},taskKey:{name:"string",required:!1},text_tags:{name:"arrayOf",value:{name:"string"},required:!1},type:{name:"string",required:!1}}},required:!0},value:{description:"",type:{name:"string"},required:!0}}}},"./src/plugins/tasks/experimental/volumetric/components/VolumetricTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var prop_types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/prop-types/index.js"),grommet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),grommet__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),grommet_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Blank.js"),_components_InputStatus__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/plugins/tasks/components/InputStatus/index.js"),_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),mobx_react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),styled_components__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_components_TaskInput__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/plugins/tasks/components/TaskInput/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),SVG_ARROW="48 50, 48 15, 40 15, 50 0, 60 15, 52 15, 52 50",StyledInstructionText=(0,styled_components__WEBPACK_IMPORTED_MODULE_7__.default)(grommet__WEBPACK_IMPORTED_MODULE_1__.E).withConfig({displayName:"VolumetricTask__StyledInstructionText",componentId:"sc-uuki5g-0"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]),StyledToolIcon=styled_components__WEBPACK_IMPORTED_MODULE_7__.default.div.withConfig({displayName:"VolumetricTask__StyledToolIcon",componentId:"sc-uuki5g-1"})(["background-color:#2d2d2d;display:flex;align-items:center;padding:15px;> svg{height:1.5em;width:1.5em;}"]);function VolumetricTask(_ref){var annotation=_ref.annotation,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,task=_ref.task;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(grommet__WEBPACK_IMPORTED_MODULE_2__.a,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(StyledInstructionText,{as:"legend",size:"small",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_5__.Ay,{children:task.instruction})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_components_TaskInput__WEBPACK_IMPORTED_MODULE_8__.A,{checked:!0,disabled,index:0,label:"3D Viewer",labelIcon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(StyledToolIcon,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(grommet_icons__WEBPACK_IMPORTED_MODULE_3__.h,{viewBox:"0 0 100 100",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("polygon",{points:SVG_ARROW,fill:"blue",transform:"rotate(0 50 50)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("polygon",{points:SVG_ARROW,fill:"green",transform:"rotate(135 50 50)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("polygon",{points:SVG_ARROW,fill:"red",transform:"rotate(225 50 50)"})]})}),labelStatus:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_components_InputStatus__WEBPACK_IMPORTED_MODULE_4__.A,{count:annotation.value.length}),name:"volumetric-tool",type:"radio"})]})}VolumetricTask.propTypes={annotation:prop_types__WEBPACK_IMPORTED_MODULE_0__.object,disabled:prop_types__WEBPACK_IMPORTED_MODULE_0__.bool,task:(0,prop_types__WEBPACK_IMPORTED_MODULE_0__.shape)({instruction:prop_types__WEBPACK_IMPORTED_MODULE_0__.string})};const __WEBPACK_DEFAULT_EXPORT__=(0,mobx_react__WEBPACK_IMPORTED_MODULE_6__.PA)(VolumetricTask);VolumetricTask.__docgenInfo={description:"",methods:[],displayName:"VolumetricTask",props:{disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"custom",raw:"bool"},required:!1},annotation:{description:"",type:{name:"custom",raw:"object"},required:!1},task:{description:"",type:{name:"shape",value:{instruction:{name:"string",required:!1}}},required:!1}}}},"./src/plugins/tasks/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{dataVisAnnotation:()=>dataVisAnnotation,drawing:()=>drawing.A,dropdownSimple:()=>dropdown_simple.A,geoDrawing:()=>task,highlighter:()=>highlighter,multiple:()=>multiple.A,single:()=>single.A,subjectGroupComparison:()=>subjectGroupComparison,survey:()=>survey.A,text:()=>tasks_text.A,textFromSubject:()=>textFromSubject,transcription:()=>transcription,volumetric:()=>volumetric});var DataVisAnnotationTask=__webpack_require__("./src/plugins/tasks/dataVisAnnotation/components/DataVisAnnotationTask.jsx"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Task=__webpack_require__("./src/plugins/tasks/models/Task.js");const dataVisTools_Graph2dRangeXTool=mobx_state_tree_module.gK.model("Graph2dRangeXTool",{help:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),label:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),max:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),type:mobx_state_tree_module.gK.literal("graph2dRangeX")});var Annotation=__webpack_require__("./src/plugins/tasks/models/Annotation.js");const DataVisToolAnnotations_Graph2dRangeXAnnotation=mobx_state_tree_module.gK.model("Graph2dRangeXAnnotation",{tool:mobx_state_tree_module.gK.number,toolType:mobx_state_tree_module.gK.string,x:mobx_state_tree_module.gK.number,width:mobx_state_tree_module.gK.number,zoomLevelOnCreation:mobx_state_tree_module.gK.number});var DataVis=mobx_state_tree_module.gK.model("DataVis",{taskType:mobx_state_tree_module.gK.literal("dataVisAnnotation"),value:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.union({dispatcher:function dispatcher(snapshot){if("graph2dRangeX"===snapshot.toolType)return DataVisToolAnnotations_Graph2dRangeXAnnotation}},DataVisToolAnnotations_Graph2dRangeXAnnotation))});const models_DataVisAnnotation=mobx_state_tree_module.gK.compose("DataVisAnnotation",Annotation.A,DataVis);var DataVisTaskModel=mobx_state_tree_module.gK.model("DataVisTaskModel",{activeToolIndex:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),annotation:mobx_state_tree_module.gK.safeReference(models_DataVisAnnotation),tools:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.union({dispatcher:function dispatcher(snapshot){if("graph2dRangeX"===snapshot.type)return dataVisTools_Graph2dRangeXTool}},dataVisTools_Graph2dRangeXTool)),type:mobx_state_tree_module.gK.literal("dataVisAnnotation")}).views(function(self){return{get activeTool(){return self.tools[self.activeToolIndex]},defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_DataVisAnnotation.create({id,task:self.taskKey,taskType:self.type})}}}).actions(function(self){return{reset:function reset(){self.activeToolIndex=0},setActiveTool:function setActiveTool(toolIndex){self.activeToolIndex=toolIndex}}});const models_DataVisAnnotationTask=mobx_state_tree_module.gK.compose("DataVisAnnotationTask",Task.A,DataVisTaskModel),dataVisAnnotation={TaskComponent:DataVisAnnotationTask.A,TaskModel:models_DataVisAnnotationTask,AnnotationModel:models_DataVisAnnotation};var drawing=__webpack_require__("./src/plugins/tasks/drawing/index.js"),dropdown_simple=__webpack_require__("./src/plugins/tasks/dropdown-simple/index.js"),multiple=__webpack_require__("./src/plugins/tasks/multiple/index.js"),single=__webpack_require__("./src/plugins/tasks/single/index.js"),Markdownz=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),Text=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledBox=(0,styled_components_browser_esm.default)(Box.a).withConfig({displayName:"SubjectGroupComparisonTask__StyledBox",componentId:"sc-atr3sa-0"})(["img:only-child,svg:only-child{"," max-width:3.75rem;}"],function(props){return props.theme&&(0,styled_components_browser_esm.css)(["background:",";"],props.theme.global.colors.brand)}),StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"SubjectGroupComparisonTask__StyledText",componentId:"sc-atr3sa-1"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]);function SubjectGroupComparisonTask(props){var annotation=props.annotation,_props$className=props.className,className=void 0===_props$className?"":_props$className,_props$disabled=props.disabled,disabled=void 0!==_props$disabled&&_props$disabled,task=props.task,_props$theme=props.theme,theme=void 0===_props$theme?{global:{colors:{}}}:_props$theme;annotation.value;return(0,jsx_runtime.jsx)(StyledBox,{className,disabled,theme,children:(0,jsx_runtime.jsx)(StyledText,{as:"legend",size:"small",children:(0,jsx_runtime.jsx)(Markdownz.Ay,{children:task.question})})})}SubjectGroupComparisonTask.propTypes={annotation:(0,prop_types.shape)({value:prop_types.array}).isRequired,className:prop_types.string,disabled:prop_types.bool,task:(0,prop_types.shape)({answers:(0,prop_types.arrayOf)((0,prop_types.shape)({label:prop_types.string})),help:prop_types.string,question:prop_types.string,required:prop_types.bool}).isRequired,theme:prop_types.object};const components_SubjectGroupComparisonTask=SubjectGroupComparisonTask;SubjectGroupComparisonTask.__docgenInfo={description:"",methods:[],displayName:"SubjectGroupComparisonTask",props:{annotation:{description:"",type:{name:"shape",value:{value:{name:"array",required:!1}}},required:!0},className:{description:"",type:{name:"custom",raw:"string"},required:!1},disabled:{description:"",type:{name:"custom",raw:"bool"},required:!1},task:{description:"",type:{name:"shape",value:{answers:{name:"arrayOf",value:{name:"shape",value:{label:{name:"string",required:!1}}},required:!1},help:{name:"string",required:!1},question:{name:"string",required:!1},required:{name:"bool",required:!1}}},required:!0},theme:{description:"",type:{name:"custom",raw:"object"},required:!1}}};var tasks_text=__webpack_require__("./src/plugins/tasks/text/index.js"),AnnotationsStore=__webpack_require__("./src/store/AnnotationsStore.js"),_excluded=["id","annotations"];function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var CellAnnotationsStore=mobx_state_tree_module.gK.model("CellAnnotationsStore",{id:mobx_state_tree_module.gK.identifier,index:mobx_state_tree_module.gK.number,subject:mobx_state_tree_module.gK.string,annotations:mobx_state_tree_module.gK.map(mobx_state_tree_module.gK.union(single.A.AnnotationModel,multiple.A.AnnotationModel,tasks_text.A.AnnotationModel,dropdown_simple.A.AnnotationModel))}).preProcessSnapshot(function(snapshot){var newSnapshot=function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({},snapshot);if(newSnapshot.id=snapshot.id||cuid_default()(),snapshot.annotations&&Array.isArray(snapshot.annotations)){var annotations={};snapshot.annotations.forEach(function(annotation){annotation.id=annotation.id||cuid_default()(),annotations[annotation.id]=annotation}),newSnapshot.annotations=annotations}return newSnapshot}).postProcessSnapshot(function(snapshot){snapshot.id;var annotations=snapshot.annotations,newSnapshot=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(snapshot,_excluded);if(annotations){var annotationsArray=Object.values(annotations);annotationsArray.length>0&&(newSnapshot.annotations=annotationsArray)}return newSnapshot});const models_CellAnnotationsStore=mobx_state_tree_module.gK.compose("CellWithAnnotations",AnnotationsStore.A,CellAnnotationsStore);var SubjectGroupComparisonAnnotation_excluded=["annotations"],_excluded2=["id"];function SubjectGroupComparisonAnnotation_typeof(o){return SubjectGroupComparisonAnnotation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},SubjectGroupComparisonAnnotation_typeof(o)}function SubjectGroupComparisonAnnotation_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function SubjectGroupComparisonAnnotation_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}function SubjectGroupComparisonAnnotation_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function SubjectGroupComparisonAnnotation_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?SubjectGroupComparisonAnnotation_ownKeys(Object(t),!0).forEach(function(r){SubjectGroupComparisonAnnotation_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):SubjectGroupComparisonAnnotation_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function SubjectGroupComparisonAnnotation_defineProperty(e,r,t){return(r=function SubjectGroupComparisonAnnotation_toPropertyKey(t){var i=function SubjectGroupComparisonAnnotation_toPrimitive(t,r){if("object"!=SubjectGroupComparisonAnnotation_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=SubjectGroupComparisonAnnotation_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==SubjectGroupComparisonAnnotation_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var SubjectGroupComparison=mobx_state_tree_module.gK.model("SubjectGroupComparison",{taskType:mobx_state_tree_module.gK.literal("subjectGroupComparison"),value:mobx_state_tree_module.gK.array(models_CellAnnotationsStore)}).views(function(self){return{get isComplete(){return self.value.length>0},getCellByIndex:function getCellByIndex(index){return self.value.find(function(cell){return cell.index===index})},toSnapshot:function toSnapshot(){var snapshot=(0,mobx_state_tree_module.dV)(self),value=self.value.map(function(cell){return(0,mobx_state_tree_module.dV)(cell)}),comparisonSnapshot=SubjectGroupComparisonAnnotation_objectSpread(SubjectGroupComparisonAnnotation_objectSpread({},snapshot),{},{value}),allAnnotations=[comparisonSnapshot];return comparisonSnapshot.value.forEach(function(cellSnapshot,cellIndex){var annotations=cellSnapshot.annotations,cellWithoutAnnotations=SubjectGroupComparisonAnnotation_objectWithoutProperties(cellSnapshot,SubjectGroupComparisonAnnotation_excluded);annotations&&annotations.length>0&&(cellWithoutAnnotations.details=annotations.map(function(annotation){return{task:annotation.task}}),annotations.forEach(function(cellAnnotation){cellAnnotation.id;var annotationWithoutId=SubjectGroupComparisonAnnotation_objectWithoutProperties(cellAnnotation,_excluded2);allAnnotations.push(SubjectGroupComparisonAnnotation_objectSpread(SubjectGroupComparisonAnnotation_objectSpread({},annotationWithoutId),{},{cellIndex}))})),comparisonSnapshot.value[cellIndex]=cellWithoutAnnotations}),allAnnotations}}}).actions(function(self){return{addCell:function addCell(index,subjectId){var cell=models_CellAnnotationsStore.create({id:cuid_default()(),index,subject:subjectId,annotations:{}});return self.value.push(cell),self._inProgress=!0,cell},removeCell:function removeCell(index){var cellIndex=self.value.findIndex(function(cell){return cell.index===index});cellIndex>-1&&(self.value.splice(cellIndex,1),self._inProgress=!0)}}});const models_SubjectGroupComparisonAnnotation=mobx_state_tree_module.gK.compose("SubjectGroupComparisonAnnotation",Annotation.A,SubjectGroupComparison);var SubjectGroupComparisonTask_SubjectGroupComparison=mobx_state_tree_module.gK.model("SubjectGroupComparison",{annotation:mobx_state_tree_module.gK.safeReference(models_SubjectGroupComparisonAnnotation),type:mobx_state_tree_module.gK.literal("subjectGroupComparison")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_SubjectGroupComparisonAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const subjectGroupComparison={TaskComponent:components_SubjectGroupComparisonTask,TaskModel:mobx_state_tree_module.gK.compose("SubjectGroupComparisonTask",Task.A,SubjectGroupComparisonTask_SubjectGroupComparison),AnnotationModel:models_SubjectGroupComparisonAnnotation};var survey=__webpack_require__("./src/plugins/tasks/survey/index.js"),HighlighterTask=__webpack_require__("./src/plugins/tasks/experimental/highlighter/components/HighlighterTask.jsx");const models_HighlighterLabel=mobx_state_tree_module.gK.model("HighlighterLabel",{color:mobx_state_tree_module.gK.string,label:mobx_state_tree_module.gK.string});var Highlight=mobx_state_tree_module.gK.model("Highlight",{start:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),end:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),text:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),labelInformation:mobx_state_tree_module.gK.optional(models_HighlighterLabel,{color:"",label:""})}),Highlighter=mobx_state_tree_module.gK.model("Highlighter",{taskType:mobx_state_tree_module.gK.literal("highlighter"),value:mobx_state_tree_module.gK.array(Highlight)}).views(function(self){return{get isComplete(){return self.value.length>0}}}).actions(function(self){return{deleteHighlight:function deleteHighlight(index){self.value.splice(index,1)}}});const models_HighlighterAnnotation=mobx_state_tree_module.gK.compose("HighlighterAnnotation",Annotation.A,Highlighter);var HighlighterTask_Highlighter=mobx_state_tree_module.gK.model("Highlighter",{annotation:mobx_state_tree_module.gK.safeReference(models_HighlighterAnnotation),highlighterLabels:mobx_state_tree_module.gK.array(models_HighlighterLabel),type:mobx_state_tree_module.gK.literal("highlighter")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_HighlighterAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const models_HighlighterTask=mobx_state_tree_module.gK.compose("HighlighterTask",Task.A,HighlighterTask_Highlighter),highlighter={TaskComponent:HighlighterTask.A,TaskModel:models_HighlighterTask,AnnotationModel:models_HighlighterAnnotation};var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js");function GeoDrawingTask(_ref){var _task$tools,task=_ref.task,instruction=(null==task?void 0:task.instruction)||"",toolLabel=(null==task||null===(_task$tools=task.tools)||void 0===_task$tools||null===(_task$tools=_task$tools[0])||void 0===_task$tools?void 0:_task$tools.label)||"";return(0,jsx_runtime.jsxs)("div",{children:[instruction?(0,jsx_runtime.jsx)("p",{children:instruction}):null,(0,jsx_runtime.jsxs)("p",{children:[toolLabel,": tool placeholder"]})]})}GeoDrawingTask.propTypes={task:(0,prop_types.shape)({instruction:prop_types.string,tools:(0,prop_types.arrayOf)((0,prop_types.shape)({label:prop_types.string,max:(0,prop_types.oneOfType)([prop_types.string,prop_types.number]),min:(0,prop_types.oneOfType)([prop_types.string,prop_types.number]),type:prop_types.string}))})};const components_GeoDrawingTask=(0,mobxreact_esm.PA)(GeoDrawingTask);GeoDrawingTask.__docgenInfo={description:"",methods:[],displayName:"GeoDrawingTask",props:{task:{description:"",type:{name:"shape",value:{instruction:{name:"string",required:!1},tools:{name:"arrayOf",value:{name:"shape",value:{label:{name:"string",required:!1},max:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},min:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},type:{name:"string",required:!1}}},required:!1}}},required:!1}}};var models_GeoDrawingTask=__webpack_require__("./src/plugins/tasks/experimental/geoDrawing/task/models/GeoDrawingTask.js"),GeoDrawingAnnotation=__webpack_require__("./src/plugins/tasks/experimental/geoDrawing/task/models/GeoDrawingAnnotation.js");const task={TaskComponent:components_GeoDrawingTask,TaskModel:models_GeoDrawingTask.A,AnnotationModel:GeoDrawingAnnotation.A};var async_states=__webpack_require__("../lib-async-states/src/async-states.js"),async_states_default=__webpack_require__.n(async_states),hooks=__webpack_require__("./src/hooks/index.js"),TextFromSubjectTask=__webpack_require__("./src/plugins/tasks/experimental/textFromSubject/components/TextFromSubjectTask.jsx");function TextFromSubjectContainer(_ref){var annotation=_ref.annotation,_ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$disabled=_ref.disabled,disabled=void 0===_ref$disabled||_ref$disabled,subject=_ref.subject,task=_ref.task,initializedFromSubject=annotation.initializedFromSubject,value=annotation.value,textDataLoadingState=async_states_default().initialized,_useSubjectText=(0,hooks.XW)({subject}),textData=_useSubjectText.data,loading=_useSubjectText.loading,error=_useSubjectText.error;!loading&&textData&&(textDataLoadingState=async_states_default().success),!loading&&error&&(textDataLoadingState=async_states_default().error,console.error(error)),initializedFromSubject||textDataLoadingState!==async_states_default().success||annotation.updateFromSubject(textData);var isChanged=initializedFromSubject&&value!==textData;return(0,jsx_runtime.jsx)(TextFromSubjectTask.A,{autoFocus,disabled:disabled||!initializedFromSubject,isChanged,resetToSubject:function resetToSubject(){annotation.update(textData)},task,updateAnnotation:function updateAnnotation(ref){var currentRef=ref.current;if(currentRef&&annotation){var text=currentRef.value;annotation.update(text)}},value})}TextFromSubjectContainer.propTypes={annotation:prop_types_default().shape({update:prop_types_default().func,value:prop_types_default().string}).isRequired,autoFocus:prop_types_default().bool,disabled:prop_types_default().bool,subject:prop_types_default().shape({id:prop_types_default().string}).isRequired,task:prop_types_default().shape({help:prop_types_default().string,instruction:prop_types_default().string,type:prop_types_default().string}).isRequired};const components_TextFromSubjectContainer=(0,mobxreact_esm.PA)(TextFromSubjectContainer);TextFromSubjectContainer.__docgenInfo={description:"",methods:[],displayName:"TextFromSubjectContainer",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},disabled:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},annotation:{description:"",type:{name:"shape",value:{update:{name:"func",required:!1},value:{name:"string",required:!1}}},required:!0},subject:{description:"",type:{name:"shape",value:{id:{name:"string",required:!1}}},required:!0},task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},type:{name:"string",required:!1}}},required:!0}}};var TextFromSubject=mobx_state_tree_module.gK.model("TextFromSubject",{taskType:mobx_state_tree_module.gK.literal("textFromSubject"),value:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"")}).volatile(function(self){return{initializedFromSubject:!1}}).views(function(self){return{get isComplete(){return self.initializedFromSubject&&""!==self.value}}}).actions(function(self){return{updateFromSubject:function updateFromSubject(value){self.initializedFromSubject=!0,self.value=value}}});const models_TextFromSubjectAnnotation=mobx_state_tree_module.gK.compose("TextFromSubjectAnnotation",Annotation.A,TextFromSubject);var TextFromSubjectTask_TextFromSubject=mobx_state_tree_module.gK.model("TextFromSubject",{annotation:mobx_state_tree_module.gK.safeReference(models_TextFromSubjectAnnotation),type:mobx_state_tree_module.gK.literal("textFromSubject")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_TextFromSubjectAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const textFromSubject={TaskComponent:components_TextFromSubjectContainer,TaskModel:mobx_state_tree_module.gK.compose("TextFromSubjectTask",Task.A,TextFromSubjectTask_TextFromSubject),AnnotationModel:models_TextFromSubjectAnnotation};var shownMarks=__webpack_require__("./src/helpers/shownMarks.js"),tools=__webpack_require__("./src/plugins/drawingTools/models/tools/index.js"),marks=__webpack_require__("./src/plugins/drawingTools/models/marks/index.js"),TranscriptionAnnotation_excluded=["id"],TranscriptionAnnotation_excluded2=["annotations"];function TranscriptionAnnotation_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function TranscriptionAnnotation_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var Transcription=mobx_state_tree_module.gK.model("Transcription",{taskType:mobx_state_tree_module.gK.literal("transcription"),value:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.safeReference(marks.TranscriptionLine))}).views(function(self){return{toSnapshot:function toSnapshot(){var snapshot=(0,mobx_state_tree_module.dV)(self),value=(0,mobx_state_tree_module.KE)(models_TranscriptionTask,(0,mobx_state_tree_module.Zn)(self),self.task).marks.map(function(mark){return(0,mobx_state_tree_module.dV)(mark)}),drawingSnapshot=Object.assign({},snapshot,{value}),drawingAnnotations=[drawingSnapshot];return drawingSnapshot.value.forEach(function(markSnapshot,markIndex){var mark=Object.assign({},markSnapshot);mark.details=mark.annotations.map(function(annotation){return{task:annotation.task}}),mark.annotations.forEach(function(markAnnotation){var finalAnnotation=Object.assign({},markAnnotation,{markIndex}),rest=(finalAnnotation.id,TranscriptionAnnotation_objectWithoutProperties(finalAnnotation,TranscriptionAnnotation_excluded));drawingAnnotations.push(rest)});mark.annotations;var rest=TranscriptionAnnotation_objectWithoutProperties(mark,TranscriptionAnnotation_excluded2);drawingSnapshot.value[markIndex]=rest}),drawingAnnotations}}});const models_TranscriptionAnnotation=mobx_state_tree_module.gK.compose("TranscriptionAnnotation",Annotation.A,Transcription);var TranscriptionTask_Transcription=mobx_state_tree_module.gK.model("Transcription",{activeMark:mobx_state_tree_module.gK.safeReference(marks.TranscriptionLine),annotation:mobx_state_tree_module.gK.safeReference(models_TranscriptionAnnotation),caesarKey:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.literal("alice"),"alice"),tools:mobx_state_tree_module.gK.array(tools.TranscriptionLineTool),type:mobx_state_tree_module.gK.literal("transcription")}).actions(function(self){return{togglePreviousMarks:function togglePreviousMarks(option){self.shownMarks=option,self.shownMarks===shownMarks.A.NONE?self.hiddenMarkIds.replace(self.marks.map(function(mark){return mark.id})):self.hiddenMarkIds.clear()}}}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_TranscriptionAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const models_TranscriptionTask=mobx_state_tree_module.gK.compose("TranscriptionTask",drawing.A.TaskModel,TranscriptionTask_Transcription),transcription={TaskComponent:drawing.A.TaskComponent,TaskModel:models_TranscriptionTask,AnnotationModel:models_TranscriptionAnnotation};var VolumetricTask=__webpack_require__("./src/plugins/tasks/experimental/volumetric/components/VolumetricTask.jsx"),CoordinateModel=mobx_state_tree_module.gK.model("CoordinateModel",{x:mobx_state_tree_module.gK.number,y:mobx_state_tree_module.gK.number,z:mobx_state_tree_module.gK.number}),PointsModel=mobx_state_tree_module.gK.model("PointsModel",{active:mobx_state_tree_module.gK.array(CoordinateModel),connected:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.array(CoordinateModel),[])}),AnnotationModel=mobx_state_tree_module.gK.model("AnnotationModel",{label:mobx_state_tree_module.gK.string,threshold:mobx_state_tree_module.gK.number,points:PointsModel}),Volumetric=mobx_state_tree_module.gK.model("Volumetric",{taskType:mobx_state_tree_module.gK.literal("volumetric"),value:mobx_state_tree_module.gK.array(AnnotationModel)});const models_VolumetricAnnotation=mobx_state_tree_module.gK.compose("VolumetricAnnotation",Annotation.A,Volumetric);var VolumetricTask_Volumetric=mobx_state_tree_module.gK.model("Volumetric",{annotation:mobx_state_tree_module.gK.safeReference(models_VolumetricAnnotation),type:mobx_state_tree_module.gK.literal("volumetric")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_VolumetricAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const models_VolumetricTask=mobx_state_tree_module.gK.compose("VolumetricTask",Task.A,VolumetricTask_Volumetric),volumetric={TaskComponent:VolumetricTask.A,TaskModel:models_VolumetricTask,AnnotationModel:models_VolumetricAnnotation}},"./src/plugins/tasks/multiple/components/MultipleChoiceTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),grommet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),grommet__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),mobx_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_4__),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_components_TaskInput__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/plugins/tasks/components/TaskInput/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledFieldset=styled_components__WEBPACK_IMPORTED_MODULE_6__.default.fieldset.withConfig({displayName:"MultipleChoiceTask__StyledFieldset",componentId:"sc-1cx8ahu-0"})(["border:none;padding:0;&:focus-visible{outline:none;","}img:only-child,svg:only-child{"," max-width:2.5rem;}"],function(props){return props.focusColor&&(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.css)(["box-shadow:0 0 2px 2px ",";"],props.focusColor)},function(props){return props.theme&&(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.css)(["background:",";"],props.theme.global.colors.brand)}),StyledText=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.default)(grommet__WEBPACK_IMPORTED_MODULE_1__.E).withConfig({displayName:"MultipleChoiceTask__StyledText",componentId:"sc-1cx8ahu-1"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]),inlineComponents={p:StyledText};function MultipleChoiceTask(_ref){var _this=this,annotation=_ref.annotation,_ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,task=_ref.task,fieldset=(0,react__WEBPACK_IMPORTED_MODULE_5__.useRef)(),theme=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.useTheme)(),focusColor=null==theme?void 0:theme.global.colors[null==theme?void 0:theme.global.colors.focus],value=annotation.value,questionHasFocus=autoFocus&&0===value.length;function onChange(index,event){var newValue=value?value.slice(0):[];if(event.target.checked&&!newValue.includes(index))newValue.push(index);else if(!event.target.checked&&newValue.includes(index)){var indexInValue=newValue.indexOf(index);newValue.splice(indexInValue,1)}annotation.update(newValue)}return(0,react__WEBPACK_IMPORTED_MODULE_5__.useEffect)(function autofocusFieldset(){var _fieldset$current;questionHasFocus&&document.activeElement!==fieldset.current&&(null===(_fieldset$current=fieldset.current)||void 0===_fieldset$current||_fieldset$current.focus())},[questionHasFocus]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(grommet__WEBPACK_IMPORTED_MODULE_2__.a,{as:StyledFieldset,ref:fieldset,className,disabled,focusColor,tabIndex:-1,theme,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(StyledText,{as:"legend",size:"small",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__.Ay,{components:inlineComponents,children:task.question})}),task.answers.map(function(answer,index){var checked=!!(value&&value.length>0)&&value.includes(index);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_components_TaskInput__WEBPACK_IMPORTED_MODULE_7__.A,{autoFocus:checked,checked,disabled,index,label:task.strings.get("answers.".concat(index,".label")),name:task.taskKey,onChange:onChange.bind(_this,index),required:task.required,type:"checkbox"},"".concat(task.taskKey,"_").concat(index))})]})}MultipleChoiceTask.propTypes={annotation:prop_types__WEBPACK_IMPORTED_MODULE_4___default().shape({update:prop_types__WEBPACK_IMPORTED_MODULE_4___default().func,value:prop_types__WEBPACK_IMPORTED_MODULE_4___default().array}).isRequired,autoFocus:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool,className:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,disabled:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool,task:prop_types__WEBPACK_IMPORTED_MODULE_4___default().shape({answers:prop_types__WEBPACK_IMPORTED_MODULE_4___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_4___default().shape({label:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string})),help:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,question:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,required:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool}).isRequired};const __WEBPACK_DEFAULT_EXPORT__=(0,mobx_react__WEBPACK_IMPORTED_MODULE_3__.PA)(MultipleChoiceTask);MultipleChoiceTask.__docgenInfo={description:"",methods:[],displayName:"MultipleChoiceTask",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},className:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},annotation:{description:"",type:{name:"shape",value:{update:{name:"func",required:!1},value:{name:"array",required:!1}}},required:!0},task:{description:"",type:{name:"shape",value:{answers:{name:"arrayOf",value:{name:"shape",value:{label:{name:"string",required:!1}}},required:!1},help:{name:"string",required:!1},question:{name:"string",required:!1},required:{name:"bool",required:!1}}},required:!0}}}},"./src/plugins/tasks/multiple/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>multiple});var MultipleChoiceTask=__webpack_require__("./src/plugins/tasks/multiple/components/MultipleChoiceTask.jsx"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Task=__webpack_require__("./src/plugins/tasks/models/Task.js"),Annotation=__webpack_require__("./src/plugins/tasks/models/Annotation.js"),MultipleChoice=mobx_state_tree_module.gK.model("MultipleChoice",{taskType:mobx_state_tree_module.gK.literal("multiple"),value:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.number),[])}).views(function(self){return{get isComplete(){return self.value.length>0}}});const models_MultipleChoiceAnnotation=mobx_state_tree_module.gK.compose("MultipleChoiceAnnotation",Annotation.A,MultipleChoice);var MultipleChoiceTask_MultipleChoice=mobx_state_tree_module.gK.model("MultipleChoice",{annotation:mobx_state_tree_module.gK.safeReference(models_MultipleChoiceAnnotation),answers:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen({label:mobx_state_tree_module.gK.string})),type:mobx_state_tree_module.gK.literal("multiple")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_MultipleChoiceAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const models_MultipleChoiceTask=mobx_state_tree_module.gK.compose("MultipleChoiceTask",Task.A,MultipleChoiceTask_MultipleChoice),multiple={TaskComponent:MultipleChoiceTask.A,TaskModel:models_MultipleChoiceTask,AnnotationModel:models_MultipleChoiceAnnotation}},"./src/plugins/tasks/single/components/SingleChoiceTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),grommet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),grommet__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),mobx_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_4__),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),_components_TaskInput__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/plugins/tasks/components/TaskInput/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledFieldset=styled_components__WEBPACK_IMPORTED_MODULE_6__.default.fieldset.withConfig({displayName:"SingleChoiceTask__StyledFieldset",componentId:"sc-dgswm5-0"})(["border:none;padding:0;&:focus-visible{outline:none;","}img:only-child,svg:only-child{"," max-width:2.5rem;}"],function(props){return props.focusColor&&(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.css)(["box-shadow:0 0 2px 2px ",";"],props.focusColor)},function(props){return props.theme&&(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.css)(["background:",";"],props.theme.global.colors.brand)}),StyledText=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.default)(grommet__WEBPACK_IMPORTED_MODULE_1__.E).withConfig({displayName:"SingleChoiceTask__StyledText",componentId:"sc-dgswm5-1"})(["margin:0;padding:0;width:100%;> *:first-child{margin-top:0;}"]),inlineComponents={p:StyledText};function SingleChoiceTask(_ref){var _this=this,annotation=_ref.annotation,_ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,task=_ref.task,fieldset=(0,react__WEBPACK_IMPORTED_MODULE_5__.useRef)(),theme=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.useTheme)(),focusColor=null==theme?void 0:theme.global.colors[null==theme?void 0:theme.global.colors.focus],value=annotation.value,questionHasFocus=autoFocus&&null===value;function onChange(index,event){event.target.checked&&annotation.update(index)}return(0,react__WEBPACK_IMPORTED_MODULE_5__.useEffect)(function autofocusFieldset(){var _fieldset$current;questionHasFocus&&document.activeElement!==fieldset.current&&(null===(_fieldset$current=fieldset.current)||void 0===_fieldset$current||_fieldset$current.focus())},[questionHasFocus]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(grommet__WEBPACK_IMPORTED_MODULE_2__.a,{as:StyledFieldset,ref:fieldset,className,disabled,focusColor,tabIndex:-1,theme,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(StyledText,{as:"legend",size:"small",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_zooniverse_react_components_Markdownz__WEBPACK_IMPORTED_MODULE_0__.Ay,{components:inlineComponents,children:task.question})}),task.answers.map(function(answer,index){var checked=!!(value+1)&&index===value;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_components_TaskInput__WEBPACK_IMPORTED_MODULE_7__.A,{autoFocus:checked,checked,disabled,index,label:task.strings.get("answers.".concat(index,".label")),name:task.taskKey,onChange:onChange.bind(_this,index),required:task.required,type:"radio"},"".concat(task.taskKey,"_").concat(index))})]})}SingleChoiceTask.propTypes={annotation:prop_types__WEBPACK_IMPORTED_MODULE_4___default().shape({update:prop_types__WEBPACK_IMPORTED_MODULE_4___default().func,value:prop_types__WEBPACK_IMPORTED_MODULE_4___default().number}).isRequired,autoFocus:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool,className:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,disabled:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool,task:prop_types__WEBPACK_IMPORTED_MODULE_4___default().shape({answers:prop_types__WEBPACK_IMPORTED_MODULE_4___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_4___default().shape({label:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string})),help:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,question:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,required:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool,taskKey:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string}).isRequired};const __WEBPACK_DEFAULT_EXPORT__=(0,mobx_react__WEBPACK_IMPORTED_MODULE_3__.PA)(SingleChoiceTask);SingleChoiceTask.__docgenInfo={description:"",methods:[],displayName:"SingleChoiceTask",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},className:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},annotation:{description:"",type:{name:"shape",value:{update:{name:"func",required:!1},value:{name:"number",required:!1}}},required:!0},task:{description:"",type:{name:"shape",value:{answers:{name:"arrayOf",value:{name:"shape",value:{label:{name:"string",required:!1}}},required:!1},help:{name:"string",required:!1},question:{name:"string",required:!1},required:{name:"bool",required:!1},taskKey:{name:"string",required:!1}}},required:!0}}}},"./src/plugins/tasks/single/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>single});var SingleChoiceTask=__webpack_require__("./src/plugins/tasks/single/components/SingleChoiceTask.jsx"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Task=__webpack_require__("./src/plugins/tasks/models/Task.js"),Annotation=__webpack_require__("./src/plugins/tasks/models/Annotation.js"),SingleChoice=mobx_state_tree_module.gK.model("SingleChoice",{taskType:mobx_state_tree_module.gK.literal("single"),value:mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.number)}).views(function(self){return{get isComplete(){return null!==self.value}}});const models_SingleChoiceAnnotation=mobx_state_tree_module.gK.compose("SingleChoiceAnnotation",Annotation.A,SingleChoice);var SingleChoiceTask_SingleChoice=mobx_state_tree_module.gK.model("SingleChoice",{annotation:mobx_state_tree_module.gK.safeReference(models_SingleChoiceAnnotation),answers:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen({label:mobx_state_tree_module.gK.string,next:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string)})),type:mobx_state_tree_module.gK.literal("single")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_SingleChoiceAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const models_SingleChoiceTask=mobx_state_tree_module.gK.compose("SingleChoiceTask",Task.A,SingleChoiceTask_SingleChoice),single={TaskComponent:SingleChoiceTask.A,TaskModel:models_SingleChoiceTask,AnnotationModel:models_SingleChoiceAnnotation}},"./src/plugins/tasks/text/components/TextTask/TextTask.jsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>TextTask_TextTask});var mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("../../node_modules/react/index.js"),Text=__webpack_require__("../../node_modules/grommet/es6/components/Text/Text.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),TextArea=__webpack_require__("../../node_modules/grommet/es6/components/TextArea/TextArea.js"),Markdownz=__webpack_require__("../lib-react-components/dist/esm/Markdownz/Markdownz.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),PlainButton=__webpack_require__("../lib-react-components/dist/esm/PlainButton/PlainButton.js"),i18n=__webpack_require__("./src/translations/i18n.jsx"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),Fieldset=(0,styled_components_browser_esm.default)("fieldset").withConfig({displayName:"TextTagButtons__Fieldset",componentId:"sc-u5i77n-0"})(["border:none;margin:0;padding:0;outline:none;"]),DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1},DEFAULT_TAGS=[];function TextTagButtons(_ref){var _ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$tags=_ref.tags,tags=void 0===_ref$tags?DEFAULT_TAGS:_ref$tags,taskKey=_ref.taskKey,_ref$onClick=_ref.onClick,_onClick=void 0===_ref$onClick?DEFAULT_HANDLER:_ref$onClick,t=(0,i18n.Bd)("plugins").t;return tags.length>0?(0,jsx_runtime.jsxs)(Fieldset,{children:[(0,jsx_runtime.jsx)("legend",{children:(0,jsx_runtime.jsx)(Text.E,{id:"textModifiers-".concat(taskKey),weight:"bold",children:t("TextTask.TextTagButtons.modifiers")})}),(0,jsx_runtime.jsx)(Box.a,{gap:"small",justify:"start",direction:"row",children:tags.map(function(tag){return(0,jsx_runtime.jsx)(PlainButton.Ay,{"aria-labelledby":"textModifiers-".concat(taskKey," ").concat(taskKey,"-").concat(tag),id:"".concat(taskKey,"-").concat(tag),disabled,justify:"start",onClick:function onClick(event){return _onClick(event)},text:tag,value:tag},tag)})})]}):null}TextTagButtons.propTypes={disabled:prop_types_default().bool,onClick:prop_types_default().func,taskKey:prop_types_default().string.isRequired,tags:prop_types_default().arrayOf(prop_types_default().string)},TextTagButtons.__docgenInfo={description:"",methods:[],displayName:"TextTagButtons",props:{disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},tags:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},onClick:{defaultValue:{value:"() => false",computed:!1},description:"",type:{name:"func"},required:!1},taskKey:{description:"",type:{name:"string"},required:!0}}};var StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"DefaultTextTask__StyledText",componentId:"sc-13dl653-0"})(["display:block;margin:10px 0;"]);function DefaultTextTask(_ref){var _ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$setTagSelection=_ref.setTagSelection,setTagSelection=void 0===_ref$setTagSelection?function(){return!0}:_ref$setTagSelection,task=_ref.task,value=_ref.value,_ref$updateAnnotation=_ref.updateAnnotation,updateAnnotation=void 0===_ref$updateAnnotation?function(){return!0}:_ref$updateAnnotation,textArea=(0,react.useRef)();var components={a:StyledText,h1:StyledText,h2:StyledText,h3:StyledText,h4:StyledText,h5:StyledText,h6:StyledText,p:StyledText,span:Text.E};return(0,jsx_runtime.jsxs)(Box.a,{direction:"column",children:[(0,jsx_runtime.jsxs)("label",{htmlFor:"".concat(task.taskKey,"-").concat(task.type),children:[(0,jsx_runtime.jsx)(Markdownz.Ay,{components,children:task.instruction}),(0,jsx_runtime.jsx)(TextArea.f,{ref:textArea,autoFocus,disabled,id:"".concat(task.taskKey,"-").concat(task.type),value,onChange:function onChange(){updateAnnotation(textArea)}})]}),(0,jsx_runtime.jsx)(TextTagButtons,{disabled,onClick:function onClick(event){return setTagSelection(event,textArea)},taskKey:task.taskKey,tags:task.text_tags})]})}DefaultTextTask.propTypes={autoFocus:prop_types_default().bool,disabled:prop_types_default().bool,onSelectSuggestion:prop_types_default().func,setTagSelection:prop_types_default().func,task:prop_types_default().shape({help:prop_types_default().string,instruction:prop_types_default().string,required:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().bool]),taskKey:prop_types_default().string,text_tags:prop_types_default().arrayOf(prop_types_default().string),type:prop_types_default().string}).isRequired,value:prop_types_default().string.isRequired,updateAnnotation:prop_types_default().func};const DefaultTextTask_DefaultTextTask=(0,mobxreact_esm.PA)(DefaultTextTask);DefaultTextTask.__docgenInfo={description:"",methods:[],displayName:"DefaultTextTask",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},setTagSelection:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},updateAnnotation:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},onSelectSuggestion:{description:"",type:{name:"func"},required:!1},task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},required:{name:"union",value:[{name:"string"},{name:"bool"}],required:!1},taskKey:{name:"string",required:!1},text_tags:{name:"arrayOf",value:{name:"string"},required:!1},type:{name:"string",required:!1}}},required:!0},value:{description:"",type:{name:"string"},required:!0}}};var TextInput=__webpack_require__("../../node_modules/grommet/es6/components/TextInput/TextInput.js"),TextTaskWithSuggestions_StyledText=(0,styled_components_browser_esm.default)(Text.E).withConfig({displayName:"TextTaskWithSuggestions__StyledText",componentId:"sc-q4ks1e-0"})(["display:block;margin:10px 0;"]);function TextTaskWithSuggestions(_ref){var _ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$onSelectSuggesti=_ref.onSelectSuggestion,onSelectSuggestion=void 0===_ref$onSelectSuggesti?function(){return!0}:_ref$onSelectSuggesti,_ref$setTagSelection=_ref.setTagSelection,setTagSelection=void 0===_ref$setTagSelection?function(){return!0}:_ref$setTagSelection,_ref$suggestions=_ref.suggestions,suggestions=void 0===_ref$suggestions?[]:_ref$suggestions,task=_ref.task,value=_ref.value,_ref$updateAnnotation=_ref.updateAnnotation,updateAnnotation=void 0===_ref$updateAnnotation?function(){return!0}:_ref$updateAnnotation,textInput=(0,react.useRef)(),displayedSuggestions=value?[]:suggestions;var components={a:TextTaskWithSuggestions_StyledText,h1:TextTaskWithSuggestions_StyledText,h2:TextTaskWithSuggestions_StyledText,h3:TextTaskWithSuggestions_StyledText,h4:TextTaskWithSuggestions_StyledText,h5:TextTaskWithSuggestions_StyledText,h6:TextTaskWithSuggestions_StyledText,p:TextTaskWithSuggestions_StyledText,span:Text.E};return(0,jsx_runtime.jsxs)(Box.a,{direction:"column",children:[(0,jsx_runtime.jsx)(TextTagButtons,{disabled,onClick:function onClick(event){return setTagSelection(event,textInput)},taskKey:task.taskKey,tags:task.text_tags}),(0,jsx_runtime.jsxs)("label",{htmlFor:"".concat(task.taskKey,"-").concat(task.type),children:[(0,jsx_runtime.jsx)(Markdownz.Ay,{components,children:task.instruction}),(0,jsx_runtime.jsx)(TextInput.k,{autoFocus,disabled,dropProps:{trapFocus:!1},id:"".concat(task.taskKey,"-").concat(task.type),onChange:function onChange(){updateAnnotation(textInput)},onSelect:function onSelect(event){return onSelectSuggestion(event,textInput)},suggestions:displayedSuggestions,ref:textInput,value})]})]})}TextTaskWithSuggestions.propTypes={autoFocus:prop_types_default().bool,disabled:prop_types_default().bool,onSelectSuggestion:prop_types_default().func,setTagSelection:prop_types_default().func,suggestions:prop_types_default().arrayOf(prop_types_default().string),task:prop_types_default().shape({help:prop_types_default().string,instruction:prop_types_default().string,required:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().bool]),taskKey:prop_types_default().string,text_tags:prop_types_default().arrayOf(prop_types_default().string),type:prop_types_default().string}).isRequired,value:prop_types_default().string.isRequired,updateAnnotation:prop_types_default().func};const TextTaskWithSuggestions_TextTaskWithSuggestions=(0,mobxreact_esm.PA)(TextTaskWithSuggestions);TextTaskWithSuggestions.__docgenInfo={description:"",methods:[],displayName:"TextTaskWithSuggestions",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},onSelectSuggestion:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},setTagSelection:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},suggestions:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},updateAnnotation:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},required:{name:"union",value:[{name:"string"},{name:"bool"}],required:!1},taskKey:{name:"string",required:!1},text_tags:{name:"arrayOf",value:{name:"string"},required:!1},type:{name:"string",required:!1}}},required:!0},value:{description:"",type:{name:"string"},required:!0}}};var literalInsertionTags=["&"];function TextTask(_ref){var annotation=_ref.annotation,_ref$autoFocus=_ref.autoFocus,autoFocus=void 0!==_ref$autoFocus&&_ref$autoFocus,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$suggestions=_ref.suggestions,suggestions=void 0===_ref$suggestions?[]:_ref$suggestions,task=_ref.task,value=annotation.value;function updateAnnotation(ref){var currentRef=ref.current;if(currentRef&&annotation){var text=currentRef.value;annotation.update(text)}}function setTagSelection(e,ref){var currentRef=ref.current,text=currentRef.value,textTag=e.currentTarget.value;if(literalInsertionTags.indexOf(textTag)>=0)return function setTagSelection_literalInsertion(e,ref){var currentRef=ref.current,text=currentRef.value,textTag=e.currentTarget.value,selectionStart=currentRef.selectionStart,selectionEnd=currentRef.selectionEnd,textBefore=text.substring(0,selectionStart),textAfter=text.substring(selectionEnd,text.length),newValue=textBefore+textTag+textAfter;currentRef.value=newValue,updateAnnotation(ref),currentRef.focus&&(currentRef.setSelectionRange(newValue.length-textAfter.length,newValue.length-textAfter.length),currentRef.focus())}(e,ref);var textAfter,newValue,startTag="[".concat(textTag,"]"),endTag="[/".concat(textTag,"]"),selectionStart=currentRef.selectionStart,selectionEnd=currentRef.selectionEnd,textBefore=text.substring(0,selectionStart);selectionStart===selectionEnd?newValue=textBefore+startTag+endTag+(textAfter=text.substring(selectionStart,text.length)):newValue=textBefore+startTag+text.substring(selectionStart,selectionEnd)+endTag+(textAfter=text.substring(selectionEnd,text.length));currentRef.value=newValue,updateAnnotation(ref),currentRef.focus&&(currentRef.setSelectionRange(newValue.length-textAfter.length,newValue.length-textAfter.length),currentRef.focus())}return(null==suggestions?void 0:suggestions.length)>0?(0,jsx_runtime.jsx)(TextTaskWithSuggestions_TextTaskWithSuggestions,{autoFocus,disabled,onSelectSuggestion:function onSelectSuggestion(event,ref){ref.current.value=event.suggestion,updateAnnotation(ref)},setTagSelection,suggestions,task,value,updateAnnotation}):(0,jsx_runtime.jsx)(DefaultTextTask_DefaultTextTask,{autoFocus,disabled,setTagSelection,task,value,updateAnnotation})}TextTask.propTypes={autoFocus:prop_types_default().bool,disabled:prop_types_default().bool,suggestions:prop_types_default().array,task:prop_types_default().shape({help:prop_types_default().string,instruction:prop_types_default().string,required:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().bool]),taskKey:prop_types_default().string,text_tags:prop_types_default().arrayOf(prop_types_default().string),type:prop_types_default().string}).isRequired};const TextTask_TextTask=(0,mobxreact_esm.PA)(TextTask);TextTask.__docgenInfo={description:"",methods:[],displayName:"TextTask",props:{autoFocus:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},suggestions:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"array"},required:!1},task:{description:"",type:{name:"shape",value:{help:{name:"string",required:!1},instruction:{name:"string",required:!1},required:{name:"union",value:[{name:"string"},{name:"bool"}],required:!1},taskKey:{name:"string",required:!1},text_tags:{name:"arrayOf",value:{name:"string"},required:!1},type:{name:"string",required:!1}}},required:!0}}}},"./src/plugins/tasks/text/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>tasks_text});var TextTask=__webpack_require__("./src/plugins/tasks/text/components/TextTask/TextTask.jsx"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Task=__webpack_require__("./src/plugins/tasks/models/Task.js"),Annotation=__webpack_require__("./src/plugins/tasks/models/Annotation.js"),Text=mobx_state_tree_module.gK.model("Text",{taskType:mobx_state_tree_module.gK.literal("text"),value:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"")}).views(function(self){return{get isComplete(){return""!==self.value}}});const models_TextAnnotation=mobx_state_tree_module.gK.compose("TextAnnotation",Annotation.A,Text);var TextTask_Text=mobx_state_tree_module.gK.model("Text",{annotation:mobx_state_tree_module.gK.safeReference(models_TextAnnotation),required:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.union(mobx_state_tree_module.gK.string,mobx_state_tree_module.gK.boolean)),text_tags:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.string),type:mobx_state_tree_module.gK.literal("text")}).views(function(self){return{defaultAnnotation:function defaultAnnotation(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cuid_default()();return models_TextAnnotation.create({id,task:self.taskKey,taskType:self.type})}}});const models_TextTask=mobx_state_tree_module.gK.compose("TextTask",Task.A,TextTask_Text);const models_TextPreviousAnnotationValues=mobx_state_tree_module.gK.model("TextPreviousAnnotationValues",{taskKey:mobx_state_tree_module.gK.identifier,taskType:mobx_state_tree_module.gK.literal("text"),values:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.string)}),tasks_text={TaskComponent:TextTask.A,TaskModel:models_TextTask,AnnotationModel:models_TextAnnotation,PreviousAnnotationValuesModel:models_TextPreviousAnnotationValues}},"./src/store/AnnotationsStore.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),_plugins_tasks_models_Annotation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/plugins/tasks/models/Annotation.js");const __WEBPACK_DEFAULT_EXPORT__=mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.model("AnnotationsStore",{annotations:mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.map(_plugins_tasks_models_Annotation__WEBPACK_IMPORTED_MODULE_1__.A)}).views(function(self){return{annotation:function annotation(task){var taskAnnotation;return self.annotations.forEach(function(annotation){annotation.task===task.taskKey&&(taskAnnotation=annotation)}),taskAnnotation}}}).actions(function(self){function createAnnotation(task){var taskAnnotation=task.createAnnotation();return self.annotations.put(taskAnnotation),taskAnnotation}return{addAnnotation:function addAnnotation(task,value){var annotation=self.annotation(task);return annotation||(annotation=createAnnotation(task)),void 0!==value&&annotation.update(value),annotation},createAnnotation,beforeDestroy:function beforeDestroy(){self.reset()},removeAnnotation:function removeAnnotation(annotation){null!=annotation&&annotation.id&&self.annotations.delete(annotation.id)},reset:function reset(){self.annotations.clear()}}})},"./src/store/FieldGuideStore/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>FieldGuideStore_FieldGuideStore});var mobx_esm=__webpack_require__("../../node_modules/mobx/dist/mobx.esm.js"),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),async_states=__webpack_require__("../lib-async-states/src/async-states.js"),async_states_default=__webpack_require__.n(async_states),ResourceStore=__webpack_require__("./src/store/ResourceStore/index.js"),Resource=__webpack_require__("./src/store/Resource.js"),FieldGuide=mobx_state_tree_module.gK.model("FieldGuide",{items:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen({content:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),icon:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),title:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"")}))),language:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"en")});const FieldGuide_FieldGuide=mobx_state_tree_module.gK.compose("FieldGuideResource",Resource.A,FieldGuide);var Medium=__webpack_require__("./src/store/Medium/index.js"),process=__webpack_require__("../../node_modules/process/browser.js");function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}var FieldGuideStore=mobx_state_tree_module.gK.model("FieldGuideStore",{active:mobx_state_tree_module.gK.safeReference(FieldGuide_FieldGuide),attachedMedia:mobx_state_tree_module.gK.map(Medium.A),resources:mobx_state_tree_module.gK.map(FieldGuide_FieldGuide),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"field_guides")}).actions(function(self){var _marked=_regenerator().m(fetchFieldGuide);function _onProjectChange(){var project=(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).projects.active});!self.loaded&&project&&(self.reset(),self.fetchFieldGuide(project.id))}var fetchMedia=(0,mobx_state_tree_module.L3)(_regenerator().m(function fetchMedia(fieldGuide){var type,client,url,response,media,_t;return _regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(type=self.type,client=(0,mobx_state_tree_module.Zn)(self).client.panoptes,!fieldGuide){_context.n=4;break}return self.loadingState=async_states_default().loading,_context.p=1,url="/".concat(type,"/").concat(fieldGuide.id,"/attached_images"),_context.n=2,client.get(url,{page_size:100});case 2:response=_context.v,(media=response.body.media)&&media.length>0&&self.setMediaResources(media),_context.n=4;break;case 3:_context.p=3,_t=_context.v,process.browser&&console.error(_t);case 4:return _context.a(2)}},fetchMedia,null,[[1,3]])}));function fetchFieldGuide(projectID){var type,client,response,fieldGuide,_t2;return _regenerator().w(function(_context2){for(;;)switch(_context2.p=_context2.n){case 0:return type=self.type,client=(0,mobx_state_tree_module.Zn)(self).client.panoptes,self.loadingState=async_states_default().loading,_context2.p=1,_context2.n=2,client.get("/".concat(type),{project_id:projectID});case 2:if(response=_context2.v,!(fieldGuide=response.body[type][0])){_context2.n=4;break}return _context2.n=3,fetchMedia(fieldGuide);case 3:self.setResources([fieldGuide]),self.setActive(fieldGuide.id),self.loadingState=async_states_default().success,_context2.n=5;break;case 4:self.loadingState=async_states_default().success;case 5:_context2.n=7;break;case 6:_context2.p=6,_t2=_context2.v,process.browser&&console.error(_t2),self.loadingState=async_states_default().error;case 7:return _context2.a(2)}},_marked,null,[[1,6]])}return{afterAttach:function afterAttach(){!function createProjectObserver(){var projectDisposer=(0,mobx_esm.fm)(_onProjectChange);(0,mobx_state_tree_module.LF)(self,projectDisposer)}()},fetchFieldGuide:(0,mobx_state_tree_module.L3)(fetchFieldGuide),reset:function reset(){self.resources.clear(),self.attachedMedia.clear()},setMediaResources:function setMediaResources(media){media.forEach(function(medium){return self.attachedMedia.put(medium)})}}});const FieldGuideStore_FieldGuideStore=mobx_state_tree_module.gK.compose("FieldGuideResourceStore",ResourceStore.A,FieldGuideStore)},"./src/store/Medium/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Medium_Medium});var mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Resource=__webpack_require__("./src/store/Resource.js"),Medium=mobx_state_tree_module.gK.model("Medium",{content_type:mobx_state_tree_module.gK.string,external_link:mobx_state_tree_module.gK.boolean,href:mobx_state_tree_module.gK.string,links:mobx_state_tree_module.gK.frozen({linked:mobx_state_tree_module.gK.frozen({href:mobx_state_tree_module.gK.string,id:mobx_state_tree_module.gK.string,type:mobx_state_tree_module.gK.string})}),media_type:mobx_state_tree_module.gK.string,metadata:mobx_state_tree_module.gK.frozen({}),src:mobx_state_tree_module.gK.string});const Medium_Medium=mobx_state_tree_module.gK.compose("MediumResource",Resource.A,Medium)},"./src/store/Resource.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js");const __WEBPACK_DEFAULT_EXPORT__=mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.model("Resource",{id:mobx_state_tree__WEBPACK_IMPORTED_MODULE_0__.gK.identifier})},"./src/store/ResourceStore/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>ResourceStore_ResourceStore});var async_states=__webpack_require__("../lib-async-states/src/async-states.js"),async_states_default=__webpack_require__.n(async_states),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),Resource=__webpack_require__("./src/store/Resource.js"),process=__webpack_require__("../../node_modules/process/browser.js");function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}var ResourceStore=mobx_state_tree_module.gK.model("ResourceStore",{active:mobx_state_tree_module.gK.safeReference(Resource.A),headers:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.model({etag:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string)}),{}),resources:mobx_state_tree_module.gK.map(Resource.A),loadingState:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration("loadingState",async_states_default().values),async_states_default().initialized),type:mobx_state_tree_module.gK.string}).views(function(self){return{get loaded(){return self.loadingState!==async_states_default().initialized}}}).actions(function(self){return{fetchResource:(0,mobx_state_tree_module.L3)(_regenerator().m(function fetchResource(id){var client,type,response,resource,_t;return _regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:return client=(0,mobx_state_tree_module.Zn)(self).client.panoptes,type=self.type,self.loadingState=async_states_default().loading,_context.p=1,_context.n=2,client.get("/".concat(type,"/").concat(id));case 2:if(response=_context.v,self.headers=response.headers,!(response.body[type]&&response.body[type].length>0)){_context.n=3;break}return resource=response.body[type][0],self.loadingState=async_states_default().success,_context.a(2,resource);case 3:return self.loadingState=async_states_default().success,_context.a(2,void 0);case 4:_context.n=6;break;case 5:return _context.p=5,_t=_context.v,console.error(_t),self.loadingState=async_states_default().error,_context.a(2,void 0);case 6:return _context.a(2)}},fetchResource,null,[[1,5]])})),onError:function onError(error){process.browser&&console.error(error),self.loadingState=async_states_default().error},onLoading:function onLoading(){self.loadingState=async_states_default().loading},onReady:function onReady(){self.loadingState=async_states_default().success},reset:function reset(){self.headers=void 0,self.active=void 0,self.loadingState=async_states_default().initialized,self.resources.clear()},getResource:(0,mobx_state_tree_module.L3)(_regenerator().m(function getResource(id){var panoptesResource;return _regenerator().w(function(_context2){for(;;)switch(_context2.n){case 0:if(self.resources.get(id)){_context2.n=2;break}return _context2.n=1,self.fetchResource(id);case 1:panoptesResource=_context2.v,self.setResources([panoptesResource]);case 2:return _context2.a(2,self.resources.get(id))}},getResource)})),setResources:function setResources(){var resources=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(resources&&resources.length>0)try{resources.forEach(function(resource){resource&&self.resources.put(resource)}),self.loadingState=async_states_default().success}catch(error){console.error(error)}},setActive:(0,mobx_state_tree_module.L3)(function setActive(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return _regenerator().m(function _callee(){var resource;return _regenerator().w(function(_context3){for(;;)switch(_context3.n){case 0:if(self.resources.get(id)){_context3.n=2;break}return _context3.n=1,self.fetchResource(id);case 1:resource=_context3.v,self.setResources([resource]);case 2:self.active=id;case 3:return _context3.a(2)}},_callee)})()})}});const ResourceStore_ResourceStore=ResourceStore},"./src/store/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>store_RootStore});var subjects_namespaceObject={};__webpack_require__.r(subjects_namespaceObject),__webpack_require__.d(subjects_namespaceObject,{ImageAndTextSubject:()=>ImageAndTextSubject_ImageAndTextSubject,ImageSubject:()=>ImageSubject_ImageSubject,SingleImageSubject:()=>SingleImageSubject_SingleImageSubject,SingleJSONSubject:()=>SingleJSONSubject_SingleJSONSubject,SingleTextSubject:()=>SingleTextSubject_SingleTextSubject,SingleVideoSubject:()=>SingleVideoSubject_SingleVideoSubject,SubjectGroup:()=>SubjectGroup_SubjectGroup,TextSubject:()=>TextSubject_TextSubject});var mobx_esm=__webpack_require__("../../node_modules/mobx/dist/mobx.esm.js"),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),async_states=__webpack_require__("../lib-async-states/src/async-states.js"),async_states_default=__webpack_require__.n(async_states),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid),snakeCase=__webpack_require__("../../node_modules/lodash/snakeCase.js"),snakeCase_default=__webpack_require__.n(snakeCase),tasks=__webpack_require__("./src/plugins/tasks/index.js"),AnnotationsStore=__webpack_require__("./src/store/AnnotationsStore.js"),Resource=__webpack_require__("./src/store/Resource.js"),process=__webpack_require__("../../node_modules/process/browser.js");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}const Classification_ClassificationMetadata=mobx_state_tree_module.gK.model("ClassificationMetadata",{classifier_version:mobx_state_tree_module.gK.literal("2.0"),feedback:mobx_state_tree_module.gK.frozen({}),finishedAt:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),revision:mobx_state_tree_module.gK.frozen(process.env.COMMIT_ID),session:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),source:mobx_state_tree_module.gK.enumeration(["api","sugar"]),startedAt:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),subjectDimensions:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen({clientHeight:mobx_state_tree_module.gK.integer,clientWidth:mobx_state_tree_module.gK.integer,naturalHeight:mobx_state_tree_module.gK.integer,naturalWidth:mobx_state_tree_module.gK.integer})),subjectSelectionState:mobx_state_tree_module.gK.frozen({already_seen:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),finished_workflow:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),retired:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),selected_at:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),selection_state:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),user_has_finished_workflow:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1)}),subject_flagged:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),userAgent:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,navigator.userAgent),userLanguage:mobx_state_tree_module.gK.string,utcOffset:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,(60*(new Date).getTimezoneOffset()).toString()),viewport:mobx_state_tree_module.gK.frozen({height:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.integer,window.innerHeight),width:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.integer,window.innerWidth)}),workflowVersion:mobx_state_tree_module.gK.string}).actions(function(self){return{afterAttach:function afterAttach(){(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(function _onLocaleChange(){var _getRoot;self.update({userLanguage:null===(_getRoot=(0,mobx_state_tree_module.Zn)(self))||void 0===_getRoot?void 0:_getRoot.locale})}))},afterCreate:function afterCreate(){var now=new Date;self.startedAt=now.toISOString()},update:function update(newMetadata){Object.entries(newMetadata).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];self[key]=value})}}});function Classification_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var annotationModels=Object.values(tasks).map(function(task){return task.AnnotationModel}),Classification=mobx_state_tree_module.gK.model("Classification",{annotations:mobx_state_tree_module.gK.map(mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return Classification_arrayLikeToArray(r)}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function Classification_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return Classification_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Classification_arrayLikeToArray(r,a):void 0}}(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(annotationModels))),completed:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),links:mobx_state_tree_module.gK.frozen({project:mobx_state_tree_module.gK.string,subjects:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.string),workflow:mobx_state_tree_module.gK.string}),metadata:mobx_state_tree_module.gK.maybe(Classification_ClassificationMetadata)}).views(function(self){return{toSnapshot:function toSnapshot(){var snapshot=(0,mobx_state_tree_module.dV)(self),annotations=[];return self.annotations.forEach(function(annotation){annotations=annotations.concat(annotation.toSnapshot())}),snapshot=Object.assign({},snapshot,{annotations})},previousInteractionTaskAnnotations:function previousInteractionTaskAnnotations(activeTaskKey){return(Array.from(self.annotations.values())||[]).filter(function(annotation){return"DrawingAnnotation"===(0,mobx_state_tree_module.Pw)(annotation).name||"TranscriptionAnnotation"===(0,mobx_state_tree_module.Pw)(annotation).name}).filter(function(annotation){return annotation.task!==activeTaskKey})}}}).preProcessSnapshot(function(snapshot){var newSnapshot=Object.assign({},snapshot);if(newSnapshot.id=snapshot.id||cuid_default()(),snapshot.annotations&&Array.isArray(snapshot.annotations)){var annotations={};snapshot.annotations.forEach(function(annotation){annotation.id=annotation.id||cuid_default()(),annotations[annotation.id]=annotation}),newSnapshot.annotations=annotations}return newSnapshot}).postProcessSnapshot(function(snapshot){var newSnapshot=Object.assign({},snapshot);return newSnapshot.annotations=Object.values(snapshot.annotations),newSnapshot});const Classification_Classification=mobx_state_tree_module.gK.compose("ClassificationResource",Resource.A,AnnotationsStore.A,Classification);var ResourceStore=__webpack_require__("./src/store/ResourceStore/index.js"),utils=__webpack_require__("./src/store/utils/index.js"),helpers=__webpack_require__("./src/helpers/index.js"),ClassificationStore_process=__webpack_require__("../../node_modules/process/browser.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function ClassificationStore_toConsumableArray(r){return function ClassificationStore_arrayWithoutHoles(r){if(Array.isArray(r))return ClassificationStore_arrayLikeToArray(r)}(r)||function ClassificationStore_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||ClassificationStore_unsupportedIterableToArray(r)||function ClassificationStore_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ClassificationStore_slicedToArray(r,e){return function ClassificationStore_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function ClassificationStore_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||ClassificationStore_unsupportedIterableToArray(r,e)||function ClassificationStore_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ClassificationStore_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return ClassificationStore_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ClassificationStore_arrayLikeToArray(r,a):void 0}}function ClassificationStore_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var ClassificationStore=mobx_state_tree_module.gK.model("ClassificationStore",{active:mobx_state_tree_module.gK.safeReference(Classification_Classification),demoMode:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.boolean),resources:mobx_state_tree_module.gK.map(Classification_Classification),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"classifications")}).views(function(self){return{annotation:function annotation(task){return(0,mobx_state_tree_module.aF)(function(){return self.active})?self.active.annotation(task):null},get currentAnnotations(){return(0,mobx_state_tree_module.aF)(function(){return self.active})?self.active.annotations:[]},get classificationQueue(){var client=(0,mobx_state_tree_module.Zn)(self).client.panoptes,authClient=(0,mobx_state_tree_module.Zn)(self).authClient;return new utils.qg(client,self.onClassificationSaved,authClient)}}}).volatile(function(self){return{onComplete:function onComplete(){return null}}}).actions(function(self){return{addAnnotation:function addAnnotation(task,annotationValue){if((0,mobx_state_tree_module.aF)(function(){return self.active})){var classification=self.active;if(classification)return classification.addAnnotation(task,annotationValue)}else if(ClassificationStore_process.browser)return console.error("No active classification. Cannot add annotation."),null},completeClassification:function completeClassification(_ref){var _ref$doneAndTalk=_ref.doneAndTalk,doneAndTalk=void 0!==_ref$doneAndTalk&&_ref$doneAndTalk,classification=(0,mobx_state_tree_module.$Q)(function(){return self.active}),subject=(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).subjects.active});if(classification&&subject){var subjectDimensions=(0,mobx_state_tree_module.dV)((0,mobx_state_tree_module.Zn)(self).subjectViewer).dimensions,metadata={finishedAt:(new Date).toISOString(),session:utils.im.getSessionID(),subjectDimensions,viewport:{width:window.innerWidth,height:window.innerHeight}},feedback=(0,mobx_state_tree_module.Zn)(self).feedback;feedback.isValid&&(metadata.feedback=(0,mobx_state_tree_module.dV)(feedback.rules)),classification.metadata.update(metadata),classification.completed=!0;var classificationToSubmit=classification.toSnapshot(),convertedMetadata={};if(Object.entries(classificationToSubmit.metadata).forEach(function(_ref2){var _ref3=ClassificationStore_slicedToArray(_ref2,2),key=_ref3[0],value=_ref3[1];convertedMetadata[snakeCase_default()(key)]=value}),classificationToSubmit.metadata=convertedMetadata,"SubjectGroup"===(0,mobx_state_tree_module.Pw)(subject).name){var links=function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({},classificationToSubmit.links);links.subjects=ClassificationStore_toConsumableArray(subject.subjectIds.toJSON()),classificationToSubmit.links=links}var already_seen=subject.alreadySeen,subjectData=Object.assign({},(0,mobx_state_tree_module.dV)(subject),{already_seen});return self.onComplete(classificationToSubmit,subjectData),self.trackAlreadySeenSubjects(classificationToSubmit.links.workflow,classificationToSubmit.links.subjects),ClassificationStore_process.browser&&console.log("Completed classification",classificationToSubmit),self.demoMode?(self.loadingState=async_states_default().posting,ClassificationStore_process.browser&&console.log("Demo mode enabled. No classification submitted."),Promise.resolve(!0)):self.submitClassification(classificationToSubmit,{doneAndTalk})}ClassificationStore_process.browser&&console.error("No active classification or active subject. Cannot complete classification")},createClassification:function createClassification(subject,workflow,project){if(!subject||!workflow||!project)throw new Error("Cannot create a classification without a subject, workflow, project");var locale=(0,mobx_state_tree_module.Zn)(self).locale,tempID=cuid_default()(),newClassification=Classification_Classification.create({id:tempID,links:{project:project.id,subjects:[subject.id],workflow:workflow.id},metadata:Classification_ClassificationMetadata.create({classifier_version:"2.0",source:subject.metadata.intervention?"sugar":"api",subjectSelectionState:{already_seen:subject.already_seen,finished_workflow:subject.finished_workflow,retired:subject.retired,selected_at:subject.selected_at,selection_state:subject.selection_state,user_has_finished_workflow:subject.user_has_finished_workflow},userLanguage:locale,workflowVersion:workflow.version})});self.resources.put(newClassification),self.setActive(tempID),self.loadingState=async_states_default().success},onClassificationSaved:function onClassificationSaved(savedClassification){},setDemoMode:function setDemoMode(boolean){self.demoMode=boolean},setOnComplete:function setOnComplete(onComplete){self.onComplete=onComplete},submitClassification:(0,mobx_state_tree_module.L3)(function submitClassification(classification,_ref4){var _ref4$doneAndTalk=_ref4.doneAndTalk,doneAndTalk=void 0!==_ref4$doneAndTalk&&_ref4$doneAndTalk;return _regenerator().m(function _callee(){var _t;return _regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(_context.p=0,!doneAndTalk){_context.n=2;break}return _context.n=1,self.classificationQueue.add(classification);case 1:self.loadingState=async_states_default().posting,_context.n=3;break;case 2:return self.loadingState=async_states_default().posting,_context.n=3,self.classificationQueue.add(classification);case 3:_context.n=5;break;case 4:_context.p=4,_t=_context.v,console.error(_t),self.loadingState=async_states_default().error;case 5:return _context.a(2)}},_callee,null,[[0,4]])})()}),trackAlreadySeenSubjects:function trackAlreadySeenSubjects(workflowID,subjectIDs){helpers.VW.add(workflowID,subjectIDs)}}});const store_ClassificationStore=mobx_state_tree_module.gK.compose("ClassificationResourceStore",ResourceStore.A,ClassificationStore);var flatten=__webpack_require__("../../node_modules/lodash/flatten.js"),flatten_default=__webpack_require__.n(flatten),forEach=__webpack_require__("../../node_modules/lodash/forEach.js"),forEach_default=__webpack_require__.n(forEach),reduce=__webpack_require__("../../node_modules/lodash/reduce.js"),reduce_default=__webpack_require__.n(reduce),find=__webpack_require__("../../node_modules/lodash/find.js"),find_default=__webpack_require__.n(find),isBoolean=__webpack_require__("../../node_modules/lodash/isBoolean.js"),isBoolean_default=__webpack_require__.n(isBoolean),isEmpty=__webpack_require__("../../node_modules/lodash/isEmpty.js"),isEmpty_default=__webpack_require__.n(isEmpty),lodash_isFinite=__webpack_require__("../../node_modules/lodash/isFinite.js"),isFinite_default=__webpack_require__.n(lodash_isFinite),isUndefined=__webpack_require__("../../node_modules/lodash/isUndefined.js"),isUndefined_default=__webpack_require__.n(isUndefined);const rule_checker=function ruleChecker(rule){var ruleErrors=function validateRuleProperties(rule){return reduce_default()(rule,function(errors,value,key){return isFinite_default()(value)||isBoolean_default()(value)?errors:isUndefined_default()(value)||isEmpty_default()(value)?errors.concat([key]):errors},[])}(rule);if(0===ruleErrors.length)return rule;var errors=ruleErrors.join(", ");return console.error("Undefined property %s in rule %s, skipping...",errors,rule.id),{}};const reducer=function graph2dRangeReducer(rule){var result=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(function(annotation){return function isAnnotationWithinTolerance(rule,annotation){var annotationX=annotation.x,annotationWidth=annotation.width,feedbackX=parseFloat(rule.x),feedbackWidth=parseFloat(rule.width),tolerance=parseFloat(rule.tolerance);return annotationX-annotationWidth/2>feedbackX-feedbackWidth/2-tolerance&&annotationX+annotationWidth/2<feedbackX+feedbackWidth/2+tolerance}(rule,annotation)});return Object.assign(rule,{success:result.length>0,successfulClassifications:result})},graph2drange={createRule:function createRule(subjectRule,workflowRule){var rule={failureEnabled:workflowRule.failureEnabled||!1,hideSubjectViewer:workflowRule.hideSubjectViewer||!1,id:subjectRule.id,strategy:workflowRule.strategy,successEnabled:workflowRule.successEnabled||!1,tolerance:subjectRule.tolerance||workflowRule.defaultTolerance,x:subjectRule.x,width:subjectRule.width};return rule.failureEnabled&&(rule.failureMessage=subjectRule.failureMessage||workflowRule.defaultFailureMessage),rule.successEnabled&&(rule.successMessage=subjectRule.successMessage||workflowRule.defaultSuccessMessage),rule_checker(rule)},id:"graph2drange",reducer,title:"Graph2dRange"};const column_create_rule=function create_rule_createRule(subjectRule,workflowRule){var rule={failureEnabled:workflowRule.failureEnabled||!1,hideSubjectViewer:workflowRule.hideSubjectViewer||!1,id:subjectRule.id,strategy:workflowRule.strategy,successEnabled:workflowRule.successEnabled||!1,tolerance:subjectRule.tolerance||workflowRule.defaultTolerance,x:subjectRule.x,width:subjectRule.width};return rule.failureEnabled&&(rule.failureMessage=subjectRule.failureMessage||workflowRule.defaultFailureMessage),rule.successEnabled&&(rule.successMessage=subjectRule.successMessage||workflowRule.defaultSuccessMessage),rule_checker(rule)};var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function FeedbackMark(_ref){var rule=_ref.rule,color=rule.success?"green":"red",tolerance=parseInt(rule.tolerance,10);return(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)("rect",{x:parseInt(rule.x,10)-tolerance,y:0,width:parseInt(rule.width,10)+2*tolerance,height:"100%",stroke:"blue",fill:"blue",fillOpacity:"0.2",strokeOpacity:"0.6"}),(0,jsx_runtime.jsx)("rect",{x:rule.x,y:0,width:rule.width,height:"100%",stroke:color,fill:color,fillOpacity:"0.5",strokeOpacity:"0.8"})]})}FeedbackMark.propTypes={rule:prop_types_default().shape({x:prop_types_default().string.isRequired,width:prop_types_default().string.isRequired,tolerance:prop_types_default().string.isRequired}).isRequired};const feedback_mark=FeedbackMark;FeedbackMark.__docgenInfo={description:"",methods:[],displayName:"FeedbackMark",props:{rule:{description:"",type:{name:"shape",value:{x:{name:"string",required:!0},width:{name:"string",required:!0},tolerance:{name:"string",required:!0}}},required:!0}}};const column_reducer=function columnReducer(rule){var result=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(function(annotation){return function reducer_isAnnotationWithinTolerance(rule,annotation){var annotationX=annotation.x,annotationWidth=annotation.width,feedbackX=parseInt(rule.x,10),feedbackWidth=parseInt(rule.width,10),tolerance=parseInt(rule.tolerance,10);return annotationX>feedbackX-tolerance&&annotationX+annotationWidth<feedbackX+feedbackWidth+tolerance}(rule,annotation)});return Object.assign(rule,{success:result.length>0,successfulClassifications:result})},column={createRule:column_create_rule,FeedbackMark:feedback_mark,id:"column",reducer:column_reducer,title:"Column"};const radial_create_rule=function radial_create_rule_createRule(subjectRule,workflowRule){var rule={failureEnabled:workflowRule.failureEnabled||!1,hideSubjectViewer:workflowRule.hideSubjectViewer||!1,id:subjectRule.id,strategy:workflowRule.strategy,successEnabled:workflowRule.successEnabled||!1,tolerance:subjectRule.tolerance||workflowRule.defaultTolerance,x:subjectRule.x,y:subjectRule.y};return rule.failureEnabled&&(rule.failureMessage=subjectRule.failureMessage||workflowRule.defaultFailureMessage),rule.successEnabled&&(rule.successMessage=subjectRule.successMessage||workflowRule.defaultSuccessMessage),rule_checker(rule)};function feedback_mark_FeedbackMark(_ref){var rule=_ref.rule,color=rule.success?"green":"red";return(0,jsx_runtime.jsx)("circle",{cx:rule.x,cy:rule.y,r:rule.tolerance,stroke:color,fill:color,fillOpacity:"0.5",strokeOpacity:"0.8"})}feedback_mark_FeedbackMark.propTypes={rule:prop_types_default().shape({x:prop_types_default().string,y:prop_types_default().string,tolerance:prop_types_default().string}).isRequired};const radial_feedback_mark=feedback_mark_FeedbackMark;feedback_mark_FeedbackMark.__docgenInfo={description:"",methods:[],displayName:"FeedbackMark",props:{rule:{description:"",type:{name:"shape",value:{x:{name:"string",required:!1},y:{name:"string",required:!1},tolerance:{name:"string",required:!1}}},required:!0}}};const radial_reducer=function radialReducer(rule){var result=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(function(annotation){return function radial_reducer_isAnnotationWithinTolerance(rule,annotation){var annotationX=annotation.x,annotationY=annotation.y,feedbackX=rule.x,feedbackY=rule.y,tolerance=rule.tolerance;return Math.sqrt(Math.pow(annotationY-feedbackY,2)+Math.pow(annotationX-feedbackX,2))<tolerance}(rule,annotation)});return Object.assign(rule,{success:result.length>0,successfulClassifications:result})},radial={createRule:radial_create_rule,FeedbackMark:radial_feedback_mark,id:"radial",reducer:radial_reducer,title:"Radial"};var lodash_assign=__webpack_require__("../../node_modules/lodash/assign.js"),assign_default=__webpack_require__.n(lodash_assign);const simple_reducer=function surveyReducer(rule){var result,choices=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],ruleIds=rule.choiceIds.split(",").map(function(idString){return idString.replace(/\W/g,"").toUpperCase()}),chosenIds=choices.map(function(choiceObject){return choiceObject.choice});return result=""===rule.choiceIds&&0===choices.length||chosenIds.every(function(choiceId){return ruleIds.indexOf(choiceId)>-1})&&ruleIds.every(function(ruleId){return chosenIds.indexOf(ruleId)>-1}),Object.assign({},rule,{success:result})};const strategies={column,dud:{createRule:function dud_create_rule_createRule(subjectRule,workflowRule){var rule={failureEnabled:workflowRule.failureEnabled||!1,id:subjectRule.id,strategy:workflowRule.strategy,successEnabled:workflowRule.successEnabled||!1};return rule.failureEnabled&&(rule.failureMessage=subjectRule.failureMessage||workflowRule.defaultFailureMessage),rule.successEnabled&&(rule.successMessage=subjectRule.successMessage||workflowRule.defaultSuccessMessage),rule_checker(rule)},id:"dud",title:"Dud",labComponent:null,validations:null,reducer:function dudReducer(rule,annotations){var result=0===annotations.length;return assign_default()(rule,{success:result})}},graph2drange,radial,singleAnswerQuestion:{createRule:function single_answer_question_create_rule_createRule(subjectRule,workflowRule){var rule={answer:subjectRule.answer,failureEnabled:workflowRule.failureEnabled||!1,id:subjectRule.id,strategy:workflowRule.strategy,successEnabled:workflowRule.successEnabled||!1};return rule.failureEnabled&&(rule.failureMessage=subjectRule.failureMessage||workflowRule.defaultFailureMessage),rule.successEnabled&&(rule.successMessage=subjectRule.successMessage||workflowRule.defaultSuccessMessage),rule_checker(rule)},id:"singleAnswerQuestion",title:"Single Answer Question",labComponent:null,validations:null,reducer:function singleAnswerQuestionReducer(rule,answer){var answerId=answer>-1&&null!==answer?answer:-1,result=rule.answer===answerId.toString();return Object.assign({},rule,{success:result})}},surveySimple:{createRule:function simple_create_rule_createRule(subjectRule,workflowRule){var rule={choiceIds:subjectRule.choiceIds||"",failureEnabled:workflowRule.failureEnabled||!1,id:subjectRule.id,strategy:workflowRule.strategy,successEnabled:workflowRule.successEnabled||!1};return rule.failureEnabled&&(rule.failureMessage=subjectRule.failureMessage||workflowRule.defaultFailureMessage),rule.successEnabled&&(rule.successMessage=subjectRule.successMessage||workflowRule.defaultSuccessMessage),rule_checker(rule)},id:"surveySimple",title:"Survey: Simple",labComponent:null,validations:null,reducer:simple_reducer}};function metadata_to_rules_slicedToArray(r,e){return function metadata_to_rules_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function metadata_to_rules_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function metadata_to_rules_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return metadata_to_rules_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?metadata_to_rules_arrayLikeToArray(r,a):void 0}}(r,e)||function metadata_to_rules_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function metadata_to_rules_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}const metadata_to_rules=function metadataToRules(){var metadata=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(metadata).reduce(function(result,key){var _key$split2=metadata_to_rules_slicedToArray(key.split("_"),3),prefix=_key$split2[0],ruleIndex=_key$split2[1],propKey=_key$split2[2],value=metadata[key],stringValue=null!=value?value.toString():"";if("#feedback"===prefix&&stringValue){isNaN(ruleIndex)&&console.error("Subject metadata feedback rule index ".concat(ruleIndex," is improperly formatted. The feedback rule index should be an integer."));var rule=result[ruleIndex]||{};rule[propKey]=value,result[ruleIndex]=rule}return result},[]).filter(Boolean)};function get_feedback_from_tasks_slicedToArray(r,e){return function get_feedback_from_tasks_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function get_feedback_from_tasks_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function get_feedback_from_tasks_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return get_feedback_from_tasks_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?get_feedback_from_tasks_arrayLikeToArray(r,a):void 0}}(r,e)||function get_feedback_from_tasks_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function get_feedback_from_tasks_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}const get_feedback_from_tasks=function getFeedbackFromTasks(){var tasks=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},result={};return Object.entries(tasks).forEach(function getTaskRules(_ref){var _ref2=get_feedback_from_tasks_slicedToArray(_ref,2),taskKey=_ref2[0],task=_ref2[1],_ref3=task.feedback||{enabled:!1,rules:[]},enabled=_ref3.enabled,rules=_ref3.rules;enabled&&rules&&rules.length>0&&(result[taskKey]=task.feedback.rules)}),result};var generate_rules_process=__webpack_require__("../../node_modules/process/browser.js");const is_feedback_active=function isFeedbackActive(project,subject,workflow){return Boolean(function getProjectFeedback(project){return project&&project.experimental_tools&&project.experimental_tools.includes("general feedback")}(project)&&function getSubjectFeedback(subject){return subject&&metadata_to_rules(subject.metadata).length>0}(subject)&&function getWorkflowFeedback(workflow){var taskFeedback=workflow?get_feedback_from_tasks(workflow.tasks):{};return Object.keys(taskFeedback).length>0}(workflow))},feedback_helpers={generateRules:function generateRules(subject,workflow){var subjectRules=subject?metadata_to_rules(subject.metadata):{},workflowRules=workflow?get_feedback_from_tasks(workflow.tasks):{},canonicalRules={};return forEach_default()(workflowRules,function(rules,taskId){var taskRules=reduce_default()(rules,function(result,workflowRule){var matchingSubjectRule=find_default()(subjectRules,function(subjectRule){return null!==subjectRule.id&&void 0!==subjectRule.id&&null!==workflowRule.id&&void 0!==workflowRule.id?subjectRule.id.toString()===workflowRule.id.toString():(generate_rules_process.browser&&console.warn("Feedback: Subject rule id or workflow rule id is null or undefined"),!1)});if(matchingSubjectRule){var ruleStrategy=workflowRule.strategy,ruleGenerator=strategies[ruleStrategy].createRule;return result.concat([ruleGenerator(matchingSubjectRule,workflowRule)])}return result},[]);taskRules.length&&(canonicalRules[taskId]=taskRules)}),canonicalRules},getFeedbackFromTasks:get_feedback_from_tasks,isFeedbackActive:is_feedback_active,metadataToRules:metadata_to_rules};var FeedbackStore_process=__webpack_require__("../../node_modules/process/browser.js");const store_FeedbackStore=mobx_state_tree_module.gK.model("FeedbackStore",{rules:mobx_state_tree_module.gK.map(mobx_state_tree_module.gK.frozen({})),showModal:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1)}).volatile(function(self){return{onHide:function onHide(){return!0}}}).views(function(self){return{get applicableRules(){return flatten_default()(Array.from(self.rules.values())).filter(function(rule){return rule.success&&rule.successEnabled||!rule.success&&rule.failureEnabled})},get hideSubjectViewer(){return flatten_default()(Array.from(self.rules.values())).some(function(rule){return rule.hideSubjectViewer})},get isActive(){var _getRoot=(0,mobx_state_tree_module.Zn)(self),_getRoot$projects=_getRoot.projects,projects=void 0===_getRoot$projects?{}:_getRoot$projects,_getRoot$subjects=_getRoot.subjects,subjects=void 0===_getRoot$subjects?{}:_getRoot$subjects,_getRoot$workflows=_getRoot.workflows,workflows=void 0===_getRoot$workflows?{}:_getRoot$workflows,validProject=(0,mobx_state_tree_module.aF)(function(){return projects.active})&&projects.active,validWorkflow=(0,mobx_state_tree_module.aF)(function(){return workflows.active})&&workflows.active,validSubject=(0,mobx_state_tree_module.aF)(function(){return subjects.active})&&subjects.active;return feedback_helpers.isFeedbackActive(validProject,validSubject,validWorkflow)},get isValid(){return self.isActive&&self.rules&&self.rules.size>0},get messages(){return self.applicableRules.map(function(rule){return rule.success?rule.successMessage:rule.failureMessage})},get shouldShowFeedback(){return self.isActive&&self.messages.length&&!self.showModal}}}).actions(function(self){function _subjectsMiddleware(call,next,abort){"advance"===call.name?_onSubjectAdvance(call,next,abort):next(call)}function _onSubjectAdvance(call,next,abort){self.shouldShowFeedback?(FeedbackStore_process.browser&&console.log("Aborting subject advance and showing feedback"),abort(),self.showFeedback()):next(call)}function _createSubjectMiddleware(){var _getRoot2,subjects=null===(_getRoot2=(0,mobx_state_tree_module.Zn)(self))||void 0===_getRoot2?void 0:_getRoot2.subjects;(0,mobx_state_tree_module.I7)(subjects,_subjectsMiddleware)}return{_onSubjectAdvance,afterAttach:function afterAttach(){var subjectMiddlewareDisposer=(0,mobx_esm.fm)(_createSubjectMiddleware);(0,mobx_state_tree_module.LF)(self,subjectMiddlewareDisposer)},createRules:function createRules(subject){if((0,mobx_state_tree_module.aF)(function(){return(0,mobx_state_tree_module.Zn)(self).workflows.active})&&subject){var workflow=(0,mobx_state_tree_module.Zn)(self).workflows.active;self.isActive&&(self.rules=feedback_helpers.generateRules(subject,workflow))}else FeedbackStore_process.browser&&console.error("Cannot create feedback rules without project, workflow, and/or subject")},setOnHide:function setOnHide(onHide){self.onHide=onHide},showFeedback:function showFeedback(){self.showModal=!0},hideFeedback:function hideFeedback(){self.onHide(),self.showModal=!1},onNewSubject:function onNewSubject(){var subject=(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).subjects.active});subject&&(self.reset(),self.createRules(subject))},update:function update(annotation){if(self.isValid){var task=annotation.task,value=annotation.value,updatedTaskRules=(self.rules.get(task)||[]).map(function(rule){return(0,strategies[rule.strategy].reducer)(rule,value)});self.rules.set(task,updatedTaskRules)}},reset:function reset(){self.rules.clear(),self.showModal=!1;var onHide=(0,mobx_state_tree_module.Zn)(self).subjects.advance;self.setOnHide(onHide)}}});var FieldGuideStore=__webpack_require__("./src/store/FieldGuideStore/index.js");function Project_slicedToArray(r,e){return function Project_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function Project_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function Project_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return Project_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Project_arrayLikeToArray(r,a):void 0}}(r,e)||function Project_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Project_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var TranslationStrings=mobx_state_tree_module.gK.map(mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.string)),Project=mobx_state_tree_module.gK.model("Project",{configuration:mobx_state_tree_module.gK.frozen({}),experimental_tools:mobx_state_tree_module.gK.frozen([]),links:mobx_state_tree_module.gK.frozen({}),strings:TranslationStrings,slug:mobx_state_tree_module.gK.string}).views(function(self){return{get defaultWorkflow(){var singleActiveWorkflow;1===self.links.active_workflows.length&&(singleActiveWorkflow=Project_slicedToArray(self.links.active_workflows,1)[0]);return singleActiveWorkflow},get display_name(){return self.strings.get("display_name")},get isVolumetricViewer(){return self.experimental_tools.includes("volumetricProject")}}});const Project_Project=mobx_state_tree_module.gK.compose("ProjectResource",Resource.A,Project);var ProjectStore=mobx_state_tree_module.gK.model("ProjectStore",{active:mobx_state_tree_module.gK.safeReference(Project_Project),resources:mobx_state_tree_module.gK.map(Project_Project),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"projects")});const store_ProjectStore=mobx_state_tree_module.gK.compose("ProjectResourceStore",ResourceStore.A,ProjectStore);var currentScopes=__webpack_require__("./node_modules/@sentry/core/build/esm/currentScopes.js"),esm_exports=__webpack_require__("./node_modules/@sentry/core/build/esm/exports.js"),src=__webpack_require__("../lib-panoptes-js/src/index.js");function getIndexedSubjects_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return getIndexedSubjects_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(getIndexedSubjects_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,getIndexedSubjects_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,getIndexedSubjects_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),getIndexedSubjects_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",getIndexedSubjects_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),getIndexedSubjects_regeneratorDefine2(u),getIndexedSubjects_regeneratorDefine2(u,o,"Generator"),getIndexedSubjects_regeneratorDefine2(u,n,function(){return this}),getIndexedSubjects_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(getIndexedSubjects_regenerator=function _regenerator(){return{w:i,m:f}})()}function getIndexedSubjects_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}getIndexedSubjects_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){getIndexedSubjects_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},getIndexedSubjects_regeneratorDefine2(e,r,n,t)}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function getIndexedSubjects(_x){return _getIndexedSubjects.apply(this,arguments)}function _getIndexedSubjects(){return _getIndexedSubjects=function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(getIndexedSubjects_regenerator().m(function _callee(subjectSetId){var priority,operator,sort,subjectSetURL,_sort,query,response,_yield$response$json,columns,rows,subjectIDColumn,subjectIds,_args=arguments;return getIndexedSubjects_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:return priority=_args.length>1&&void 0!==_args[1]?_args[1]:-1,operator=_args.length>2&&void 0!==_args[2]?_args[2]:"gt",sort=_args.length>3&&void 0!==_args[3]?_args[3]:"asc",subjectSetURL="https://subject-set-search-api.zooniverse.org/subjects/".concat(subjectSetId,".json"),_sort="asc"===sort?"_sort":"_sort_desc",query="priority__".concat(operator,"=").concat(priority,"&").concat(_sort,"=priority"),_context.n=1,fetch("".concat(subjectSetURL,"?").concat(query),{mode:"cors"});case 1:return response=_context.v,_context.n=2,response.json();case 2:return _yield$response$json=_context.v,columns=_yield$response$json.columns,rows=_yield$response$json.rows,subjectIDColumn=columns.indexOf("subject_id"),subjectIds=rows.map(function(row){return row[subjectIDColumn]}).slice(0,10),_context.a(2,subjectIds)}},_callee)})),_getIndexedSubjects.apply(this,arguments)}function subjectSelectionStrategy_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return subjectSelectionStrategy_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(subjectSelectionStrategy_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,subjectSelectionStrategy_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,subjectSelectionStrategy_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),subjectSelectionStrategy_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",subjectSelectionStrategy_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),subjectSelectionStrategy_regeneratorDefine2(u),subjectSelectionStrategy_regeneratorDefine2(u,o,"Generator"),subjectSelectionStrategy_regeneratorDefine2(u,n,function(){return this}),subjectSelectionStrategy_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(subjectSelectionStrategy_regenerator=function _regenerator(){return{w:i,m:f}})()}function subjectSelectionStrategy_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}subjectSelectionStrategy_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){subjectSelectionStrategy_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},subjectSelectionStrategy_regeneratorDefine2(e,r,n,t)}function subjectSelectionStrategy_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function subjectSelectionStrategy(_x,_x2){return _subjectSelectionStrategy.apply(this,arguments)}function _subjectSelectionStrategy(){return _subjectSelectionStrategy=function subjectSelectionStrategy_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){subjectSelectionStrategy_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){subjectSelectionStrategy_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(subjectSelectionStrategy_regenerator().m(function _callee(workflow,subjectIDs){var priority,workflow_id,ids,_params,_workflow$configurati,_workflow$configurati2,num_rows,num_columns,_params2,_apiUrl3,subjectIds,_ids,_params3,subject_set_id,_params4,params,_args=arguments;return subjectSelectionStrategy_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:if(priority=_args.length>2&&void 0!==_args[2]?_args[2]:-1,workflow_id=workflow.id,!subjectIDs){_context.n=1;break}return ids=subjectIDs.join(","),_params={ids,workflow_id},_context.a(2,{apiUrl:"/subjects/selection",params:_params});case 1:if("subjectGroup"!==workflow.configuration.subject_viewer){_context.n=2;break}return num_rows=(null===(_workflow$configurati=workflow.configuration.subject_viewer_config)||void 0===_workflow$configurati?void 0:_workflow$configurati.grid_rows)||1,num_columns=(null===(_workflow$configurati2=workflow.configuration.subject_viewer_config)||void 0===_workflow$configurati2?void 0:_workflow$configurati2.grid_columns)||1,_params2={num_columns,num_rows,workflow_id},_context.a(2,{apiUrl:"/subjects/grouped",params:_params2});case 2:if(!workflow.hasIndexedSubjects){_context.n=5;break}return _apiUrl3="/subjects/selection",_context.n=3,getIndexedSubjects(workflow.subjectSetId,priority);case 3:if(!((subjectIds=_context.v).length>0)){_context.n=4;break}return _ids=subjectIds.join(","),_params3={ids:_ids,workflow_id},_context.a(2,{apiUrl:_apiUrl3,params:_params3});case 4:return _context.a(2,null);case 5:if(!workflow.grouped){_context.n=6;break}return subject_set_id=workflow.subjectSetId,_params4={subject_set_id,workflow_id},_context.a(2,{apiUrl:"/subjects/queued",params:_params4});case 6:return params={workflow_id},_context.a(2,{apiUrl:"/subjects/queued",params})}},_callee)})),_subjectSelectionStrategy.apply(this,arguments)}var MetadataModal=__webpack_require__("./src/components/Classifier/components/MetaTools/components/Metadata/components/MetadataModal/index.js"),createLocationCounts=__webpack_require__("./src/helpers/createLocationCounts/index.js"),mst_middlewares_module=__webpack_require__("../../node_modules/mst-middlewares/dist/mst-middlewares.module.js");function Step_slicedToArray(r,e){return function Step_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function Step_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||Step_unsupportedIterableToArray(r,e)||function Step_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Step_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return Step_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Step_arrayLikeToArray(r,a):void 0}}function Step_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var taskModels=Object.values(tasks).map(function(task){return task.TaskModel});var GenericTask=mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,[{dispatcher:function taskDispatcher(snapshot){switch(snapshot.type){case"dropdown":case"dropdown-simple":return tasks.dropdownSimple.TaskModel;default:return tasks[snapshot.type].TaskModel}}}].concat(function Step_toConsumableArray(r){return function Step_arrayWithoutHoles(r){if(Array.isArray(r))return Step_arrayLikeToArray(r)}(r)||function Step_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||Step_unsupportedIterableToArray(r)||function Step_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(taskModels))),baseStep=mobx_state_tree_module.gK.model("Step",{next:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),stepKey:mobx_state_tree_module.gK.identifier,taskKeys:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.string),tasks:mobx_state_tree_module.gK.array(GenericTask)}).views(function(self){return{isComplete:function isComplete(){var annotations=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],isIncomplete=!1;return self.tasks.forEach(function(task){var _annotations$filter=annotations.filter(function(annotation){return annotation.task===task.taskKey}),annotation=Step_slicedToArray(_annotations$filter,1)[0];isIncomplete=isIncomplete||!task.isComplete(annotation)}),!isIncomplete},get isValid(){return self.tasks.every(function(task){return task.isValid})},get isThereBranching(){var singleChoiceTask=Step_slicedToArray(self.tasks.filter(function(task){return"single"===task.type}),1)[0];return null==singleChoiceTask?void 0:singleChoiceTask.answers.some(function(answer,index){return singleChoiceTask.answers.length>index+1&&answer.next!==singleChoiceTask.answers[index+1].next})},nextStepKey:function nextStepKey(){var singleChoiceAnnotation=Step_slicedToArray((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(function(annotation){return"single"===annotation.taskType}),1)[0];if(singleChoiceAnnotation){var singleChoiceTask=Step_slicedToArray(self.tasks.filter(function(task){return task.taskKey===singleChoiceAnnotation.task}),1)[0],selectedAnswer=null==singleChoiceTask?void 0:singleChoiceTask.answers[singleChoiceAnnotation.value];return null==selectedAnswer?void 0:selectedAnswer.next}return self.next}}}).actions(function(self){return{completeAndValidate:function completeAndValidate(annotations){self.tasks.forEach(function(task){var _annotations$filter5=annotations.filter(function(annotation){return annotation.task===task.taskKey}),annotation=Step_slicedToArray(_annotations$filter5,1)[0];task.complete(annotation),task.validate(annotation)})},reset:function reset(){self.tasks.forEach(function(task){return task.reset()})}}});const Step_Step=mobx_state_tree_module.gK.refinement(baseStep,function validateStep(snapshot){return snapshot.stepKey!==snapshot.next});function AnnotatedStep_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var AnnotatedStep_annotationModels=Object.values(tasks).map(function(task){return task.AnnotationModel}),TaskAnnotation=mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,function AnnotatedStep_toConsumableArray(r){return function AnnotatedStep_arrayWithoutHoles(r){if(Array.isArray(r))return AnnotatedStep_arrayLikeToArray(r)}(r)||function AnnotatedStep_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function AnnotatedStep_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return AnnotatedStep_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?AnnotatedStep_arrayLikeToArray(r,a):void 0}}(r)||function AnnotatedStep_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(AnnotatedStep_annotationModels));const AnnotatedStep_AnnotatedStep=mobx_state_tree_module.gK.model("AnnotatedStep",{id:mobx_state_tree_module.gK.identifier,step:mobx_state_tree_module.gK.safeReference(Step_Step),annotations:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.safeReference(TaskAnnotation))}).views(function(self){return{get isComplete(){return self.step.isComplete(self.annotations)},get nextStepKey(){return self.step.nextStepKey(self.annotations)}}});function beforeUnloadListener(event){return event.preventDefault(),event.returnValue="You have unsaved work. Are you sure you want to leave?"}const StepHistory_StepHistory=mobx_state_tree_module.gK.model("StepHistory",{steps:mobx_state_tree_module.gK.map(AnnotatedStep_AnnotatedStep)}).views(function(self){return{get annotations(){var annotations=[];return self.steps.forEach(function(step){annotations=annotations.concat(step.annotations)}),annotations},get classification(){var classifications=(0,mobx_state_tree_module.Zn)(self).classifications;return(0,mobx_state_tree_module.$Q)(function(){return classifications.active})},get canUndo(){return self.undoManager.canUndo},get checkForProgress(){var progressFlag=!1;return self.annotations.forEach(function(annotation){progressFlag||(progressFlag=annotation._inProgress)}),progressFlag},get hasNextStep(){if(self.latest){var nextStepKey=self.latest.nextStepKey;return!!nextStepKey&&"summary"!==nextStepKey}return!1},get latest(){var stepsArray=Array.from(self.steps.values());return stepsArray[stepsArray.length-1]}}}).actions(function(self){function _beginStep(stepKey){var workflowSteps=(0,mobx_state_tree_module.Zn)(self).workflowSteps;workflowSteps.selectStep(stepKey);var step=(0,mobx_state_tree_module.$Q)(function(){return workflowSteps.active});if(self.classification&&step){var annotations;self.undoManager.withoutUndo(function(){annotations=step.tasks.map(function(task){return self.classification.createAnnotation(task)})});var historyStep={id:cuid_default()(),step,annotations};self.steps.put(historyStep)}}function _clearRedo(){self.undoManager.withoutUndo(function(){!function _clearPendingAnnotations(){self.classification.annotations.forEach(function(annotation){self.annotations.includes(annotation)||self.classification.removeAnnotation(annotation)})}(),self.undoManager.clearRedo()})}function _observeWorkInProgress(){var _window=window,addEventListener=_window.addEventListener,removeEventListener=_window.removeEventListener;self.checkForProgress?addEventListener&&addEventListener("beforeunload",beforeUnloadListener,{capture:!0}):removeEventListener&&removeEventListener("beforeunload",beforeUnloadListener,{capture:!0})}function _redo(stepKey){self.undoManager.redo(),stepKey!==self.latest.step.stepKey&&function _replace(stepKey){self.undoManager.undo(),_clearRedo(),_beginStep(stepKey)}(stepKey)}return self.undoManager={},function setUndoManager(targetStore){targetStore.undoManager=mst_middlewares_module.ad.create({},{targetStore})}(self),{afterAttach:function afterAttach(){var workInProgressDisposer=(0,mobx_esm.fm)(_observeWorkInProgress);(0,mobx_state_tree_module.LF)(self,workInProgressDisposer)},back:function back(){self.undoManager.canUndo&&self.undoManager.undo()},finish:function finish(){var removeEventListener=window.removeEventListener;removeEventListener&&removeEventListener("beforeunload",beforeUnloadListener,{capture:!0}),self.undoManager.withoutUndo(function(){_clearRedo()})},next:function next(){var nextStepKey=self.latest.nextStepKey;self.undoManager.canRedo?_redo(nextStepKey):_beginStep(nextStepKey)},start:function start(){self.undoManager.withoutUndo(function(){_beginStep()})}}});function SubjectLocation_typeof(o){return SubjectLocation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},SubjectLocation_typeof(o)}function SubjectLocation_defineProperty(e,r,t){return(r=function SubjectLocation_toPropertyKey(t){var i=function SubjectLocation_toPrimitive(t,r){if("object"!=SubjectLocation_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=SubjectLocation_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==SubjectLocation_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function SubjectLocation_slicedToArray(r,e){return function SubjectLocation_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function SubjectLocation_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function SubjectLocation_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return SubjectLocation_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?SubjectLocation_arrayLikeToArray(r,a):void 0}}(r,e)||function SubjectLocation_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SubjectLocation_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var fileExtensions={"application/json":[".json"],"audio/mp3":[".mp3"],"audio/m4a":[".m4a"],"audio/mpeg":[".mp3"],"image/png":[".png"],"image/jpeg":[".jpg",".jpeg"],"image/gif":[".gif"],"text/plain":[".txt"],"video/mp4":[".mp4"],"video/mpeg":[".mpeg"],"video/x-m4v":[".m4v"]},ALLOWED_SUBJECT_TYPES=Object.keys(fileExtensions);var SubjectLocation=mobx_state_tree_module.gK.model("SubjectLocation",{type:mobx_state_tree_module.gK.enumeration(["application","audio","image","text","video"]),mimeType:mobx_state_tree_module.gK.enumeration(ALLOWED_SUBJECT_TYPES),url:mobx_state_tree_module.gK.string}).preProcessSnapshot(function(snapshot){var _entries$=SubjectLocation_slicedToArray(Object.entries(snapshot)[0],2),mimeType=_entries$[0],url=_entries$[1];return{type:SubjectLocation_slicedToArray(mimeType.split("/"),1)[0],mimeType,url}}).postProcessSnapshot(function(snapshot){return SubjectLocation_defineProperty({},snapshot.mimeType,snapshot.url)});const SubjectLocation_SubjectLocation=mobx_state_tree_module.gK.refinement("SubjectLocation",SubjectLocation,function validateSubjectLocation(location){var _Object$entries$=SubjectLocation_slicedToArray(Object.entries(location)[0],2),mimeType=_Object$entries$[0],url=_Object$entries$[1];return fileExtensions[mimeType].some(function(extension){return url.toLowerCase().endsWith(extension)})});const MachineLearntReductions_MachineLearntReductions=mobx_state_tree_module.gK.model("MachineLearntReductions",{reducer:mobx_state_tree_module.gK.literal("machineLearnt"),error:mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.frozen({})),loadingState:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration("state",async_states_default().values),async_states_default().initialized),reductions:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen({})),subjectId:mobx_state_tree_module.gK.string,workflowId:mobx_state_tree_module.gK.string}).views(function(self){return{findCurrentTaskMarks:function findCurrentTaskMarks(_ref){var stepKey=_ref.stepKey;if(void 0!==stepKey){var caesarMarks=[];return self.reductions.forEach(function(reduction){reduction.data.data.forEach(function(datum){datum.stepKey===stepKey&&caesarMarks.push(datum)})}),caesarMarks}}}});var TranscriptionReductions=__webpack_require__("./src/store/subjects/Subject/TranscriptionReductions/index.js"),CaesarReductions=mobx_state_tree_module.gK.union(MachineLearntReductions_MachineLearntReductions,TranscriptionReductions.A),Subject=mobx_state_tree_module.gK.model("Subject",{already_seen:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),favorite:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),finished_workflow:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),locations:mobx_state_tree_module.gK.array(SubjectLocation_SubjectLocation),metadata:mobx_state_tree_module.gK.frozen({}),retired:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),selected_at:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),selection_state:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),shouldDiscuss:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen()),stepHistory:mobx_state_tree_module.gK.maybe(StepHistory_StepHistory),user_has_finished_workflow:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),caesarReductions:mobx_state_tree_module.gK.maybeNull(CaesarReductions)}).volatile(function(self){return{caesarReductionsLoadedForStep:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.boolean)}}).postProcessSnapshot(function(snapshot){var newSnapshot=Object.assign({},snapshot);return delete newSnapshot.stepHistory,newSnapshot}).views(function(self){return{get talkURL(){if(self.project){var projectSlug=self.project.slug,origin=window.location.origin;return"".concat(origin,"/projects/").concat(projectSlug,"/talk/subjects/").concat(self.id)}return""},get viewer(){var _self$project,viewer=null,counts=(0,helpers.ss)((0,mobx_state_tree_module.dV)(self));self.workflow&&(!(viewer=self.workflow.configuration.viewerType)&&null!==(_self$project=self.project)&&void 0!==_self$project&&_self$project.isVolumetricViewer&&(viewer=helpers.yj.volumetric),viewer||1!==counts.total||(counts.images&&(viewer=helpers.yj.singleImage),counts.videos&&(viewer=helpers.yj.singleVideo),counts.json&&(viewer=helpers.yj.jsonData),counts.text&&(viewer=helpers.yj.singleText)),!viewer&&counts.total>1&&(counts.total===counts.images&&(viewer=helpers.yj.flipbook),2===counts.total&&1===counts.images&&1===counts.text&&(viewer=helpers.yj.imageAndText)));return viewer},get viewerConfiguration(){if(self.workflow)return self.workflow.configuration.subject_viewer_configuration},get project(){return(0,mobx_state_tree_module.$Q)(function(){var _getRoot$projects;return null===(_getRoot$projects=(0,mobx_state_tree_module.Zn)(self).projects)||void 0===_getRoot$projects?void 0:_getRoot$projects.active})},get workflow(){return(0,mobx_state_tree_module.$Q)(function(){var _getRoot$workflows;return null===(_getRoot$workflows=(0,mobx_state_tree_module.Zn)(self).workflows)||void 0===_getRoot$workflows?void 0:_getRoot$workflows.active})},get priority(){var _self$metadata$Prior,priority=null!==(_self$metadata$Prior=self.metadata["#priority"])&&void 0!==_self$metadata$Prior?_self$metadata$Prior:self.metadata.priority;if(void 0!==priority)return parseFloat(priority)},get alreadySeen(){var _self$workflow;return self.already_seen||helpers.VW.check(null===(_self$workflow=self.workflow)||void 0===_self$workflow?void 0:_self$workflow.id,self.id)}}}).actions(function(self){return{addToCollection:function addToCollection(){(0,mobx_state_tree_module.Zn)(self).onAddToCollection(self.id)},markAsSeen:function markAsSeen(){self.already_seen=!0},setCaesarReductions:function setCaesarReductions(_ref){var reducer=_ref.reducer,reductions=_ref.reductions,subjectId=_ref.subjectId,workflowId=_ref.workflowId;reducer&&(self.caesarReductions=CaesarReductions.create({loadingState:async_states_default().success,reducer,reductions,subjectId,workflowId}))},startClassification:function startClassification(){self.stepHistory=StepHistory_StepHistory.create({}),self.stepHistory.start()},toggleFavorite:function toggleFavorite(){var rootStore=(0,mobx_state_tree_module.Zn)(self);self.favorite=!self.favorite,rootStore.onToggleFavourite(self.id,self.favorite)},setCaesarReductionsLoadedForStep:function setCaesarReductionsLoadedForStep(stepIndex){self.caesarReductionsLoadedForStep[stepIndex]=!0}}});const Subject_Subject=mobx_state_tree_module.gK.compose("SubjectResource",Resource.A,Subject);const ImageSubject_ImageSubject=mobx_state_tree_module.gK.refinement(Subject_Subject.named("ImageSubject"),function(subject){var counts=(0,createLocationCounts.A)(subject);return subject.locations.length>1&&counts.images===subject.locations.length});const ImageAndTextSubject_ImageAndTextSubject=mobx_state_tree_module.gK.refinement(Subject_Subject.named("ImageAndTextSubject"),function(subject){var counts=(0,helpers.ss)(subject);return 2===counts.total&&1===counts.images&&1===counts.text});const SingleImageSubject_SingleImageSubject=mobx_state_tree_module.gK.refinement(Subject_Subject.named("SingleImageSubject"),function(subject){var counts=(0,createLocationCounts.A)(subject);return 1===subject.locations.length&&1===counts.images});const SingleJSONSubject_SingleJSONSubject=mobx_state_tree_module.gK.refinement(Subject_Subject.named("SingleJSONSubject"),function(subject){return 1===(0,createLocationCounts.A)(subject).json});const SingleTextSubject_SingleTextSubject=mobx_state_tree_module.gK.refinement(Subject_Subject.named("SingleTextSubject"),function(subject){var counts=(0,helpers.ss)(subject);return 1===counts.total&&1===counts.text});const SingleVideoSubject_SingleVideoSubject=mobx_state_tree_module.gK.refinement(Subject_Subject.named("SingleVideoSubject"),function(subject){var counts=(0,createLocationCounts.A)(subject);return 1===subject.locations.length&&1===counts.videos});var subjectViewers=__webpack_require__("./src/helpers/subjectViewers/index.js"),SubjectGroup=mobx_state_tree_module.gK.model("SubjectGroup",{subjectIds:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.string)}).preProcessSnapshot(function(snapshot){var _snapshot$metadata,newSnapshot=Object.assign({},snapshot);return newSnapshot.subjectIds=(null==snapshot||null===(_snapshot$metadata=snapshot.metadata)||void 0===_snapshot$metadata||null===(_snapshot$metadata=_snapshot$metadata["#group_subject_ids"])||void 0===_snapshot$metadata?void 0:_snapshot$metadata.split("-"))||[],newSnapshot});const SubjectGroup_SubjectGroup=mobx_state_tree_module.gK.compose("SubjectGroup",Subject_Subject,SubjectGroup);const TextSubject_TextSubject=mobx_state_tree_module.gK.refinement(Subject_Subject.named("TextSubject"),function(subject){return(0,helpers.ss)(subject).text>0});function SubjectType_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var SubjectType_SubjectGroup=SubjectGroup_SubjectGroup,singleSubjects=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(subjects_namespaceObject,["SubjectGroup"]),SingleSubject=mobx_state_tree_module.gK.union.apply(mobx_state_tree_module.gK,function SubjectType_toConsumableArray(r){return function SubjectType_arrayWithoutHoles(r){if(Array.isArray(r))return SubjectType_arrayLikeToArray(r)}(r)||function SubjectType_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function SubjectType_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return SubjectType_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?SubjectType_arrayLikeToArray(r,a):void 0}}(r)||function SubjectType_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object.values(singleSubjects)));const SubjectType_SubjectType=mobx_state_tree_module.gK.union({dispatcher:function subjectDispatcher(snapshot){var _snapshot$metadata;return null!=snapshot&&null!==(_snapshot$metadata=snapshot.metadata)&&void 0!==_snapshot$metadata&&_snapshot$metadata["#subject_group_id"]?SubjectType_SubjectGroup:SingleSubject}},SingleSubject,SubjectType_SubjectGroup);function AvailableSubjects_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return AvailableSubjects_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(AvailableSubjects_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,AvailableSubjects_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,AvailableSubjects_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),AvailableSubjects_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",AvailableSubjects_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),AvailableSubjects_regeneratorDefine2(u),AvailableSubjects_regeneratorDefine2(u,o,"Generator"),AvailableSubjects_regeneratorDefine2(u,n,function(){return this}),AvailableSubjects_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(AvailableSubjects_regenerator=function _regenerator(){return{w:i,m:f}})()}function AvailableSubjects_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}AvailableSubjects_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){AvailableSubjects_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},AvailableSubjects_regeneratorDefine2(e,r,n,t)}function AvailableSubjects_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function AvailableSubjects_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){AvailableSubjects_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){AvailableSubjects_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}const AvailableSubjects=mobx_state_tree_module.gK.model("AvailableSubjects",{subjects:mobx_state_tree_module.gK.array(SubjectType_SubjectType)}).actions(function(self){var _marked=AvailableSubjects_regenerator().m(next);function _fetchAvailableSubjects(_x){return _fetchAvailableSubjects2.apply(this,arguments)}function _fetchAvailableSubjects2(){return(_fetchAvailableSubjects2=AvailableSubjects_asyncToGenerator(AvailableSubjects_regenerator().m(function _callee(workflow){var params;return AvailableSubjects_regenerator().w(function(_context2){for(;;)switch(_context2.n){case 0:return params={page_size:10,workflow_id:workflow.id},workflow.grouped&&(params.subject_set_id=workflow.subjectSetId),_context2.n=1,_fetchSubjects({apiUrl:"/subjects/queued",params});case 1:return _context2.a(2,_context2.v)}},_callee)}))).apply(this,arguments)}function _fetchSubjects(_x2){return _fetchSubjects2.apply(this,arguments)}function _fetchSubjects2(){return(_fetchSubjects2=AvailableSubjects_asyncToGenerator(AvailableSubjects_regenerator().m(function _callee2(_ref){var _response$body$subjec,apiUrl,params,_getRoot,authClient,panoptes,authorization,response;return AvailableSubjects_regenerator().w(function(_context3){for(;;)switch(_context3.n){case 0:return apiUrl=_ref.apiUrl,params=_ref.params,_getRoot=(0,mobx_state_tree_module.Zn)(self),authClient=_getRoot.authClient,panoptes=_getRoot.client.panoptes,_context3.n=1,(0,utils.Rb)(authClient);case 1:return authorization=_context3.v,_context3.n=2,panoptes.get(apiUrl,params,{authorization});case 2:if(response=_context3.v,!((null===(_response$body$subjec=response.body.subjects)||void 0===_response$body$subjec?void 0:_response$body$subjec.length)>0)){_context3.n=3;break}return _context3.a(2,response.body.subjects);case 3:return _context3.a(2,[])}},_callee2)}))).apply(this,arguments)}function next(workflow){var availableSubjects,newSubject,_t;return AvailableSubjects_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(!workflow){_context.n=6;break}if(_context.p=1,0!==self.subjects.length){_context.n=3;break}return _context.n=2,_fetchAvailableSubjects(workflow);case 2:availableSubjects=_context.v,self.subjects.replace(availableSubjects);case 3:if(!(self.subjects.length>0)){_context.n=4;break}return newSubject=(0,mobx_state_tree_module.dV)(self.subjects[0]),self.subjects.shift(),_context.a(2,newSubject);case 4:_context.n=6;break;case 5:_context.p=5,_t=_context.v,console.error(_t);case 6:return _context.a(2)}},_marked,null,[[1,5]])}return{clear:function clear(){self.subjects.clear()},next:(0,mobx_state_tree_module.L3)(next)}});function SubjectStore_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return SubjectStore_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(SubjectStore_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,SubjectStore_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,SubjectStore_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),SubjectStore_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",SubjectStore_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),SubjectStore_regeneratorDefine2(u),SubjectStore_regeneratorDefine2(u,o,"Generator"),SubjectStore_regeneratorDefine2(u,n,function(){return this}),SubjectStore_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(SubjectStore_regenerator=function _regenerator(){return{w:i,m:f}})()}function SubjectStore_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}SubjectStore_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){SubjectStore_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},SubjectStore_regeneratorDefine2(e,r,n,t)}function SubjectStore_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function SubjectStore_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){SubjectStore_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){SubjectStore_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function SubjectStore_slicedToArray(r,e){return function SubjectStore_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function SubjectStore_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function SubjectStore_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return SubjectStore_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?SubjectStore_arrayLikeToArray(r,a):void 0}}(r,e)||function SubjectStore_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SubjectStore_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var SubjectStore=mobx_state_tree_module.gK.model("SubjectStore",{active:mobx_state_tree_module.gK.safeReference(SubjectType_SubjectType),available:mobx_state_tree_module.gK.optional(AvailableSubjects,function(){return AvailableSubjects.create({})}),queue:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.safeReference(SubjectType_SubjectType)),resources:mobx_state_tree_module.gK.map(SubjectType_SubjectType),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"subjects")}).views(function(self){return{get classification(){var classifications=(0,mobx_state_tree_module.Zn)(self).classifications;return(0,mobx_state_tree_module.$Q)(function(){return classifications.active})},get isThereMetadata(){return!!(0,mobx_state_tree_module.aF)(function(){return self.active})&&Object.keys(self.active.metadata).filter(function(label){return(0,MetadataModal.Ko)(label,MetadataModal.uW)}).length>0},get first(){return SubjectStore_slicedToArray(self.queue,1)[0]},get last(){var lastSubject;return self.queue.length>0&&(lastSubject=self.queue[self.queue.length-1]),lastSubject},get prioritized(){var workflows=(0,mobx_state_tree_module.Zn)(self).workflows,workflow=(0,mobx_state_tree_module.$Q)(function(){return null==workflows?void 0:workflows.active});return null==workflow?void 0:workflow.prioritized}}}).volatile(function(self){return{onReset:function onReset(){return null}}}).actions(function(self){var _marked=SubjectStore_regenerator().m(buildPreviousQueue),_marked2=SubjectStore_regenerator().m(nextAvailable),_marked3=SubjectStore_regenerator().m(populateQueue);function _addMiddleware(call,next,abort){"advance"===call.name?function _onSubjectAdvance(call,next,abort){next(call)}(call,next):next(call)}function _onClassificationChange(){var subject=(0,mobx_state_tree_module.$Q)(function(){return self.active});self.classification&&subject&&subject.startClassification()}function _fetchPreviousSubjects(_x,_x2){return _fetchPreviousSubjects2.apply(this,arguments)}function _fetchPreviousSubjects2(){return(_fetchPreviousSubjects2=SubjectStore_asyncToGenerator(SubjectStore_regenerator().m(function _callee(workflow,priority){var ids,params,newSubjects;return SubjectStore_regenerator().w(function(_context4){for(;;)switch(_context4.n){case 0:return _context4.n=1,getIndexedSubjects(workflow.subjectSetId,priority,"lt","desc");case 1:if(!((ids=_context4.v).length>0)){_context4.n=3;break}return params={ids:ids.join(","),workflow_id:workflow.id},_context4.n=2,_fetchSubjects({apiUrl:"/subjects/selection",params});case 2:return newSubjects=_context4.v,_context4.a(2,newSubjects);case 3:return _context4.a(2,[])}},_callee)}))).apply(this,arguments)}function _fetchSubjects(_x3){return _fetchSubjects2.apply(this,arguments)}function _fetchSubjects2(){return(_fetchSubjects2=SubjectStore_asyncToGenerator(SubjectStore_regenerator().m(function _callee2(_ref){var apiUrl,params,_getRoot3,authClient,panoptes,_response$body$subjec,authorization,tokenError,token,_yield$auth$verify,error,response,_t4;return SubjectStore_regenerator().w(function(_context5){for(;;)switch(_context5.p=_context5.n){case 0:return apiUrl=_ref.apiUrl,params=_ref.params,_getRoot3=(0,mobx_state_tree_module.Zn)(self),authClient=_getRoot3.authClient,panoptes=_getRoot3.client.panoptes,_context5.p=1,_context5.n=2,(0,utils.Rb)(authClient);case 2:if(!(authorization=_context5.v)){_context5.n=4;break}return token=authorization.replace("Bearer ",""),_context5.n=3,src.j2.verify(token);case 3:_yield$auth$verify=_context5.v,_yield$auth$verify.data,error=_yield$auth$verify.error,tokenError=error;case 4:return _context5.n=5,panoptes.get(apiUrl,params,{authorization});case 5:if(response=_context5.v,tokenError&&(console.error(tokenError),currentScopes.v4(function(scope){scope.setTag("subjectQueueError","tokenError"),esm_exports.Cp(tokenError)})),!((null===(_response$body$subjec=response.body.subjects)||void 0===_response$body$subjec?void 0:_response$body$subjec.length)>0)){_context5.n=6;break}return _context5.a(2,response.body.subjects);case 6:_context5.n=8;break;case 7:_context5.p=7,_t4=_context5.v,console.error(_t4);case 8:return _context5.a(2,[])}},_callee2,null,[[1,7]])}))).apply(this,arguments)}function buildPreviousQueue(currentPriority){var workflow,newSubjects,activeIndex,previousSubject,_t;return SubjectStore_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(workflow=(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).workflows.active}),_context.p=1,null==workflow||!workflow.hasIndexedSubjects){_context.n=3;break}return self.loadingState=async_states_default().loading,_context.n=2,_fetchPreviousSubjects(workflow,self.first.priority);case 2:newSubjects=_context.v,self.loadingState=async_states_default().success,self.prepend(newSubjects),(activeIndex=self.queue.findIndex(function(subject){return subject.priority===currentPriority}))>0&&(previousSubject=self.queue[activeIndex-1],self.setActiveSubject(previousSubject.id));case 3:_context.n=5;break;case 4:_context.p=4,_t=_context.v,console.error(_t),self.loadingState=async_states_default().error;case 5:return _context.a(2)}},_marked,null,[[1,4]])}function nextAvailable(){var root,workflow,newSubject,_t2;return SubjectStore_regenerator().w(function(_context2){for(;;)switch(_context2.p=_context2.n){case 0:if(root=(0,mobx_state_tree_module.Zn)(self),!(workflow=(0,mobx_state_tree_module.$Q)(function(){return root.workflows.active}))){_context2.n=4;break}return _context2.p=1,self.resources.clear(),self.loadingState=async_states_default().loading,_context2.n=2,self.available.next(workflow);case 2:newSubject=_context2.v,self.loadingState=async_states_default().success,newSubject&&self.append([newSubject]),_context2.n=4;break;case 3:_context2.p=3,_t2=_context2.v,console.error(_t2),self.loadingState=async_states_default().error;case 4:return _context2.a(2)}},_marked2,null,[[1,3]])}function populateQueue(subjectIDs){var root,workflow,_self$last2,strategy,apiUrl,params,subjects,_t3;return SubjectStore_regenerator().w(function(_context3){for(;;)switch(_context3.p=_context3.n){case 0:if(root=(0,mobx_state_tree_module.Zn)(self),!(workflow=(0,mobx_state_tree_module.$Q)(function(){return root.workflows.active}))){_context3.n=6;break}return _context3.p=1,_context3.n=2,subjectSelectionStrategy(workflow,subjectIDs,null===(_self$last2=self.last)||void 0===_self$last2?void 0:_self$last2.priority);case 2:if(!(strategy=_context3.v)){_context3.n=4;break}return apiUrl=strategy.apiUrl,params=strategy.params,self.loadingState=async_states_default().loading,_context3.n=3,_fetchSubjects({apiUrl,params});case 3:subjects=_context3.v,self.loadingState=async_states_default().success,(null==subjects?void 0:subjects.length)>0&&self.append(subjects);case 4:_context3.n=6;break;case 5:_context3.p=5,_t3=_context3.v,console.error(_t3),self.loadingState=async_states_default().error;case 6:return _context3.a(2)}},_marked3,null,[[1,5]])}return{advance:function advance(){var workflow=(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).workflows.active}),activeSubject=(0,mobx_state_tree_module.$Q)(function(){return self.active});null!=workflow&&workflow.hasIndexedSubjects?(null==activeSubject||activeSubject.markAsSeen(),self.nextIndexed()):self.shift()},afterAttach:function afterAttach(){(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(_onClassificationChange)),(0,mobx_state_tree_module.I7)(self,_addMiddleware)},append:function append(newSubjects){newSubjects.forEach(function(subject){try{var alreadyStored=self.resources.get(subject.id),notSeen=!0;if(!subject.user_has_finished_workflow&&self.prioritized){var _subject$metadata$Pr,_self$last,metadataPriority=null!==(_subject$metadata$Pr=subject.metadata["#priority"])&&void 0!==_subject$metadata$Pr?_subject$metadata$Pr:subject.metadata.priority,priority=metadataPriority?parseFloat(metadataPriority):-1,lastPriority=(null===(_self$last=self.last)||void 0===_self$last?void 0:_self$last.priority)||-1;if(-1===priority)throw new Error("Subject ".concat(subject.id,": missing priority field for prioritised workflow."));notSeen=priority>lastPriority}notSeen&&!alreadyStored&&(self.resources.put(subject),self.queue.push(subject.id))}catch(error){esm_exports.Cp(error),console.error("Subject ".concat(subject.id," is not a valid subject.")),console.error(error)}}),!(0,mobx_state_tree_module.$Q)(function(){return self.active})&&self.resources.size>0&&self.advance()},buildPreviousQueue:(0,mobx_state_tree_module.L3)(buildPreviousQueue),clearQueue:function clearQueue(){self.onReset(),self.reset()},nextIndexed:function nextIndexed(){var activeSubject=(0,mobx_state_tree_module.$Q)(function(){return self.active}),workflow=(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).workflows.active});if(null!=workflow&&workflow.hasIndexedSubjects){self.available.clear();var nextSubjects=self.queue;if(activeSubject){var activeIndex=self.queue.indexOf(activeSubject);nextSubjects=self.queue.slice(activeIndex+1)}var nextSubject=nextSubjects[0];nextSubject&&self.setActiveSubject(nextSubject.id),nextSubjects.length<=3&&(console.log("Fetching more subjects"),self.populateQueue())}},nextAvailable:(0,mobx_state_tree_module.L3)(nextAvailable),prepend:function prepend(){var newSubjects=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];newSubjects.length>0&&newSubjects.forEach(function(subjectSnapshot){try{self.resources.put(subjectSnapshot),self.queue.unshift(subjectSnapshot.id)}catch(error){console.error("Subject ".concat(subject.id," is not a valid subject.")),console.error(error)}})},populateQueue:(0,mobx_state_tree_module.L3)(populateQueue),previousIndexed:function previousIndexed(){var root=(0,mobx_state_tree_module.Zn)(self),workflow=(0,mobx_state_tree_module.$Q)(function(){return root.workflows.active}),activeSubject=(0,mobx_state_tree_module.$Q)(function(){return self.active}),currentPriority=null==activeSubject?void 0:activeSubject.priority;if(null!=workflow&&workflow.hasIndexedSubjects){self.available.clear();var previousSubjects=[];if(activeSubject){var activeIndex=self.queue.indexOf(activeSubject);previousSubjects=self.queue.slice(0,activeIndex)}if(previousSubjects.length>0){var previousSubject=previousSubjects[previousSubjects.length-1];self.setActiveSubject(previousSubject.id)}previousSubjects.length<=3&&self.buildPreviousQueue(currentPriority)}},reset:function reset(){self.active=void 0,self.resources.clear(),self.available.clear()},setActiveSubject:function setActiveSubject(subjectID){self.active=subjectID,console.log("Loading subject",subjectID)},setOnReset:function setOnReset(callback){self.onReset=callback},setResources:function setResources(){var subjects=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(subjects.length>0)try{subjects.forEach(function(subject){subject&&(self.resources.put(subject),self.queue.push(subject.id))}),self.loadingState=async_states_default().success}catch(error){console.error(error)}},shift:function shift(){var subject=(0,mobx_state_tree_module.$Q)(function(){return self.active});subject&&self.resources.delete(subject.id),self.resources.size<3&&(console.log("Fetching more subjects"),self.populateQueue()),self.first&&self.setActiveSubject(self.first.id)}}});const SubjectStore_SubjectStore=mobx_state_tree_module.gK.compose("SubjectResourceStore",ResourceStore.A,SubjectStore);var SubjectSet=mobx_state_tree_module.gK.model("SubjectSet",{display_name:mobx_state_tree_module.gK.string,links:mobx_state_tree_module.gK.frozen({}),metadata:mobx_state_tree_module.gK.frozen({}),set_member_subjects_count:mobx_state_tree_module.gK.number}).views(function(self){return{get isIndexed(){var _self$metadata$indexF;return(null===(_self$metadata$indexF=self.metadata.indexFields)||void 0===_self$metadata$indexF?void 0:_self$metadata$indexF.length)>0}}});const SubjectSet_SubjectSet=mobx_state_tree_module.gK.compose("SubjectSetResource",Resource.A,SubjectSet);var SubjectSetStore=mobx_state_tree_module.gK.model("SubjectSetStore",{active:mobx_state_tree_module.gK.safeReference(SubjectSet_SubjectSet),resources:mobx_state_tree_module.gK.map(SubjectSet_SubjectSet),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"subject_sets")});const SubjectSetStore_SubjectSetStore=mobx_state_tree_module.gK.compose("SubjectSetResourceStore",ResourceStore.A,SubjectSetStore);var SubjectViewerStore_process=__webpack_require__("../../node_modules/process/browser.js"),SubjectViewer=mobx_state_tree_module.gK.model("SubjectViewer",{annotate:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!0),dimensions:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen({clientHeight:mobx_state_tree_module.gK.integer,clientWidth:mobx_state_tree_module.gK.integer,naturalHeight:mobx_state_tree_module.gK.integer,naturalWidth:mobx_state_tree_module.gK.integer})),flipbookSpeed:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,1),frame:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.integer,0),fullscreen:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),invert:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),loadingState:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration("loadingState",async_states_default().values),async_states_default().initialized),move:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),rotationEnabled:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),rotation:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,0),separateFramesView:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),videoSpeed:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"1x"),volume:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,1)}).volatile(function(self){return{onZoom:function onZoom(type,zoomValue){},onPan:function onPan(xDirection,yDirection){}}}).views(function(self){return{get disableImageToolbar(){var subject=(0,mobx_state_tree_module.$Q)(function(){var _getRoot$subjects;return null===(_getRoot$subjects=(0,mobx_state_tree_module.Zn)(self).subjects)||void 0===_getRoot$subjects?void 0:_getRoot$subjects.active}),frameType=null==subject?void 0:subject.locations[self.frame].type;return"text"===frameType||"video"===frameType},get disableInvertButton(){var subject=(0,mobx_state_tree_module.$Q)(function(){var _getRoot$subjects2;return null===(_getRoot$subjects2=(0,mobx_state_tree_module.Zn)(self).subjects)||void 0===_getRoot$subjects2?void 0:_getRoot$subjects2.active});return"text"===(null==subject?void 0:subject.locations[self.frame].type)},get hasActiveAnnotateTask(){var _getRoot;return null===(_getRoot=(0,mobx_state_tree_module.Zn)(self))||void 0===_getRoot?void 0:_getRoot.workflowSteps.hasActiveAnnotateTask},get hasAnnotateTask(){var _getRoot2;return null===(_getRoot2=(0,mobx_state_tree_module.Zn)(self))||void 0===_getRoot2?void 0:_getRoot2.workflowSteps.hasAnnotateTask},get interactionMode(){return!self.annotate&&self.move?"move":"annotate"}}}).actions(function(self){return{afterAttach:function afterAttach(){(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(function _syncAnnotateVisibility(){self.setAnnotateVisibility(self.hasActiveAnnotateTask),self.hasActiveAnnotateTask?self.enableAnnotate():self.enableMove()})),function createSubjectObserver(){var subjectDisposer=(0,mobx_esm.fm)(function(){if((0,mobx_state_tree_module.aF)(function(){return(0,mobx_state_tree_module.Zn)(self).subjects.active})){var subject=(0,mobx_state_tree_module.Zn)(self).subjects.active;self.resetSubject(subject)}},{name:"SubjectViewerStore Subject Observer autorun"});(0,mobx_state_tree_module.LF)(self,subjectDisposer)}(),function createWorkflowConfigObserver(){var workflowConfigDisposer=(0,mobx_esm.fm)(function(){if((0,mobx_state_tree_module.aF)(function(){return(0,mobx_state_tree_module.Zn)(self).workflows.active})){var _getRoot$workflows$ac,defaultMode=null===(_getRoot$workflows$ac=(0,mobx_state_tree_module.Zn)(self).workflows.active)||void 0===_getRoot$workflows$ac||null===(_getRoot$workflows$ac=_getRoot$workflows$ac.configuration)||void 0===_getRoot$workflows$ac?void 0:_getRoot$workflows$ac.multi_image_mode;self.setSeparateFramesView("separate"===defaultMode)}},{name:"SubjectViewerStore Workflow Config Observer autorun"});(0,mobx_state_tree_module.LF)(self,workflowConfigDisposer)}()},enableAnnotate:function enableAnnotate(){self.annotate=!0,self.move=!1},enableFullscreen:function enableFullscreen(){self.fullscreen=!0},enableMove:function enableMove(){self.annotate=!1,self.move=!0},enableRotation:function enableRotation(){self.rotationEnabled=!0},disableFullscreen:function disableFullscreen(){self.fullscreen=!1},invertView:function invertView(){self.invert=!self.invert},onError:function onError(error){SubjectViewerStore_process.browser&&console.error(error),self.loadingState=async_states_default().error},onSubjectReady:function onSubjectReady(event){var frameIndex=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,_ref$target=(event||{}).target,_ref2=(void 0===_ref$target?{}:_ref$target)||{},_ref2$clientHeight=_ref2.clientHeight,clientHeight=void 0===_ref2$clientHeight?0:_ref2$clientHeight,_ref2$clientWidth=_ref2.clientWidth,clientWidth=void 0===_ref2$clientWidth?0:_ref2$clientWidth,_ref2$naturalHeight=_ref2.naturalHeight,naturalHeight=void 0===_ref2$naturalHeight?0:_ref2$naturalHeight,_ref2$naturalWidth=_ref2.naturalWidth,naturalWidth=void 0===_ref2$naturalWidth?0:_ref2$naturalWidth;self.dimensions[frameIndex]={clientHeight,clientWidth,naturalHeight,naturalWidth},self.rotation=0,self.loadingState=async_states_default().success},panLeft:function panLeft(){self.onPan&&self.onPan(-1,0)},panRight:function panRight(){self.onPan&&self.onPan(1,0)},panUp:function panUp(){self.onPan&&self.onPan(0,-1)},panDown:function panDown(){self.onPan&&self.onPan(0,1)},resetSubject:function resetSubject(subject){var _subject$metadata,frame=0;(null==subject||null===(_subject$metadata=subject.metadata)||void 0===_subject$metadata?void 0:_subject$metadata.default_frame)>0&&(frame=parseInt(subject.metadata.default_frame-1)),self.dimensions=[],self.frame=frame,self.invert=!1,self.loadingState=async_states_default().loading,self.rotation=0},resetView:function resetView(){console.log("resetting view"),self.invert=!1,self.onZoom&&self.onZoom("zoomto",1),self.rotation=0},rotate:function rotate(){console.log("rotating subject"),self.rotation-=90},setAnnotateVisibility:function setAnnotateVisibility(canAnnotate){canAnnotate?self.enableAnnotate():self.enableMove()},setFlipbookSpeed:function setFlipbookSpeed(speed){self.flipbookSpeed=speed},setFrame:function setFrame(index){self.frame=index},setOnZoom:function setOnZoom(callback){self.onZoom=callback},setOnPan:function setOnPan(callback){self.onPan=callback},setSeparateFramesView:function setSeparateFramesView(mode){self.separateFramesView=mode},setVideoSpeed:function setVideoSpeed(value){self.videoSpeed=value},setVolume:function setVolume(value){self.volume=value},zoomIn:function zoomIn(){console.log("zooming in"),self.onZoom&&self.onZoom("zoomin",1)},zoomOut:function zoomOut(){console.log("zooming out"),self.onZoom&&self.onZoom("zoomout",-1)}}});const SubjectViewerStore=SubjectViewer;var Medium=__webpack_require__("./src/store/Medium/index.js");function Tutorial_typeof(o){return Tutorial_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Tutorial_typeof(o)}function Tutorial_defineProperty(e,r,t){return(r=function Tutorial_toPropertyKey(t){var i=function Tutorial_toPrimitive(t,r){if("object"!=Tutorial_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=Tutorial_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==Tutorial_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Tutorial=mobx_state_tree_module.gK.model("Tutorial",{display_name:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),kind:mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.enumeration(["mini-course","tutorial"])),language:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),steps:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen({content:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),media:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string)}))}).views(function(self){return{get hasNotBeenSeen(){var _upp$preferences$tuto,uppStore=(0,mobx_state_tree_module.Zn)(self).userProjectPreferences,upp=(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).userProjectPreferences.active});return upp?!(null===(_upp$preferences$tuto=upp.preferences.tutorials_completed_at)||void 0===_upp$preferences$tuto?void 0:_upp$preferences$tuto[self.id]):(null==uppStore?void 0:uppStore.loadingState)===async_states_default().success}}}).actions(function(self){return{setSeenTime:function setSeenTime(){var uppStore=(0,mobx_state_tree_module.Zn)(self).userProjectPreferences,upp=(0,mobx_state_tree_module.$Q)(function(){return uppStore.active}),seen=(new Date).toISOString();if(("tutorial"===self.kind||null===self.kind)&&upp){var changes={preferences:{tutorials_completed_at:Tutorial_defineProperty({},self.id,seen)}};uppStore.updateUPP(changes)}}}});const Tutorial_Tutorial=mobx_state_tree_module.gK.compose("TutorialResource",Resource.A,Tutorial);function TutorialStore_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return TutorialStore_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(TutorialStore_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,TutorialStore_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,TutorialStore_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),TutorialStore_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",TutorialStore_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),TutorialStore_regeneratorDefine2(u),TutorialStore_regeneratorDefine2(u,o,"Generator"),TutorialStore_regeneratorDefine2(u,n,function(){return this}),TutorialStore_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(TutorialStore_regenerator=function _regenerator(){return{w:i,m:f}})()}function TutorialStore_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}TutorialStore_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){TutorialStore_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},TutorialStore_regeneratorDefine2(e,r,n,t)}var TutorialStore=mobx_state_tree_module.gK.model("TutorialStore",{active:mobx_state_tree_module.gK.safeReference(Tutorial_Tutorial),activeMedium:mobx_state_tree_module.gK.safeReference(Medium.A),activeStep:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.integer,0),attachedMedia:mobx_state_tree_module.gK.map(Medium.A),resources:mobx_state_tree_module.gK.map(Tutorial_Tutorial),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"tutorials")}).views(function(self){return{get isActiveReferenceValid(){return(0,mobx_state_tree_module.aF)(function(){return self.active})},get isActiveStepValid(){return self.isActiveReferenceValid&&self.activeStep>-1},get disableTutorialTab(){return self.loadingState!==async_states_default().success||self.loadingState===async_states_default().success&&!self.tutorial},stepWithMedium:function stepWithMedium(index){var tutorial=(0,mobx_state_tree_module.$Q)(function(){return self.active}),step=null==tutorial?void 0:tutorial.steps[index];return step?{step,medium:self.attachedMedia.get(step.media)}:{}},get tutorial(){var tutorials=Array.from(self.resources.values());return tutorials?tutorials.find(function(tutorial){return"tutorial"===tutorial.kind||null===tutorial.kind}):null},get miniCourse(){var tutorials=Array.from(self.resources.values());return tutorials?tutorials.find(function(tutorial){return"mini-course"===tutorial.kind}):null},isMiniCourseCompleted:function isMiniCourseCompleted(lastStepSeen){var miniCourse=self.miniCourse;return!!miniCourse&&lastStepSeen===miniCourse.steps.length-1}}}).actions(function(self){var _marked=TutorialStore_regenerator().m(fetchTutorials);function _onWorkflowChange(){(0,mobx_state_tree_module.$Q)(function(){return(0,mobx_state_tree_module.Zn)(self).workflows.active})&&(self.reset(),self.fetchTutorials())}var fetchMedia=(0,mobx_state_tree_module.L3)(TutorialStore_regenerator().m(function fetchMedia(tutorial){var tutorials,response,media,_t;return TutorialStore_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(tutorials=(0,mobx_state_tree_module.Zn)(self).client.tutorials,!tutorial){_context.n=4;break}return self.loadingState=async_states_default().loading,_context.p=1,_context.n=2,tutorials.getAttachedImages({id:tutorial.id});case 2:response=_context.v,(media=response.body.media)&&media.length>0&&self.setMediaResources(media),_context.n=4;break;case 3:_context.p=3,_t=_context.v,console.error(_t);case 4:return _context.a(2)}},fetchMedia,null,[[1,3]])}));function fetchTutorials(){var workflow,tutorialsClient,response,tutorials,mediaRequests,_t2;return TutorialStore_regenerator().w(function(_context2){for(;;)switch(_context2.p=_context2.n){case 0:return workflow=(0,mobx_state_tree_module.Zn)(self).workflows.active,tutorialsClient=(0,mobx_state_tree_module.Zn)(self).client.tutorials,(0,mobx_state_tree_module.Zn)(self).userProjectPreferences,self.loadingState=async_states_default().loading,_context2.p=1,_context2.n=2,tutorialsClient.get({workflowId:workflow.id});case 2:if(response=_context2.v,!((tutorials=response.body.tutorials)&&tutorials.length>0)){_context2.n=4;break}return mediaRequests=tutorials.map(fetchMedia),_context2.n=3,Promise.all(mediaRequests);case 3:self.setTutorials(tutorials),self.loadingState=async_states_default().success,_context2.n=5;break;case 4:self.loadingState=async_states_default().success;case 5:_context2.n=7;break;case 6:_context2.p=6,_t2=_context2.v,console.error(_t2),self.loadingState=async_states_default().error;case 7:return _context2.a(2)}},_marked,null,[[1,6]])}return{afterAttach:function afterAttach(){(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(_onWorkflowChange))},fetchTutorials:(0,mobx_state_tree_module.L3)(fetchTutorials),resetActiveTutorial:function resetActiveTutorial(){self.active=void 0,self.activeStep=0,self.activeMedium=void 0},setActiveTutorial:function setActiveTutorial(tutorialID){var tutorial=(0,mobx_state_tree_module.$Q)(function(){return self.active});tutorialID?tutorialID===(null==tutorial?void 0:tutorial.id)||(self.active=tutorialID):self.resetActiveTutorial()},setMediaResources:function setMediaResources(media){media.forEach(function(medium){return self.attachedMedia.put(medium)})},setTutorials:function setTutorials(tutorials){tutorials.forEach(function(tutorial){return self.resources.put(tutorial)});var tutorial=self.tutorial;self.active=null==tutorial?void 0:tutorial.id}}});const TutorialStore_TutorialStore=mobx_state_tree_module.gK.compose("TutorialResourceStore",ResourceStore.A,TutorialStore);const WorkflowConfiguration_WorkflowConfiguration=mobx_state_tree_module.gK.snapshotProcessor(mobx_state_tree_module.gK.model({enable_caesar_data_fetching:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),enable_switching_flipbook_and_separate:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),flipbook_autoplay:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),invert_subject:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),limit_subject_height:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),multi_image_clone_markers:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),multi_image_mode:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration("multiImageMode",["flipbook","separate"]),"flipbook"),multi_image_layout:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration("multiImageLayout",["col","grid2","grid3","row"]),"col"),playIterations:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.number,3),subject_viewer:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.enumeration("subjectViewer",["dataImage","flipbook","geoMap","jsonData","lightcurve","multiFrame","scatterPlot","singleImage","subjectGroup","variableStar"])),subject_viewer_config:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen({zoomConfiguration:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen({direction:mobx_state_tree_module.gK.enumeration(["both","x","y"]),minZoom:mobx_state_tree_module.gK.number,maxZoom:mobx_state_tree_module.gK.number,zoomInValue:mobx_state_tree_module.gK.number,zoomOutValue:mobx_state_tree_module.gK.number}))}))}).views(function(self){return{get viewerType(){switch(self.subject_viewer){case"dataImage":return subjectViewers.A.dataImage;case"flipbook":return subjectViewers.A.flipbook;case"geoMap":return subjectViewers.A.geoMap;case"jsonData":return subjectViewers.A.jsonData;case"lightcurve":return subjectViewers.A.lightCurve;case"multiFrame":return subjectViewers.A.multiFrame;case"scatterPlot":return subjectViewers.A.scatterPlot;case"singleImage":return subjectViewers.A.singleImage;case"subjectGroup":return subjectViewers.A.subjectGroup;case"variableStar":return subjectViewers.A.variableStar;default:return null}}}}),{preProcessor:function preProcessor(snapshot){var newSnapshot=Object.assign({},snapshot);if("string"==typeof(null==snapshot?void 0:snapshot.playIterations))if(null!=snapshot&&snapshot.playIterations.length){var newIterations=Number(snapshot.playIterations);newSnapshot.playIterations=newIterations}else newSnapshot.playIterations=1/0;return newSnapshot}});var difference=__webpack_require__("../../node_modules/lodash/difference.js"),difference_default=__webpack_require__.n(difference),isEqual=__webpack_require__("../../node_modules/lodash/isEqual.js"),isEqual_default=__webpack_require__.n(isEqual);function convertWorkflowToUseSteps_slicedToArray(r,e){return function convertWorkflowToUseSteps_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function convertWorkflowToUseSteps_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function convertWorkflowToUseSteps_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return convertWorkflowToUseSteps_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?convertWorkflowToUseSteps_arrayLikeToArray(r,a):void 0}}(r,e)||function convertWorkflowToUseSteps_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function convertWorkflowToUseSteps_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function getNextStepFromTaskKey(taskKey,steps,tasks){var nextStepKey=function getStepKeyFromTaskKey(steps,taskKey){var taskStepKey;return steps.forEach(function(_ref3){var _ref4=convertWorkflowToUseSteps_slicedToArray(_ref3,2),stepKey=_ref4[0];_ref4[1].taskKeys.includes(taskKey)&&(taskStepKey=stepKey)}),taskStepKey}(steps,taskKey);if(!nextStepKey){var comboTask=tasks[taskKey];steps.forEach(function(_ref){var _ref2=convertWorkflowToUseSteps_slicedToArray(_ref,2),step=(_ref2[0],_ref2[1]);isEqual_default()(step.taskKeys,comboTask.tasks)&&(nextStepKey=step.stepKey)})}return nextStepKey}function isThereBranching(task){var _task$answers;return null==task||null===(_task$answers=task.answers)||void 0===_task$answers?void 0:_task$answers.some(function(answer,index){return task.answers.length>index+1&&answer.next!==task.answers[index+1].next})}function taskExists(taskKey,tasks){return Object.keys(tasks).includes(taskKey)}function createStepsFromTasks(first_task,tasks){var steps=[],taskKeys=Object.keys(tasks),taskKeysIncludedInComboTasks=function getTaskKeysIncludedInComboTasks(tasks){return Object.values(tasks).filter(function(task){return"combo"===(null==task?void 0:task.type)}).map(function(combo){return combo.tasks}).flat()}(tasks),taskKeysToConvertToSteps=difference_default()(taskKeys,taskKeysIncludedInComboTasks),firstTask=tasks[first_task];if(first_task){var _firstTask$answers$,firstStep={next:firstTask.next,stepKey:"S0",taskKeys:[first_task]};if("combo"===firstTask.type&&(firstStep.taskKeys=firstTask.tasks),"single"===firstTask.type&&!isThereBranching(firstTask))firstStep.next=null===(_firstTask$answers$=firstTask.answers[0])||void 0===_firstTask$answers$?void 0:_firstTask$answers$.next;taskKeysToConvertToSteps.splice(taskKeysToConvertToSteps.indexOf(first_task),1),steps.push([firstStep.stepKey,firstStep])}return taskKeysToConvertToSteps.forEach(function(taskKey,index){var task=tasks[taskKey];if("shortcut"!==task.type){var stepKey="S".concat(index+1),stepTasks=[taskKey];"combo"===task.type&&(stepTasks=task.tasks);var _task$answers$,stepSnapshot={next:task.next,stepKey,taskKeys:stepTasks};if("single"===task.type&&!isThereBranching(task))stepSnapshot.next=task.answers&&(null===(_task$answers$=task.answers[0])||void 0===_task$answers$?void 0:_task$answers$.next);steps.push([stepKey,stepSnapshot])}}),steps}function Workflow_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return Workflow_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(Workflow_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,Workflow_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,Workflow_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),Workflow_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",Workflow_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),Workflow_regeneratorDefine2(u),Workflow_regeneratorDefine2(u,o,"Generator"),Workflow_regeneratorDefine2(u,n,function(){return this}),Workflow_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(Workflow_regenerator=function _regenerator(){return{w:i,m:f}})()}function Workflow_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Workflow_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){Workflow_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},Workflow_regeneratorDefine2(e,r,n,t)}function Workflow_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function Workflow_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Workflow_ownKeys(Object(t),!0).forEach(function(r){Workflow_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Workflow_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Workflow_defineProperty(e,r,t){return(r=function Workflow_toPropertyKey(t){var i=function Workflow_toPrimitive(t,r){if("object"!=Workflow_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=Workflow_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==Workflow_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Workflow_typeof(o){return Workflow_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Workflow_typeof(o)}function Workflow_slicedToArray(r,e){return function Workflow_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function Workflow_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function Workflow_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return Workflow_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Workflow_arrayLikeToArray(r,a):void 0}}(r,e)||function Workflow_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Workflow_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var WorkflowStep=mobx_state_tree_module.gK.refinement("WorkflowStep",mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.union(mobx_state_tree_module.gK.string,mobx_state_tree_module.gK.frozen())),function validateStep(_ref){var _ref2=Workflow_slicedToArray(_ref,2),keyIsString="string"==typeof _ref2[0],stepIsObject="object"===Workflow_typeof(_ref2[1]);return keyIsString&&stepIsObject}),Workflow=mobx_state_tree_module.gK.model("Workflow",{active:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),configuration:WorkflowConfiguration_WorkflowConfiguration,display_name:mobx_state_tree_module.gK.string,first_task:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,""),grouped:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),links:mobx_state_tree_module.gK.frozen({}),prioritized:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.boolean,!1),steps:mobx_state_tree_module.gK.array(WorkflowStep),strings:mobx_state_tree_module.gK.map(mobx_state_tree_module.gK.string),subjectSet:mobx_state_tree_module.gK.safeReference(SubjectSet_SubjectSet),tasks:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen()),version:mobx_state_tree_module.gK.string}).preProcessSnapshot(function convertPanoptesWorkflows(snapshot){(null===(_snapshot$steps=snapshot.steps)||void 0===_snapshot$steps?void 0:_snapshot$steps.length)>0&&Object.keys(snapshot.tasks).length;var _snapshot$steps,newSnapshot=Object.assign({},snapshot),_convertWorkflowToUse=function convertWorkflowToUseSteps(_ref5){var first_task=_ref5.first_task,_ref5$steps=_ref5.steps,steps=void 0===_ref5$steps?[]:_ref5$steps,tasks=_ref5.tasks;return(steps=steps.length>0?steps:createStepsFromTasks(first_task,tasks)).forEach(function(_ref6){var _ref7=convertWorkflowToUseSteps_slicedToArray(_ref6,2),stepKey=_ref7[0],step=_ref7[1];if(!step.next){var taskKey=convertWorkflowToUseSteps_slicedToArray(step.taskKeys,1)[0],task=tasks[taskKey];null!=task&&task.next&&(step.next=task.next)}if(taskExists(step.next,tasks)){var nextStep=getNextStepFromTaskKey(step.next,steps,tasks);step.next=nextStep!==stepKey?nextStep:void 0}}),Object.values(tasks).forEach(function(task){var _task$answers2;"single"===task.type&&(null===(_task$answers2=task.answers)||void 0===_task$answers2||_task$answers2.forEach(function(answer){taskExists(answer.next,tasks)&&(answer.next=getNextStepFromTaskKey(answer.next,steps,tasks))}))}),{steps,tasks}}(newSnapshot),steps=_convertWorkflowToUse.steps,tasks=_convertWorkflowToUse.tasks;return Workflow_objectSpread(Workflow_objectSpread({},newSnapshot),{},{steps,tasks})}).volatile(function(self){return{SGVModalState:(0,mobx_esm.sH)({showModal:!1,lastSubject:null})}}).views(function(self){return{get caesarReducer(){return self.usesTranscriptionTask?"alice":self.configuration.enable_caesar_data_fetching&&self.usesMachineLearnt?"machineLearnt":""},get hasIndexedSubjects(){var activeSet=(0,mobx_state_tree_module.$Q)(function(){return self.subjectSet});return self.grouped&&!(null==activeSet||!activeSet.isIndexed)},get layout(){return self.usesTranscriptionTask?"noMaxWidth":self.configuration.limit_subject_height?"centered":"geoMap"===self.configuration.subject_viewer?"geoMap":"default"},get subjectSetId(){var activeSet=(0,mobx_state_tree_module.$Q)(function(){return self.subjectSet});return null==activeSet?void 0:activeSet.id},get hasSurveyTask(){return self.tasks&&Object.values(self.tasks).some(function(task){return"survey"===task.type})},get usesTranscriptionTask(){return self.tasks&&Object.values(self.tasks).some(function(task){return"transcription"===task.type})},get usesMachineLearnt(){var toolTypes=["circle","ellipse","freehandLine","line","point","polygon","rectangle","rotateRectangle"];return self.tasks&&Object.values(self.tasks).filter(function(task){return!!task.tools}).some(function(task){return task.tools.some(function(tool){return toolTypes.includes(tool.type)})})}}}).actions(function(self){var _marked=Workflow_regenerator().m(selectSubjectSet);function selectSubjectSet(id){var _getRoot,subjectSets,subjectSet;return Workflow_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:if(!((self.links.subject_sets||[]).indexOf(id)>-1)){_context.n=2;break}return _getRoot=(0,mobx_state_tree_module.Zn)(self),subjectSets=_getRoot.subjectSets,_context.n=1,subjectSets.getResource(id);case 1:return subjectSet=_context.v,self.subjectSet=subjectSet.id,_context.a(2,subjectSet);case 2:throw new Error("No subject set ".concat(id," for workflow ").concat(self.id));case 3:return _context.a(2)}},_marked)}return{selectSubjectSet:(0,mobx_state_tree_module.L3)(selectSubjectSet),setSGVModalState:function setSGVModalState(showModal){var subjectData=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;self.SGVModalState={showModal,lastSubject:subjectData}}}});const Workflow_Workflow=mobx_state_tree_module.gK.compose("WorkflowResource",Resource.A,Workflow);function WorkflowStore_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return WorkflowStore_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(WorkflowStore_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,WorkflowStore_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,WorkflowStore_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),WorkflowStore_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",WorkflowStore_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),WorkflowStore_regeneratorDefine2(u),WorkflowStore_regeneratorDefine2(u,o,"Generator"),WorkflowStore_regeneratorDefine2(u,n,function(){return this}),WorkflowStore_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(WorkflowStore_regenerator=function _regenerator(){return{w:i,m:f}})()}function WorkflowStore_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}WorkflowStore_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){WorkflowStore_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},WorkflowStore_regeneratorDefine2(e,r,n,t)}var WorkflowStore=mobx_state_tree_module.gK.model("WorkflowStore",{active:mobx_state_tree_module.gK.safeReference(Workflow_Workflow),resources:mobx_state_tree_module.gK.map(Workflow_Workflow),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"workflows")}).views(function(self){return{get defaultWorkflowID(){var project=self.project;return(null==project?void 0:project.defaultWorkflow)||""},get project(){var activeProject=(0,mobx_state_tree_module.Zn)(self).projects.active;return(0,mobx_state_tree_module.$Q)(function(){return activeProject})}}}).actions(function(self){return{selectWorkflow:(0,mobx_state_tree_module.L3)(function selectWorkflow(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.defaultWorkflowID,subjectSetID=arguments.length>1?arguments[1]:void 0,subjectID=arguments.length>2?arguments[2]:void 0;return WorkflowStore_regenerator().m(function _callee(_self$project){var availableWorkflows,_getRoot,subjects,activeWorkflow,activeSubjectSet,activeSubject,workflowChanged,subjectSetChanged,subjectChanged,_self$project2,projectID,selectedSubjects,workflow,selectedWorkflow;return WorkflowStore_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:if(id){_context.n=1;break}throw new ReferenceError("No workflow ID available");case 1:if(availableWorkflows=null===(_self$project=self.project)||void 0===_self$project||null===(_self$project=_self$project.links)||void 0===_self$project?void 0:_self$project.workflows,_getRoot=(0,mobx_state_tree_module.Zn)(self),subjects=_getRoot.subjects,activeWorkflow=(0,mobx_state_tree_module.$Q)(function(){return self.active}),activeSubjectSet=null==activeWorkflow?void 0:activeWorkflow.subjectSet,activeSubject=(0,mobx_state_tree_module.$Q)(function(){return subjects.active}),workflowChanged=id!==(null==activeWorkflow?void 0:activeWorkflow.id),subjectSetChanged=!!subjectSetID&&subjectSetID!==(null==activeSubjectSet?void 0:activeSubjectSet.id),subjectChanged=!!subjectID&&subjectID!==(null==activeSubject?void 0:activeSubject.id),!(0===subjects.resources.size||workflowChanged||subjectSetChanged||subjectChanged)){_context.n=6;break}if(projectID=null===(_self$project2=self.project)||void 0===_self$project2?void 0:_self$project2.id,!((null==availableWorkflows?void 0:availableWorkflows.indexOf(id))>-1)){_context.n=5;break}return _context.n=2,self.getResource(id);case 2:if(workflow=_context.v,self.resources.put(workflow),selectedWorkflow=self.resources.get(id),!subjectSetID){_context.n=4;break}return _context.n=3,selectedWorkflow.selectSubjectSet(subjectSetID);case 3:_context.v;case 4:subjectID&&subjectChanged&&(selectedSubjects=[subjectID]),self.setActive(id);try{subjects.reset(),subjects.populateQueue(selectedSubjects)}catch(error){console.log("Unable to reset subject store on URL change."),console.error(error)}_context.n=6;break;case 5:throw new ReferenceError("unable to load workflow ".concat(id," for project ").concat(projectID));case 6:return _context.a(2)}},_callee)})()})}});const WorkflowStore_WorkflowStore=mobx_state_tree_module.gK.compose("WorkflowResourceStore",ResourceStore.A,WorkflowStore);function WorkflowStepStore_typeof(o){return WorkflowStepStore_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},WorkflowStepStore_typeof(o)}function WorkflowStepStore_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function WorkflowStepStore_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?WorkflowStepStore_ownKeys(Object(t),!0).forEach(function(r){WorkflowStepStore_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):WorkflowStepStore_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function WorkflowStepStore_defineProperty(e,r,t){return(r=function WorkflowStepStore_toPropertyKey(t){var i=function WorkflowStepStore_toPrimitive(t,r){if("object"!=WorkflowStepStore_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=WorkflowStepStore_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==WorkflowStepStore_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function WorkflowStepStore_slicedToArray(r,e){return function WorkflowStepStore_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function WorkflowStepStore_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||WorkflowStepStore_unsupportedIterableToArray(r,e)||function WorkflowStepStore_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WorkflowStepStore_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return WorkflowStepStore_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?WorkflowStepStore_arrayLikeToArray(r,a):void 0}}function WorkflowStepStore_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var WorkflowStepStore=mobx_state_tree_module.gK.model("WorkflowStepStore",{active:mobx_state_tree_module.gK.safeReference(Step_Step),steps:mobx_state_tree_module.gK.map(Step_Step)}).views(function(self){return{get activeStepTasks(){return(0,mobx_state_tree_module.aF)(function(){return self.active})?self.active.tasks:[]},get isThereTaskHelp(){return self.activeStepTasks.some(function(task){return task.help})},get shouldWeShowDoneAndTalkButton(){var workflow=(0,mobx_state_tree_module.$Q)(function(){var _getRoot$workflows;return null===(_getRoot$workflows=(0,mobx_state_tree_module.Zn)(self).workflows)||void 0===_getRoot$workflows?void 0:_getRoot$workflows.active}),classification=(0,mobx_state_tree_module.$Q)(function(){var _getRoot$classificati;return null===(_getRoot$classificati=(0,mobx_state_tree_module.Zn)(self).classifications)||void 0===_getRoot$classificati?void 0:_getRoot$classificati.active}),step=(0,mobx_state_tree_module.$Q)(function(){return self.active});if(workflow&&step&&classification){var disableTalk=classification.metadata.subject_flagged;return!step.next&&!disableTalk}return!1},findTasksByType:function findTasksByType(type){return Array.from(self.steps).map(function(_ref){var _ref2=WorkflowStepStore_slicedToArray(_ref,2),step=(_ref2[0],_ref2[1]);return null!=step&&step.tasks&&step.tasks.length>0?step.tasks.filter(function(task){return task.type===type}):[]}).flat()},get interactionTask(){var activeDrawingTask=WorkflowStepStore_slicedToArray(self.activeStepTasks.filter(function(task){return"drawing"===task.type}),1)[0],transcriptionTask=WorkflowStepStore_slicedToArray(self.findTasksByType("transcription"),1)[0];return activeDrawingTask||transcriptionTask||{}},get activeInteractionTask(){return WorkflowStepStore_slicedToArray(self.activeStepTasks.filter(function(task){return"drawing"===task.type||"transcription"===task.type}),1)[0]||{}},get hasActiveAnnotateTask(){var _step,_iterator=function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=WorkflowStepStore_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]}},e:function e(r){throw r},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function s(){t=t.call(r)},n:function n(){var r=t.next();return a=r.done,r},e:function e(r){u=!0,o=r},f:function f(){try{a||null==t.return||t.return()}finally{if(u)throw o}}}}(self.activeStepTasks);try{for(_iterator.s();!(_step=_iterator.n()).done;){var task=_step.value;if("drawing"===task.type||"transcription"===task.type||"dataVisAnnotation"===task.type||"subjectGroupComparison"===task.type)return!0}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1},get hasAnnotateTask(){for(var key in null===(_self$workflow=self.workflow)||void 0===_self$workflow?void 0:_self$workflow.tasks){var _self$workflow,task=self.workflow.tasks[key];if("drawing"===task.type||"transcription"===task.type||"dataVisAnnotation"===task.type||"subjectGroupComparison"===task.type)return!0}return!1},get locale(){return(0,mobx_state_tree_module.Zn)(self).locale},get workflow(){return(0,mobx_state_tree_module.$Q)(function(){var _getRoot$workflows2;return null===(_getRoot$workflows2=(0,mobx_state_tree_module.Zn)(self).workflows)||void 0===_getRoot$workflows2?void 0:_getRoot$workflows2.active})}}}).actions(function(self){function _onWorkflowChange(){var _self$workflow2,_self$workflow3;null!==(_self$workflow2=self.workflow)&&void 0!==_self$workflow2&&_self$workflow2.id&&null!==(_self$workflow3=self.workflow)&&void 0!==_self$workflow3&&_self$workflow3.version&&(self.reset(),self.setStepsAndTasks())}function _onWorkflowStringsChange(){var _self$workflow4;null!==(_self$workflow4=self.workflow)&&void 0!==_self$workflow4&&_self$workflow4.strings&&self.setTaskStrings((0,mobx_state_tree_module.dV)(self.workflow.strings))}function getNextStepKey(){var validStepReference=(0,mobx_state_tree_module.aF)(function(){return self.active}),stepKeys=self.steps.keys(),stepKeysArray=Array.from(stepKeys),firstStep=stepKeysArray[0];if(validStepReference){if(self.active.next)return self.active.next;var currentStepIndex=stepKeysArray.indexOf(self.active.stepKey);return stepKeysArray[currentStepIndex+1]}return firstStep}return{afterAttach:function afterAttach(){(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(_onWorkflowChange)),(0,mobx_state_tree_module.LF)(self,(0,mobx_esm.fm)(_onWorkflowStringsChange))},getNextStepKey,reset:function reset(){self.steps.clear()},resetSteps:function resetSteps(){self.active=void 0,self.steps.forEach(function(step){return step.reset()})},selectStep:function selectStep(){var stepKey=arguments.length>0&&void 0!==arguments[0]?arguments[0]:getNextStepKey();self.steps.get(stepKey)&&(self.active=stepKey,self.activeStepTasks.forEach(function(task){return task.start()}))},setStepsAndTasks:function setStepsAndTasks(){var _self$workflow5=self.workflow,steps=_self$workflow5.steps,strings=_self$workflow5.strings,tasks=_self$workflow5.tasks;self.setSteps(steps),self.setTasks(tasks),self.setTaskStrings((0,mobx_state_tree_module.dV)(strings))},setSteps:function setSteps(steps){steps.forEach(function(workflowStep){var _workflowStep=WorkflowStepStore_slicedToArray(workflowStep,2),stepKey=_workflowStep[0],step=_workflowStep[1];self.steps.put(Object.assign({},step,{stepKey}))})},setTasks:function setTasks(tasks){self.steps.forEach(function(step){step.taskKeys.forEach(function(taskKey){var taskToStore=WorkflowStepStore_objectSpread(WorkflowStepStore_objectSpread({},tasks[taskKey]),{},{taskKey});try{step.tasks.push(taskToStore)}catch(error){console.error("".concat(taskKey," ").concat(taskToStore.type," is not a supported task type")),console.error(error)}})})},setTaskStrings:function setTaskStrings(stringsSnapshot){var workflowStrings=Object.entries(stringsSnapshot);self.steps.forEach(function(step){step.tasks.forEach(function(task){var prefix="tasks.".concat(task.taskKey,"."),taskStrings=workflowStrings.filter(function(_ref3){var _ref4=WorkflowStepStore_slicedToArray(_ref3,2),key=_ref4[0];_ref4[1];return key.startsWith(prefix)}),taskStringsSnapshot={};taskStrings.forEach(function(_ref5){var _ref6=WorkflowStepStore_slicedToArray(_ref5,2),key=_ref6[0],value=_ref6[1],newKey=key.slice(prefix.length);taskStringsSnapshot[newKey]=value});try{(0,mobx_state_tree_module.Nh)(task.strings,taskStringsSnapshot)}catch(error){console.error("".concat(task.taskKey," ").concat(task.type,": could not apply language strings")),console.error(error)}})})}}});const WorkflowStepStore_WorkflowStepStore=WorkflowStepStore;var merge=__webpack_require__("../../node_modules/lodash/merge.js"),merge_default=__webpack_require__.n(merge),Preferences=mobx_state_tree_module.gK.model("Preferences",{minicourses:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen()),selected_workflow:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.string),tutorials_completed_at:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen())}),UserProjectPreferences=mobx_state_tree_module.gK.model("UserProjectPreferences",{activity_count:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.number),activity_count_by_workflow:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen()),links:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen({project:mobx_state_tree_module.gK.string,user:mobx_state_tree_module.gK.string})),preferences:mobx_state_tree_module.gK.maybe(Preferences),settings:mobx_state_tree_module.gK.maybe(mobx_state_tree_module.gK.frozen())});const UserProjectPreferences_UserProjectPreferences=mobx_state_tree_module.gK.compose("UserProjectPreferencesResource",Resource.A,UserProjectPreferences);function UserProjectPreferencesStore_typeof(o){return UserProjectPreferencesStore_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},UserProjectPreferencesStore_typeof(o)}function UserProjectPreferencesStore_defineProperty(e,r,t){return(r=function UserProjectPreferencesStore_toPropertyKey(t){var i=function UserProjectPreferencesStore_toPrimitive(t,r){if("object"!=UserProjectPreferencesStore_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=UserProjectPreferencesStore_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==UserProjectPreferencesStore_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function UserProjectPreferencesStore_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return UserProjectPreferencesStore_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(UserProjectPreferencesStore_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,UserProjectPreferencesStore_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,UserProjectPreferencesStore_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),UserProjectPreferencesStore_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",UserProjectPreferencesStore_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),UserProjectPreferencesStore_regeneratorDefine2(u),UserProjectPreferencesStore_regeneratorDefine2(u,o,"Generator"),UserProjectPreferencesStore_regeneratorDefine2(u,n,function(){return this}),UserProjectPreferencesStore_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(UserProjectPreferencesStore_regenerator=function _regenerator(){return{w:i,m:f}})()}function UserProjectPreferencesStore_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}UserProjectPreferencesStore_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){UserProjectPreferencesStore_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},UserProjectPreferencesStore_regeneratorDefine2(e,r,n,t)}var UserProjectPreferencesStore=mobx_state_tree_module.gK.model("UserProjectPreferencesStore",{active:mobx_state_tree_module.gK.safeReference(UserProjectPreferences_UserProjectPreferences),resources:mobx_state_tree_module.gK.map(UserProjectPreferences_UserProjectPreferences),type:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"project_preferences")}).actions(function(self){var _marked=UserProjectPreferencesStore_regenerator().m(updateUPP),_marked2=UserProjectPreferencesStore_regenerator().m(putUPP);function updateUPP(changes){var upp,uppSnapshot,mergedUPP,currentUPP,_mergedUPP,_t2;return UserProjectPreferencesStore_regenerator().w(function(_context2){for(;;)switch(_context2.p=_context2.n){case 0:if(!(upp=(0,mobx_state_tree_module.$Q)(function(){return self.active}))){_context2.n=7;break}if(uppSnapshot=(0,mobx_state_tree_module.dV)(upp),_context2.p=1,!self.headers.etag){_context2.n=3;break}return mergedUPP=merge_default()({},uppSnapshot,changes),self.setUPP(mergedUPP),_context2.n=2,self.putUPP(mergedUPP);case 2:_context2.n=5;break;case 3:return _context2.n=4,self.fetchUPPById(upp.id);case 4:return currentUPP=_context2.v,_mergedUPP=merge_default()({},currentUPP,changes),self.setUPP(_mergedUPP),_context2.n=5,self.putUPP(_mergedUPP);case 5:_context2.n=7;break;case 6:_context2.p=6,_t2=_context2.v,console.error(_t2),self.loadingState=async_states_default().error;case 7:return _context2.a(2)}},_marked,null,[[1,6]])}function putUPP(upp){var type,client,_getRoot2,authClient,authorization,headers,id,preferences,response,updatedUPP,_t3;return UserProjectPreferencesStore_regenerator().w(function(_context3){for(;;)switch(_context3.p=_context3.n){case 0:return type=self.type,client=(0,mobx_state_tree_module.Zn)(self).client.panoptes,_getRoot2=(0,mobx_state_tree_module.Zn)(self),authClient=_getRoot2.authClient,_context3.n=1,(0,utils.Rb)(authClient);case 1:if(authorization=_context3.v,!upp||!self.headers.etag){_context3.n=5;break}return headers={authorization,etag:self.headers.etag},id=upp.id,preferences=upp.preferences,_context3.p=2,self.loadingState=async_states_default().putting,_context3.n=3,client.put("/".concat(type,"/").concat(id),UserProjectPreferencesStore_defineProperty({},type,{preferences}),headers);case 3:(response=_context3.v).body[type][0]&&(self.headers=response.headers,updatedUPP=response.body[type][0],self.setUPP(updatedUPP)),self.loadingState=async_states_default().success,_context3.n=5;break;case 4:_context3.p=4,_t3=_context3.v,console.error(_t3),self.loadingState=async_states_default().error;case 5:return _context3.a(2)}},_marked2,null,[[2,4]])}return{clear:function clear(){self.resources.clear(),self.loadingState=async_states_default().success},fetchUPPById:(0,mobx_state_tree_module.L3)(function fetchUPPById(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return UserProjectPreferencesStore_regenerator().m(function _callee(){var type,uppId,client,_getRoot,authClient,authorization,headers,response,resource,_t;return UserProjectPreferencesStore_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:return type=self.type,uppId=id||self.active.id,client=(0,mobx_state_tree_module.Zn)(self).client.panoptes,_getRoot=(0,mobx_state_tree_module.Zn)(self),authClient=_getRoot.authClient,_context.n=1,(0,utils.Rb)(authClient);case 1:return authorization=_context.v,headers={authorization},_context.p=2,_context.n=3,client.get("/".concat(type,"/").concat(uppId),null,headers);case 3:if(response=_context.v,!(resource=response.body[type][0])){_context.n=4;break}return self.setHeaders(response.headers),self.setUPP(resource),_context.a(2,resource);case 4:_context.n=6;break;case 5:return _context.p=5,_t=_context.v,console.error(_t),self.loadingState=async_states_default().error,_context.a(2,null);case 6:return _context.a(2,null)}},_callee,null,[[2,5]])})()}),putUPP:(0,mobx_state_tree_module.L3)(putUPP),setHeaders:function setHeaders(headers){self.headers=headers},setUPP:function setUPP(userProjectPreferences){self.setResources([userProjectPreferences]),self.setActive(userProjectPreferences.id),self.loadingState=async_states_default().success},updateUPP:(0,mobx_state_tree_module.L3)(updateUPP)}});const UserProjectPreferencesStore_UserProjectPreferencesStore=mobx_state_tree_module.gK.compose("UserProjectPreferencesResourceStore",ResourceStore.A,UserProjectPreferencesStore);function RootStore_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return RootStore_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(RootStore_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,RootStore_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,RootStore_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),RootStore_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",RootStore_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),RootStore_regeneratorDefine2(u),RootStore_regeneratorDefine2(u,o,"Generator"),RootStore_regeneratorDefine2(u,n,function(){return this}),RootStore_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(RootStore_regenerator=function _regenerator(){return{w:i,m:f}})()}function RootStore_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}RootStore_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){RootStore_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},RootStore_regeneratorDefine2(e,r,n,t)}function RootStore_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}(0,mobx_esm.jK)({isolateGlobalState:!0});var RootStore_RootStore=mobx_state_tree_module.gK.model("RootStore",{classifications:mobx_state_tree_module.gK.optional(store_ClassificationStore,function(){return store_ClassificationStore.create({})}),feedback:mobx_state_tree_module.gK.optional(store_FeedbackStore,function(){return store_FeedbackStore.create({})}),fieldGuide:mobx_state_tree_module.gK.optional(FieldGuideStore.A,function(){return FieldGuideStore.A.create({})}),locale:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.string,"en"),projects:mobx_state_tree_module.gK.optional(store_ProjectStore,function(){return store_ProjectStore.create({})}),subjects:mobx_state_tree_module.gK.optional(SubjectStore_SubjectStore,function(){return SubjectStore_SubjectStore.create({})}),subjectSets:mobx_state_tree_module.gK.optional(SubjectSetStore_SubjectSetStore,function(){return SubjectSetStore_SubjectSetStore.create({})}),subjectViewer:mobx_state_tree_module.gK.optional(SubjectViewerStore,function(){return SubjectViewerStore.create({})}),tutorials:mobx_state_tree_module.gK.optional(TutorialStore_TutorialStore,function(){return TutorialStore_TutorialStore.create({})}),workflows:mobx_state_tree_module.gK.optional(WorkflowStore_WorkflowStore,function(){return WorkflowStore_WorkflowStore.create({})}),workflowSteps:mobx_state_tree_module.gK.optional(WorkflowStepStore_WorkflowStepStore,function(){return WorkflowStepStore_WorkflowStepStore.create({})}),userProjectPreferences:mobx_state_tree_module.gK.optional(UserProjectPreferencesStore_UserProjectPreferencesStore,function(){return UserProjectPreferencesStore_UserProjectPreferencesStore.create({})})}).volatile(function(self){return{onAddToCollection:function onAddToCollection(){return!0},onSubjectChange:function onSubjectChange(){return!0},onToggleFavourite:function onToggleFavourite(){return!0}}}).actions(function(self){function _addMiddleware(call,next,abort){if("setActiveSubject"===call.name){var res=next(call);return self.startClassification(),res}return next(call)}function _onAction(call){"completeClassification"===call.name&&self.classifications.currentAnnotations.forEach(function(annotation){return self.feedback.update(annotation)})}function _onPatch(patch){var path=patch.path,value=patch.value;"/classifications/loadingState"===path&&"posting"===value&&self.subjects.advance()}function _onUserChange(){return _onUserChange2.apply(this,arguments)}function _onUserChange2(){return _onUserChange2=function RootStore_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){RootStore_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){RootStore_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(RootStore_regenerator().m(function _callee(){var _self$authClient2;return RootStore_regenerator().w(function(_context){for(;;)switch(_context.n){case 0:return _context.n=1,null===(_self$authClient2=self.authClient)||void 0===_self$authClient2?void 0:_self$authClient2.checkCurrent();case 1:window.sessionStorage.removeItem("subjectsSeenThisSession"),self.subjects.reset();case 2:return _context.a(2)}},_callee)})),_onUserChange2.apply(this,arguments)}return{afterCreate:function afterCreate(){var _self$authClient;(0,mobx_state_tree_module.I7)(self,_addMiddleware),(0,mobx_state_tree_module.i5)(self,_onAction),(0,mobx_state_tree_module.k4)(self,_onPatch),null===(_self$authClient=self.authClient)||void 0===_self$authClient||_self$authClient.listen("change",_onUserChange)},setLocale:function setLocale(newLocale){self.locale=newLocale},setOnAddToCollection:function setOnAddToCollection(callback){self.onAddToCollection=callback},setOnSubjectChange:function setOnSubjectChange(callback){self.onSubjectChange=callback},setOnToggleFavourite:function setOnToggleFavourite(callback){self.onToggleFavourite=callback},startClassification:function startClassification(){var classifications=self.classifications,feedback=self.feedback,projects=self.projects,subjects=self.subjects,workflows=self.workflows,workflowSteps=self.workflowSteps,subject=(0,mobx_state_tree_module.$Q)(function(){return null==subjects?void 0:subjects.active}),workflow=(0,mobx_state_tree_module.$Q)(function(){return null==workflows?void 0:workflows.active}),project=(0,mobx_state_tree_module.$Q)(function(){return null==projects?void 0:projects.active});subject&&workflow&&project&&(workflowSteps.resetSteps(),classifications.reset(),classifications.createClassification(subject,workflow,project),feedback.onNewSubject(),self.onSubjectChange((0,mobx_state_tree_module.dV)(subject)))}}}).views(function(self){return{get authClient(){return(0,mobx_state_tree_module._$)(self).authClient},get client(){return(0,mobx_state_tree_module._$)(self).client}}});const store_RootStore=RootStore_RootStore},"./src/store/subjects/Subject/TranscriptionReductions/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>TranscriptionReductions_TranscriptionReductions});var async_states=__webpack_require__("../lib-async-states/src/async-states.js"),async_states_default=__webpack_require__.n(async_states),mobx_state_tree_module=__webpack_require__("../../node_modules/mobx-state-tree/dist/mobx-state-tree.module.js"),cuid=__webpack_require__("../../node_modules/cuid/index.js"),cuid_default=__webpack_require__.n(cuid);function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||_unsupportedIterableToArray(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||_unsupportedIterableToArray(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}const TranscriptionReductions_TranscriptionReductions=mobx_state_tree_module.gK.model("TranscriptionReductions",{reducer:mobx_state_tree_module.gK.literal("alice"),error:mobx_state_tree_module.gK.maybeNull(mobx_state_tree_module.gK.frozen({})),loadingState:mobx_state_tree_module.gK.optional(mobx_state_tree_module.gK.enumeration("state",async_states_default().values),async_states_default().initialized),reductions:mobx_state_tree_module.gK.array(mobx_state_tree_module.gK.frozen({})),subjectId:mobx_state_tree_module.gK.string,workflowId:mobx_state_tree_module.gK.string}).views(function(self){function reductionConsensus(reduction,frame){var parameters=reduction.data.parameters,currentFrameReductions=reduction.data["frame".concat(frame)]||[],options={frame,minimumViews:(null==parameters?void 0:parameters.minimum_views)||5,threshold:(null==parameters?void 0:parameters.low_consensus_threshold)||3};return currentFrameReductions.map(function(line){return function frameConsensus(line,options){return line.id||(line.id=cuid_default()()),function constructLine(reduction,options){var frame=options.frame,minimumViews=options.minimumViews,threshold=options.threshold,consensusText=reduction.consensus_text,points=function constructCoordinates(line){return line&&line.clusters_x&&line.clusters_y?line.clusters_x.map(function(point,i){return{x:line.clusters_x[i],y:line.clusters_y[i]}}):[]}(reduction),textOptions=function constructText(line){var sentences=[];return line&&line.clusters_text&&line.clusters_text.forEach(function(value){value.forEach(function(word,i){sentences[i]||(sentences[i]=[]),word&&word.length&&sentences[i].push(word)})}),sentences.map(function(value){return value.join(" ")})}(reduction);return{consensusReached:reduction.consensus_score>=threshold||reduction.number_views>=minimumViews,consensusText,frame,id:reduction.id,points,textOptions}}(line,options)}(line,options)})}function reductionUsers(reduction){var users=function reductionFrames(reduction){return Object.entries(reduction.data).filter(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0];return _ref2[1],key.startsWith("frame")})}(reduction).map(function(_ref3){var _ref4=_slicedToArray(_ref3,2);_ref4[0];return function frameUsers(frame){var users=frame.map(function(line){return line.user_ids});return _toConsumableArray(new Set(users.flat()))}(_ref4[1])});return _toConsumableArray(new Set(users.flat()))}return{consensusLines:function consensusLines(frame){return self.reductions.map(function(reduction){return reductionConsensus(reduction,frame)}).flat()},get userIDs(){var users=self.reductions.map(reductionUsers);return _toConsumableArray(new Set(users.flat()))}}}).actions(function(self){return{}})},"./src/store/utils/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{qg:()=>utils_ClassificationQueue,Rb:()=>getBearerToken,im:()=>session});var currentScopes=__webpack_require__("./node_modules/@sentry/core/build/esm/currentScopes.js"),esm_exports=__webpack_require__("./node_modules/@sentry/core/build/esm/exports.js"),src=__webpack_require__("../lib-panoptes-js/src/index.js"),_excluded=["id"];function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}var DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0},ClassificationQueue=function(){return function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(function ClassificationQueue(){var api=arguments.length>0&&void 0!==arguments[0]?arguments[0]:src.bB,onClassificationSaved=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DEFAULT_HANDLER,authClient=arguments.length>2?arguments[2]:void 0;!function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,ClassificationQueue),this.storage=window.localStorage,this.apiClient=api,this.authClient=authClient,this.onClassificationSaved=onClassificationSaved,this.recents=[],this.sending=[],this.flushTimeout=null,this.endpoint="/classifications",this.flushToBackend=this.flushToBackend.bind(this),this.flushToBackend()},[{key:"add",value:function add(classification){return this.store(classification),this.flushToBackend()}},{key:"store",value:function store(classification){var queue=this._loadQueue();queue.push(classification);try{this._saveQueue(queue),console.info("Queued classifications:",queue.length)}catch(error){console.error("Failed to queue classification:",error.message),currentScopes.v4(function(scope){scope.setTag("classificationQueue","storeFailed"),scope.setExtra("classification",JSON.stringify(classification)),esm_exports.Cp(error)})}}},{key:"remove",value:function remove(classification){var queue=this._loadQueue();try{var newQueue=queue.filter(function(c){return c.id!==classification.id});this._saveQueue(newQueue)}catch(error){console.error(error.message),currentScopes.v4(function(scope){scope.setTag("classificationQueue","removeFailed"),scope.setExtra("classification",JSON.stringify(classification)),esm_exports.Cp(error)})}}},{key:"length",value:function length(){return this._loadQueue().length}},{key:"addRecent",value:function addRecent(classification){this.recents.length>10&&this.recents.pop().destroy();this.recents.unshift(classification)}},{key:"flushToBackend",value:(_flushToBackend=_asyncToGenerator(_regenerator().m(function _callee(){var pendingClassifications,authorization,saveClassification,awaitSaveClassifications,_this=this;return _regenerator().w(function(_context){for(;;)switch(_context.n){case 0:return pendingClassifications=this._loadQueue(),this.flushTimeout&&(clearTimeout(this.flushTimeout),this.flushTimeout=null),console.log("Saving queued classifications:",pendingClassifications.length),_context.n=1,getBearerToken(this.authClient);case 1:return authorization=_context.v,saveClassification=function saveClassification(classificationData){return _this._saveClassification(classificationData,authorization)},awaitSaveClassifications=pendingClassifications.filter(function(c){return!_this.sending.includes(c.id)}).map(saveClassification),_context.a(2,Promise.all(awaitSaveClassifications))}},_callee,this)})),function flushToBackend(){return _flushToBackend.apply(this,arguments)})},{key:"_saveClassification",value:(_saveClassification2=_asyncToGenerator(_regenerator().m(function _callee2(classificationData,authorization){var id,classificationToSave,tokenError,token,_yield$auth$verify,error,response,_response$body$classi,savedClassification,_t;return _regenerator().w(function(_context2){for(;;)switch(_context2.p=_context2.n){case 0:if(_context2.p=0,id=classificationData.id,classificationToSave=_objectWithoutProperties(classificationData,_excluded),this.sending.push(id),!authorization){_context2.n=2;break}return token=authorization.replace("Bearer ",""),_context2.n=1,src.j2.verify(token);case 1:(_yield$auth$verify=_context2.v).data,error=_yield$auth$verify.error,tokenError=error;case 2:return _context2.n=3,this.apiClient.post(this.endpoint,{classifications:classificationToSave},{authorization});case 3:return(response=_context2.v).ok&&(this.remove(classificationData),_response$body$classi=_slicedToArray(response.body.classifications,1),savedClassification=_response$body$classi[0],console.log("Saved classification",savedClassification.id),this.onClassificationSaved(savedClassification),this.addRecent(savedClassification),tokenError&&(console.error(tokenError),currentScopes.v4(function(scope){scope.setTag("classificationError","tokenError"),scope.setExtra("classification",JSON.stringify(savedClassification)),esm_exports.Cp(tokenError)}))),this.sending=this.sending.filter(function(id){return id!==classificationData.id}),_context2.a(2,response);case 4:if(_context2.p=4,_t=_context2.v,console.error("Failed to save a queued classification:",_t.message),this.sending=this.sending.filter(function(id){return id!==classificationData.id}),422!==_t.status)try{this.flushTimeout||(this.flushTimeout=setTimeout(this.flushToBackend,3e5))}catch(saveQueueError){console.error("Failed to update classification queue:",saveQueueError)}else console.error("Dropping malformed classification permanently",classificationData),this.remove(classificationData);return currentScopes.v4(function(scope){var errorTag=_t.status||"saveFailed";scope.setTag("classificationError",errorTag),scope.setExtra("classification",JSON.stringify(classificationData)),esm_exports.Cp(_t)}),_context2.a(2,_t)}},_callee2,this,[[0,4]])})),function _saveClassification(_x,_x2){return _saveClassification2.apply(this,arguments)})},{key:"_loadQueue",value:function _loadQueue(){var queue=JSON.parse(this.storage.getItem("failed-classifications"));return null==queue&&(queue=[]),queue}},{key:"_saveQueue",value:function _saveQueue(queue){this.storage.setItem("failed-classifications",JSON.stringify(queue))}}]);var _saveClassification2,_flushToBackend}();const utils_ClassificationQueue=ClassificationQueue;var _window,hash=__webpack_require__("../../node_modules/hash.js/lib/hash.js"),hash_default=__webpack_require__.n(hash),storage=null===(_window=window)||void 0===_window?void 0:_window.sessionStorage;const session={generateSessionID:function generateSessionID(){var stored={id:hash_default().sha256().update("".concat(1e4*Math.random()).concat(Date.now()).concat(1e3*Math.random())).digest("hex")};try{null==storage||storage.setItem("session_id",JSON.stringify(stored))}catch(e){console.error(e)}return stored},getSessionID:function getSessionID(){return(null!=storage&&storage.getItem("session_id")?JSON.parse(null==storage?void 0:storage.getItem("session_id")):this.generateSessionID()).id}};function getBearerToken_regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return getBearerToken_regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(getBearerToken_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,getBearerToken_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,getBearerToken_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),getBearerToken_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",getBearerToken_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),getBearerToken_regeneratorDefine2(u),getBearerToken_regeneratorDefine2(u,o,"Generator"),getBearerToken_regeneratorDefine2(u,n,function(){return this}),getBearerToken_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(getBearerToken_regenerator=function _regenerator(){return{w:i,m:f}})()}function getBearerToken_regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}getBearerToken_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){getBearerToken_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},getBearerToken_regeneratorDefine2(e,r,n,t)}function getBearerToken_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function getBearerToken(_x){return _getBearerToken.apply(this,arguments)}function _getBearerToken(){return _getBearerToken=function getBearerToken_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){getBearerToken_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){getBearerToken_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}(getBearerToken_regenerator().m(function _callee(authClient){var token,authToken,_t;return getBearerToken_regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(token="",!authClient){_context.n=5;break}return _context.p=1,_context.n=2,authClient.checkBearerToken();case 2:if("string"==typeof(authToken=_context.v)&&authToken&&(token=authToken),authToken&&authToken.access_token&&(token=authToken.access_token),!token){_context.n=3;break}return _context.a(2,"Bearer ".concat(token));case 3:return _context.a(2,token);case 4:_context.p=4,_t=_context.v,console.error("Cannot check bearer token:",_t);case 5:return _context.a(2,token)}},_callee,null,[[1,4]])})),_getBearerToken.apply(this,arguments)}},"?c95a"(){}}]);