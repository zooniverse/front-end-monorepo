"use strict";(self.webpackChunk_zooniverse_classifier=self.webpackChunk_zooniverse_classifier||[]).push([[1429],{"../../node_modules/grommet-icons/es6/icons/Chat.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{r:()=>Chat});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_StyledIcon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet-icons/es6/StyledIcon.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var Chat=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(function(props,ref){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_StyledIcon__WEBPACK_IMPORTED_MODULE_1__.v,_extends({ref,viewBox:"0 0 24 24",a11yTitle:"Chat"},props),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{fill:"none",stroke:"#000",strokeWidth:"2",d:"M19 1H5a4 4 0 0 0-4 4v8a4 4 0 0 0 4 4h12l6 5V5a4 4 0 0 0-4-4zm0 6H6m13 4h-9"}))});Chat.displayName="Chat"},"../../node_modules/grommet-icons/es6/icons/FormNextLink.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{s:()=>FormNextLink});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_StyledIcon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/grommet-icons/es6/StyledIcon.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var FormNextLink=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(function(props,ref){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_StyledIcon__WEBPACK_IMPORTED_MODULE_1__.v,_extends({ref,viewBox:"0 0 24 24",a11yTitle:"FormNextLink"},props),react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{fill:"none",stroke:"#000",strokeWidth:"2",d:"M6 12.4h12M12.6 7l5.4 5.4-5.4 5.4"}))});FormNextLink.displayName="FormNextLink"},"../../node_modules/grommet/es6/components/Form/Form.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{l:()=>Form});var react=__webpack_require__("../../node_modules/react/index.js"),AnalyticsContext=__webpack_require__("../../node_modules/grommet/es6/contexts/AnalyticsContext/AnalyticsContext.js"),MessageContext=__webpack_require__("../../node_modules/grommet/es6/contexts/MessageContext/MessageContext.js"),refs=__webpack_require__("../../node_modules/grommet/es6/utils/refs.js"),FormContext=__webpack_require__("../../node_modules/grommet/es6/components/Form/FormContext.js");var FormPropTypes={},_excluded=["children","errors","infos","messages","kind","onChange","onReset","onSubmit","onValidate","validate","value"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var defaultValue={},defaultTouched={},defaultValidationResults={errors:{},infos:{}},stringToArray=function stringToArray(string){var match=null==string?void 0:string.match(/^(.+)\[([0-9]+)\]\.(.*)$/);if(match){var arrayName=match[1];return{indexOfArray:match[2],arrayName,arrayObjName:match[3]}}},_getValueAt=function getValueAt(valueObject,pathArg){if(void 0!==valueObject){var path=Array.isArray(pathArg)?pathArg:pathArg.split(".");return 1===path.length?valueObject[path]:_getValueAt(valueObject[path.shift()],path)}},_setValueAt=function setValueAt(valueObject,pathArg,value){var object=valueObject,path=Array.isArray(pathArg)?pathArg:pathArg.split(".");if(1===path.length)object[path]=value;else{var key=path.shift();object[key]||(object[key]={}),_setValueAt(object[key],path,value)}},getFieldValue=function getFieldValue(name,value){var isArrayField=stringToArray(name);if(isArrayField){var _value$arrayName,indexOfArray=isArrayField.indexOfArray,arrayName=isArrayField.arrayName,arrayObjName=isArrayField.arrayObjName,obj=null==(_value$arrayName=value[arrayName])?void 0:_value$arrayName[indexOfArray];return arrayObjName?null==obj?void 0:obj[arrayObjName]:obj}return _getValueAt(value,name)},setFieldValue=function setFieldValue(name,componentValue,prevValue){var nextValue=_extends({},prevValue),isArrayField=stringToArray(name);if(isArrayField){var _nextValue$arrayName$,indexOfArray=isArrayField.indexOfArray,arrayName=isArrayField.arrayName,arrayObjName=isArrayField.arrayObjName;if(nextValue[arrayName]||(nextValue[arrayName]=[]),arrayObjName)nextValue[arrayName][indexOfArray]||(nextValue[arrayName][indexOfArray]=((_nextValue$arrayName$={})[arrayObjName]=componentValue,_nextValue$arrayName$)),nextValue[arrayName][indexOfArray][arrayObjName]=componentValue;else nextValue[arrayName][indexOfArray]=componentValue}else _setValueAt(nextValue,name,componentValue);return nextValue},validate=function validate(rule,fieldValue,formValue,format,messages){var result;return"function"==typeof rule?result=rule(fieldValue,formValue):rule.regexp?rule.regexp.test(fieldValue)||(result=rule.message||format({id:"form.invalid",messages}),rule.status&&(result={message:result,status:rule.status})):rule.max&&(result=function validateCharacterCount(format,rule,value){var max=rule.max,threshold=rule.threshold;return value.length/max>(null!=threshold?threshold:.5)?{status:max-value.length>=0?"info":"error",message:function getMessage(){return max-value.length>=0?format(function charactersRemaining(plural){return{id:"formField.maxCharacters.remaining."+(plural?"plural":"singular"),values:{number:max-value.length}}}(max-value.length>1)):format(function charactersOverLimit(plural){return{id:"formField.maxCharacters.overLimit."+(plural?"plural":"singular"),values:{number:value.length-max}}}(value.length-max>1))}()}:void 0}(format,rule,fieldValue)),result},validateName=function validateName(validationRules,required){return function(name,formValue,format,messages){var validationResult,fieldValue=getFieldValue(name,formValue);return required&&(void 0===fieldValue||""===fieldValue||!1===fieldValue||Array.isArray(fieldValue)&&!fieldValue.length)?validationResult=format({id:"form.required",messages}):validationRules&&(Array.isArray(validationRules)?validationRules.some(function(rule){return!!(validationResult=validate(rule,fieldValue,formValue,format,messages))}):validationResult=validate(validationRules,fieldValue,formValue,format,messages)),validationResult}},validateForm=function validateForm(validationRules,formValue,format,messages,omitValid){var nextErrors={},nextInfos={};return validationRules.forEach(function(_ref){var result,name=_ref[0],_ref$=_ref[1],field=_ref$.field,input=_ref$.input,validateOn=_ref$.validateOn;(omitValid||(nextErrors[name]=void 0,nextInfos[name]=void 0),validateOn)&&(input&&(result=input(name,formValue,format,messages)),field&&!result&&(result=field(name,formValue,format,messages)),"object"==typeof result?"info"===result.status?nextInfos[name]=result.message:nextErrors[name]=result.message||result:"string"==typeof result&&(nextErrors[name]=result))}),[nextErrors,nextInfos]},isInstantValidate=function isInstantValidate(validateOn){return["blur","change"].includes(validateOn)},Form=(0,react.forwardRef)(function(_ref2,ref){var children=_ref2.children,_ref2$errors=_ref2.errors,errorsProp=void 0===_ref2$errors?defaultValidationResults.errors:_ref2$errors,_ref2$infos=_ref2.infos,infosProp=void 0===_ref2$infos?defaultValidationResults.infos:_ref2$infos,messages=_ref2.messages,kind=_ref2.kind,onChange=_ref2.onChange,_onReset=_ref2.onReset,_onSubmit=_ref2.onSubmit,onValidate=_ref2.onValidate,_ref2$validate=_ref2.validate,validateOnProp=void 0===_ref2$validate?"submit":_ref2$validate,valueProp=_ref2.value,rest=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(_ref2,_excluded),formRef=(0,refs.N)(ref),format=(0,react.useContext)(MessageContext.N).format,_useState=(0,react.useState)(valueProp||defaultValue),valueState=_useState[0],setValueState=_useState[1],value=(0,react.useMemo)(function(){return valueProp||valueState},[valueProp,valueState]),_useState2=(0,react.useState)(defaultTouched),touched=_useState2[0],setTouched=_useState2[1],_useState3=(0,react.useState)(validateOnProp),validateOn=_useState3[0],setValidateOn=_useState3[1],_useState4=(0,react.useState)({errors:errorsProp,infos:infosProp}),validationResults=_useState4[0],setValidationResults=_useState4[1],validationResultsRef=(0,react.useRef)({}),_useState5=(0,react.useState)("unmounted"),mounted=_useState5[0],setMounted=_useState5[1];(0,react.useEffect)(function(){mounted?"mounting"===mounted&&setMounted("mounted"):setMounted("mounting")},[mounted]);var _useState6=(0,react.useState)(void 0),pendingValidation=_useState6[0],setPendingValidation=_useState6[1],validationRulesRef=(0,react.useRef)({}),requiredFields=(0,react.useRef)([]),analyticsRef=(0,react.useRef)({start:new Date,errors:{}}),sendAnalytics=(0,AnalyticsContext.st)(),buildValid=(0,react.useCallback)(function(nextErrors){var valid=!1;return valid=requiredFields.current.filter(function(n){return Object.keys(validationRulesRef.current).includes(n)}).every(function(field){return value[field]&&(""!==value[field]||!1!==value[field])}),Object.keys(nextErrors).length>0&&(valid=!1),valid},[value]),filterRemovedFields=function filterRemovedFields(prevValidations){var nextValidations=prevValidations;return Object.keys(nextValidations).filter(function(n){return!validationRulesRef.current[n]||void 0===nextValidations[n]}).forEach(function(n){return delete nextValidations[n]})},updateAnalytics=function updateAnalytics(){var _validationResultsRef,errorFields=Object.keys(null==(_validationResultsRef=validationResultsRef.current)?void 0:_validationResultsRef.errors),errorCounts=analyticsRef.current.errors;errorFields.length>0&&errorFields.forEach(function(key){errorCounts[key]=(errorCounts[key]||0)+1})},applyValidationRules=(0,react.useCallback)(function(validationRules){var _validateForm=validateForm(validationRules,value,format,messages),validatedErrors=_validateForm[0],validatedInfos=_validateForm[1];setValidationResults(function(prevValidationResults){var nextErrors=_extends({},prevValidationResults.errors,validatedErrors),nextInfos=_extends({},prevValidationResults.infos,validatedInfos);filterRemovedFields(nextErrors),filterRemovedFields(nextInfos);var nextValidationResults={errors:nextErrors,infos:nextInfos};return onValidate&&onValidate(_extends({},nextValidationResults,{valid:buildValid(nextErrors)})),validationResultsRef.current=nextValidationResults,updateAnalytics(),nextValidationResults})},[buildValid,format,messages,onValidate,value]);(0,react.useEffect)(function(){var validationRules=Object.entries(validationRulesRef.current);"mounted"!==mounted&&(isInstantValidate(validateOn)||validationRules.some(function(_ref3){var v=_ref3[1];return isInstantValidate(v.validateOn)}))&&Object.keys(value).length>0&&0===Object.keys(touched).length&&applyValidationRules(validationRules.filter(function(_ref4){var n=_ref4[0],v=_ref4[1];return getFieldValue(n,value)&&v.validateOn}).filter(function(_ref5){var n=_ref5[0];return!(Array.isArray(getFieldValue(n,value))&&0===getFieldValue(n,value).length)}))},[applyValidationRules,mounted,touched,validateOn,value]),(0,react.useEffect)(function(){var validationRules=Object.entries(validationRulesRef.current),timer=setTimeout(function(){pendingValidation&&(isInstantValidate(validateOn)||validationRules.some(function(_ref6){var v=_ref6[1];return isInstantValidate(v.validateOn)}))&&(applyValidationRules(validationRules.filter(function(_ref7){var n=_ref7[0],v=_ref7[1];return(touched[n]||pendingValidation.includes(n))&&v.validateOn})),setPendingValidation(void 0))},120);return function(){return clearTimeout(timer)}},[applyValidationRules,pendingValidation,touched,validateOn]),(0,react.useEffect)(function(){var _validationResultsRef2,validationRules=Object.entries(validationRulesRef.current);null!=(_validationResultsRef2=validationResultsRef.current)&&_validationResultsRef2.errors&&Object.keys(validationResultsRef.current.errors).length>0&&applyValidationRules(validationRules.filter(function(_ref8){var n=_ref8[0];return touched[n]&&validationResultsRef.current.errors[n]}))},[applyValidationRules,touched]),(0,react.useEffect)(function(){var element=formRef.current;return analyticsRef.current={start:new Date,errors:{}},sendAnalytics({type:"formOpen",element}),function(){analyticsRef.current.submitted||sendAnalytics({type:"formClose",element,errors:analyticsRef.current.errors,elapsed:(new Date).getTime()-analyticsRef.current.start.getTime()})}},[sendAnalytics,formRef]);var formContextValue=(0,react.useMemo)(function(){return{useFormField:function useFormField(_ref10){var errorArg=_ref10.error,infoArg=_ref10.info,name=_ref10.name,required=_ref10.required,disabled=_ref10.disabled,validateArg=_ref10.validate,validateOnArg=_ref10.validateOn,error=disabled?void 0:errorArg||validationResults.errors[name],info=infoArg||validationResults.infos[name];return(0,react.useEffect)(function(){setValidateOn(function(prevValues){var _extends2,_ref11;return"string"==typeof prevValues?((_ref11={})[name]=validateOnArg||validateOnProp,_ref11):_extends({},prevValues,((_extends2={})[name]=validateOnArg||validateOnProp,_extends2))})},[validateOnArg,name]),(0,react.useEffect)(function(){var index=requiredFields.current.indexOf(name);if(required?-1===index&&requiredFields.current.push(name):-1!==index&&requiredFields.current.splice(index,1),validateArg||required)return validationRulesRef.current[name]||(validationRulesRef.current[name]={}),validationRulesRef.current[name].field=validateName(validateArg,required),validateOnArg&&"submit"!==validateOnArg?validationRulesRef.current[name].validateOn=validateOnArg:validateOnArg||"submit"===validateOnProp||(validationRulesRef.current[name].validateOn=validateOnProp),function(){delete validationRulesRef.current[name].field,delete validationRulesRef.current[name].validateOn;var requiredFieldIndex=requiredFields.current.indexOf(name);-1!==requiredFieldIndex&&requiredFields.current.splice(requiredFieldIndex,1)}},[error,name,required,validateArg,disabled,validateOnArg]),{error,info,inForm:!0,onBlur:"blur"===validateOnArg||"blur"===validateOn[name]?function(){return setPendingValidation(pendingValidation?[].concat(pendingValidation,[name]):[name])}:void 0,onChange:"change"===validateOnArg||"change"===validateOn[name]?function(){return setPendingValidation(pendingValidation?[].concat(pendingValidation,[name]):[name])}:void 0}},useFormInput:function useFormInput(_ref9){var name=_ref9.name,componentValue=_ref9.value,initialValue=_ref9.initialValue,validateArg=_ref9.validate,_useState7=(0,react.useState)(initialValue),inputValue=_useState7[0],setInputValue=_useState7[1],formValue=name?getFieldValue(name,value):void 0,keyCreated=(0,react.useRef)(!1);return(0,react.useEffect)(function(){name&&void 0!==componentValue&&(Array.isArray(componentValue)&&Array.isArray(formValue)?componentValue.toString()!==formValue.toString():componentValue!==formValue)&&setValueState(function(prevValue){return setFieldValue(name,componentValue,prevValue)})},[componentValue,formValue,name]),(0,react.useEffect)(function(){return function(){keyCreated.current&&(keyCreated.current=!1,setValueState(function(prevValue){var nextValue=_extends({},prevValue),isArrayField=stringToArray(name);isArrayField?delete nextValue[isArrayField.arrayName]:delete nextValue[name];return nextValue}))}},[]),(0,react.useEffect)(function(){if(validateArg)return validationRulesRef.current[name]||(validationRulesRef.current[name]={}),validationRulesRef.current[name].input=validateName(validateArg),function(){return delete validationRulesRef.current[name].input}},[validateArg,name]),[void 0!==componentValue?componentValue:valueProp&&name&&void 0!==formValue?formValue:void 0===formValue&&name?initialValue:inputValue,function(nextComponentValue){if(name){var nextTouched=_extends({},touched);nextTouched[name]=!0,touched[name]||setTouched(nextTouched),name in value||(keyCreated.current=!0);var nextValue=setFieldValue(name,nextComponentValue,value);setValueState(nextValue),onChange&&onChange(nextValue,{touched:nextTouched})}void 0!==initialValue&&setInputValue(nextComponentValue)}]},kind}},[onChange,kind,pendingValidation,touched,validateOn,validationResults.errors,validationResults.infos,value,valueProp,validateOnProp]);return react.createElement("form",_extends({ref:formRef},rest,{onReset:function onReset(event){if(sendAnalytics({type:"formReset",element:formRef.current,data:event,errors:analyticsRef.current.errors,elapsed:(new Date).getTime()-analyticsRef.current.start.getTime()}),setPendingValidation(void 0),valueProp||(setValueState(defaultValue),onChange&&onChange(defaultValue,{touched:defaultTouched})),setTouched(defaultTouched),setValidationResults(defaultValidationResults),analyticsRef.current={start:new Date,errors:{}},_onReset){event.persist();var adjustedEvent=event;adjustedEvent.value=defaultValue,_onReset(adjustedEvent)}},onSubmit:function onSubmit(event){if(event.preventDefault(),formRef.current&&(event.target===formRef.current||event.target.form===formRef.current)){setPendingValidation(void 0);var newValidationRulesRef=Object.keys(validationRulesRef.current).reduce(function(acc,key){return acc[key]=validationRulesRef.current[key],acc[key].validateOn||(acc[key]=_extends({},validationRulesRef.current[key],{validateOn:"submit"})),acc},{}),_validateForm2=validateForm(Object.entries(newValidationRulesRef),value,format,messages,!0),nextErrors=_validateForm2[0],nextInfos=_validateForm2[1];if(setValidationResults(function(){var nextValidationResults={errors:nextErrors,infos:nextInfos,valid:buildValid(nextErrors)};return onValidate&&onValidate(nextValidationResults),validationResultsRef.current=nextValidationResults,updateAnalytics(),nextValidationResults}),0===Object.keys(nextErrors).length&&_onSubmit){event.persist();var adjustedEvent=event;adjustedEvent.value=value,adjustedEvent.touched=touched,_onSubmit(adjustedEvent),sendAnalytics({type:"formSubmit",element:formRef.current,data:adjustedEvent,errors:analyticsRef.current.errors,elapsed:(new Date).getTime()-analyticsRef.current.start.getTime()}),analyticsRef.current.errors={},analyticsRef.current.submitted=!0}}}}),react.createElement(FormContext.c.Provider,{value:formContextValue},children))});Form.displayName="Form",Form.propTypes=FormPropTypes}}]);